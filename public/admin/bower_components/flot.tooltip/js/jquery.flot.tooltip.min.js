!function(D){var B={tooltip:!1,tooltipOpts:{id:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:!0,lines:{track:!1,threshold:0.05},onHover:function(){},$compat:!1}},C=function(E){this.tipPosition={x:0,y:0},this.init(E)};C.prototype.init=function(H){function I(L){var K={};K.x=L.pageX,K.y=L.pageY,H.setTooltipPosition(K)}function F(O,L,P){var K=function(T,R,S,Q){return Math.sqrt((S-T)*(S-T)+(Q-R)*(Q-R))},M=function(Z,X,Y,n,Q,g,T){if(!T||(T=function(m,k,l,q,i,o){if("undefined"!=typeof l){return{x:l,y:k}}if("undefined"!=typeof q){return{x:m,y:q}}var p,j=-1/((o-q)/(i-l));return{x:p=(i*(m*j-k+q)+l*(m*-j+k-o))/(j*(i-l)+q-o),y:j*p-j*m+k}}(Z,X,Y,n,Q,g),T.x>=Math.min(Y,Q)&&T.x<=Math.max(Y,Q)&&T.y>=Math.min(n,g)&&T.y<=Math.max(n,g))){var U=n-g,R=Q-Y,S=Y*g-n*Q;return Math.abs(U*Z+R*X+S)/Math.sqrt(U*U+R*R)}var V=K(Z,X,Y,n),W=K(Z,X,Q,g);return V>W?W:V};if(P){H.showTooltip(P,L)}else{if(G.plotOptions.series.lines.show&&G.tooltipOptions.lines.track===!0){var N={distance:-1};D.each(H.getData(),function(Z,Y){for(var b=0,S=-1,T=1;T<Y.data.length;T++){Y.data[T-1][0]<=L.x&&Y.data[T][0]>=L.x&&(b=T-1,S=T)}if(-1===S){return void H.hideTooltip()}var W={x:Y.data[b][0],y:Y.data[b][1]},X={x:Y.data[S][0],y:Y.data[S][1]},U=M(L.x,L.y,W.x,W.y,X.x,X.y,!1);if(U<G.tooltipOptions.lines.threshold){var V=K(W.x,W.y,L.x,L.y)<K(L.x,L.y,X.x,X.y)?b:S,Q=(Y.datapoints.pointsize,[L.x,W.y+(X.y-W.y)*((L.x-W.x)/(X.x-W.x))]),R={datapoint:Q,dataIndex:V,series:Y,seriesIndex:Z};(-1===N.distance||U<N.distance)&&(N={distance:U,item:R})}}),-1!==N.distance?H.showTooltip(N.item,L):H.hideTooltip()}else{H.hideTooltip()}}}var G=this,J=D.plot.plugins.length;if(this.plotPlugins=[],J){for(var E=0;J>E;E++){this.plotPlugins.push(D.plot.plugins[E].name)}}H.hooks.bindEvents.push(function(K,L){if(G.plotOptions=K.getOptions(),G.plotOptions.tooltip!==!1&&"undefined"!=typeof G.plotOptions.tooltip){G.tooltipOptions=G.plotOptions.tooltipOpts,G.tooltipOptions.$compat?(G.wfunc="width",G.hfunc="height"):(G.wfunc="innerWidth",G.hfunc="innerHeight");G.getDomElement();D(K.getPlaceholder()).bind("plothover",F),D(L).bind("mousemove",I)}}),H.hooks.shutdown.push(function(L,K){D(L.getPlaceholder()).unbind("plothover",F),D(K).unbind("mousemove",I)}),H.setTooltipPosition=function(L){var M=G.getDomElement(),K=M.outerWidth()+G.tooltipOptions.shifts.x,N=M.outerHeight()+G.tooltipOptions.shifts.y;L.x-D(window).scrollLeft()>D(window)[G.wfunc]()-K&&(L.x-=K),L.y-D(window).scrollTop()>D(window)[G.hfunc]()-N&&(L.y-=N),G.tipPosition.x=L.x,G.tipPosition.y=L.y},H.showTooltip=function(M,L){var K=G.getDomElement(),N=G.stringFormat(G.tooltipOptions.content,M);K.html(N),H.setTooltipPosition({x:L.pageX,y:L.pageY}),K.css({left:G.tipPosition.x+G.tooltipOptions.shifts.x,top:G.tipPosition.y+G.tooltipOptions.shifts.y}).show(),"function"==typeof G.tooltipOptions.onHover&&G.tooltipOptions.onHover(M,K)},H.hideTooltip=function(){G.getDomElement().hide().html("")}},C.prototype.getDomElement=function(){var E=D("#"+this.tooltipOptions.id);return 0===E.length&&(E=D("<div />").attr("id",this.tooltipOptions.id),E.appendTo("body").hide().css({position:"absolute"}),this.tooltipOptions.defaultTheme&&E.css({background:"#fff","z-index":"1040",padding:"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em",border:"1px solid #111",display:"none","white-space":"nowrap"})),E},C.prototype.stringFormat=function(T,R){var S,W,X,U,V=/%p\.{0,1}(\d{0,})/,L=/%s/,M=/%lx/,J=/%ly/,K=/%x\.{0,1}(\d{0,})/,P=/%y\.{0,1}(\d{0,})/,Q="%x",N="%y",O="%ct";if("undefined"!=typeof R.series.threshold?(S=R.datapoint[0],W=R.datapoint[1],X=R.datapoint[2]):"undefined"!=typeof R.series.lines&&R.series.lines.steps?(S=R.series.datapoints.points[2*R.dataIndex],W=R.series.datapoints.points[2*R.dataIndex+1],X=""):(S=R.series.data[R.dataIndex][0],W=R.series.data[R.dataIndex][1],X=R.series.data[R.dataIndex][2]),null===R.series.label&&R.series.originSeries&&(R.series.label=R.series.originSeries.label),"function"==typeof T&&(T=T(R.series.label,S,W,R)),"undefined"!=typeof R.series.percent?U=R.series.percent:"undefined"!=typeof R.series.percents&&(U=R.series.percents[R.dataIndex]),"number"==typeof U&&(T=this.adjustValPrecision(V,T,U)),T="undefined"!=typeof R.series.label?T.replace(L,R.series.label):T.replace(L,""),T=this.hasAxisLabel("xaxis",R)?T.replace(M,R.series.xaxis.options.axisLabel):T.replace(M,""),T=this.hasAxisLabel("yaxis",R)?T.replace(J,R.series.yaxis.options.axisLabel):T.replace(J,""),this.isTimeMode("xaxis",R)&&this.isXDateFormat(R)&&(T=T.replace(K,this.timestampToDate(S,this.tooltipOptions.xDateFormat,R.series.xaxis.options))),this.isTimeMode("yaxis",R)&&this.isYDateFormat(R)&&(T=T.replace(P,this.timestampToDate(W,this.tooltipOptions.yDateFormat,R.series.yaxis.options))),"number"==typeof S&&(T=this.adjustValPrecision(K,T,S)),"number"==typeof W&&(T=this.adjustValPrecision(P,T,W)),"undefined"!=typeof R.series.xaxis.ticks){var G;G=this.hasRotatedXAxisTicks(R)?"rotatedTicks":"ticks";var H=R.dataIndex+R.seriesIndex;if(R.series.xaxis[G].length>H&&!this.isTimeMode("xaxis",R)){var E=this.isCategoriesMode("xaxis",R)?R.series.xaxis[G][H].label:R.series.xaxis[G][H].v;E===S&&(T=T.replace(K,R.series.xaxis[G][H].label))}}if("undefined"!=typeof R.series.yaxis.ticks){for(var F in R.series.yaxis.ticks){if(R.series.yaxis.ticks.hasOwnProperty(F)){var I=this.isCategoriesMode("yaxis",R)?R.series.yaxis.ticks[F].label:R.series.yaxis.ticks[F].v;I===W&&(T=T.replace(P,R.series.yaxis.ticks[F].label))}}}return"undefined"!=typeof R.series.xaxis.tickFormatter&&(T=T.replace(Q,R.series.xaxis.tickFormatter(S,R.series.xaxis).replace(/\$/g,"$$"))),"undefined"!=typeof R.series.yaxis.tickFormatter&&(T=T.replace(N,R.series.yaxis.tickFormatter(W,R.series.yaxis).replace(/\$/g,"$$"))),X&&(T=T.replace(O,X)),T},C.prototype.isTimeMode=function(F,E){return"undefined"!=typeof E.series[F].options.mode&&"time"===E.series[F].options.mode},C.prototype.isXDateFormat=function(){return"undefined"!=typeof this.tooltipOptions.xDateFormat&&null!==this.tooltipOptions.xDateFormat},C.prototype.isYDateFormat=function(){return"undefined"!=typeof this.tooltipOptions.yDateFormat&&null!==this.tooltipOptions.yDateFormat},C.prototype.isCategoriesMode=function(F,E){return"undefined"!=typeof E.series[F].options.mode&&"categories"===E.series[F].options.mode},C.prototype.timestampToDate=function(G,H,E){var F=D.plot.dateGenerator(G,E);return D.plot.formatDate(F,H,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)},C.prototype.adjustValPrecision=function(I,G,H){var E,F=G.match(I);return null!==F&&""!==RegExp.$1&&(E=RegExp.$1,H=H.toFixed(E),G=G.replace(I,H)),G},C.prototype.hasAxisLabel=function(E,F){return -1!==D.inArray(this.plotPlugins,"axisLabels")&&"undefined"!=typeof F.series[E].options.axisLabel&&F.series[E].options.axisLabel.length>0},C.prototype.hasRotatedXAxisTicks=function(E){return -1!==D.inArray(this.plotPlugins,"tickRotor")&&"undefined"!=typeof E.series.xaxis.rotatedTicks};var A=function(E){new C(E)};D.plot.plugins.push({init:A,options:B,name:"tooltip",version:"0.8.4"})}(jQuery);