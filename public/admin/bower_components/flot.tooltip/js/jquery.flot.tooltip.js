(function(D){var A={tooltip:false,tooltipOpts:{id:"flotTip",content:"%s | X: %x | Y: %y",xDateFormat:null,yDateFormat:null,monthNames:null,dayNames:null,shifts:{x:10,y:20},defaultTheme:true,lines:{track:false,threshold:0.05},onHover:function(F,E){},$compat:false}};var B=function(E){this.tipPosition={x:0,y:0};this.init(E)};B.prototype.init=function(G){var E=this;var J=D.plot.plugins.length;this.plotPlugins=[];if(J){for(var F=0;F<J;F++){this.plotPlugins.push(D.plot.plugins[F].name)}}G.hooks.bindEvents.push(function(L,K){E.plotOptions=L.getOptions();if(E.plotOptions.tooltip===false||typeof E.plotOptions.tooltip==="undefined"){return}E.tooltipOptions=E.plotOptions.tooltipOpts;if(E.tooltipOptions.$compat){E.wfunc="width";E.hfunc="height"}else{E.wfunc="innerWidth";E.hfunc="innerHeight"}var M=E.getDomElement();D(L.getPlaceholder()).bind("plothover",I);D(K).bind("mousemove",H)});G.hooks.shutdown.push(function(L,K){D(L.getPlaceholder()).unbind("plothover",I);D(K).unbind("mousemove",H)});function H(K){var L={};L.x=K.pageX;L.y=K.pageY;G.setTooltipPosition(L)}function I(N,L,M){var K=function(Q,R,S,T){return Math.sqrt((S-Q)*(S-Q)+(T-R)*(T-R))};var O=function(Y,Z,T,U,R,S,W){if(W&&!(W=function(i,j,c,f,a,b){if(typeof c!=="undefined"){return{x:c,y:j}}else{if(typeof f!=="undefined"){return{x:i,y:f}}}var g,h=-1/((b-f)/(a-c));return{x:g=(a*(i*h-j+f)+c*(i*-h+j-b))/(h*(a-c)+f-b),y:h*g-h*i+j}}(Y,Z,T,U,R,S),W.x>=Math.min(T,R)&&W.x<=Math.max(T,R)&&W.y>=Math.min(U,S)&&W.y<=Math.max(U,S))){var Q=K(Y,Z,T,U),V=K(Y,Z,R,S);return Q>V?V:Q}else{var d=U-S,X=R-T,e=T*S-U*R;return Math.abs(d*Y+X*Z+e)/Math.sqrt(d*d+X*X)}};if(M){G.showTooltip(M,L)}else{if(E.plotOptions.series.lines.show&&E.tooltipOptions.lines.track===true){var P={distance:-1};D.each(G.getData(),function(Y,Z){var U=0,X=-1;for(var V=1;V<Z.data.length;V++){if(Z.data[V-1][0]<=L.x&&Z.data[V][0]>=L.x){U=V-1;X=V}}if(X===-1){G.hideTooltip();return}var a={x:Z.data[U][0],y:Z.data[U][1]},W={x:Z.data[X][0],y:Z.data[X][1]};var T=O(L.x,L.y,a.x,a.y,W.x,W.y,false);if(T<E.tooltipOptions.lines.threshold){var Q=K(a.x,a.y,L.x,L.y)<K(L.x,L.y,W.x,W.y)?U:X;var S=Z.datapoints.pointsize;var R=[L.x,a.y+((W.y-a.y)*((L.x-a.x)/(W.x-a.x)))];var b={datapoint:R,dataIndex:Q,series:Z,seriesIndex:Y};if(P.distance===-1||T<P.distance){P={distance:T,item:b}}}});if(P.distance!==-1){G.showTooltip(P.item,L)}else{G.hideTooltip()}}else{G.hideTooltip()}}}G.setTooltipPosition=function(L){var N=E.getDomElement();var M=N.outerWidth()+E.tooltipOptions.shifts.x;var K=N.outerHeight()+E.tooltipOptions.shifts.y;if((L.x-D(window).scrollLeft())>(D(window)[E.wfunc]()-M)){L.x-=M}if((L.y-D(window).scrollTop())>(D(window)[E.hfunc]()-K)){L.y-=K}E.tipPosition.x=L.x;E.tipPosition.y=L.y};G.showTooltip=function(L,K){var N=E.getDomElement();var M=E.stringFormat(E.tooltipOptions.content,L);N.html(M);G.setTooltipPosition({x:K.pageX,y:K.pageY});N.css({left:E.tipPosition.x+E.tooltipOptions.shifts.x,top:E.tipPosition.y+E.tooltipOptions.shifts.y}).show();if(typeof E.tooltipOptions.onHover==="function"){E.tooltipOptions.onHover(L,N)}};G.hideTooltip=function(){E.getDomElement().hide().html("")}};B.prototype.getDomElement=function(){var E=D("#"+this.tooltipOptions.id);if(E.length===0){E=D("<div />").attr("id",this.tooltipOptions.id);E.appendTo("body").hide().css({position:"absolute"});if(this.tooltipOptions.defaultTheme){E.css({"background":"#fff","z-index":"1040","padding":"0.4em 0.6em","border-radius":"0.5em","font-size":"0.8em","border":"1px solid #111","display":"none","white-space":"nowrap"})}}return E};B.prototype.stringFormat=function(P,G){var K=/%p\.{0,1}(\d{0,})/;var H=/%s/;var O=/%lx/;var W=/%ly/;var Q=/%x\.{0,1}(\d{0,})/;var N=/%y\.{0,1}(\d{0,})/;var L="%x";var S="%y";var R="%ct";var U,V,E,F;if(typeof G.series.threshold!=="undefined"){U=G.datapoint[0];V=G.datapoint[1];E=G.datapoint[2]}else{if(typeof G.series.lines!=="undefined"&&G.series.lines.steps){U=G.series.datapoints.points[G.dataIndex*2];V=G.series.datapoints.points[G.dataIndex*2+1];E=""}else{U=G.series.data[G.dataIndex][0];V=G.series.data[G.dataIndex][1];E=G.series.data[G.dataIndex][2]}}if(G.series.label===null&&G.series.originSeries){G.series.label=G.series.originSeries.label}if(typeof(P)==="function"){P=P(G.series.label,U,V,G)}if(typeof(G.series.percent)!=="undefined"){F=G.series.percent}else{if(typeof(G.series.percents)!=="undefined"){F=G.series.percents[G.dataIndex]}}if(typeof F==="number"){P=this.adjustValPrecision(K,P,F)}if(typeof(G.series.label)!=="undefined"){P=P.replace(H,G.series.label)}else{P=P.replace(H,"")}if(this.hasAxisLabel("xaxis",G)){P=P.replace(O,G.series.xaxis.options.axisLabel)}else{P=P.replace(O,"")}if(this.hasAxisLabel("yaxis",G)){P=P.replace(W,G.series.yaxis.options.axisLabel)}else{P=P.replace(W,"")}if(this.isTimeMode("xaxis",G)&&this.isXDateFormat(G)){P=P.replace(Q,this.timestampToDate(U,this.tooltipOptions.xDateFormat,G.series.xaxis.options))}if(this.isTimeMode("yaxis",G)&&this.isYDateFormat(G)){P=P.replace(N,this.timestampToDate(V,this.tooltipOptions.yDateFormat,G.series.yaxis.options))}if(typeof U==="number"){P=this.adjustValPrecision(Q,P,U)}if(typeof V==="number"){P=this.adjustValPrecision(N,P,V)}if(typeof G.series.xaxis.ticks!=="undefined"){var T;if(this.hasRotatedXAxisTicks(G)){T="rotatedTicks"}else{T="ticks"}var J=G.dataIndex+G.seriesIndex;if(G.series.xaxis[T].length>J&&!this.isTimeMode("xaxis",G)){var M=(this.isCategoriesMode("xaxis",G))?G.series.xaxis[T][J].label:G.series.xaxis[T][J].v;if(M===U){P=P.replace(Q,G.series.xaxis[T][J].label)}}}if(typeof G.series.yaxis.ticks!=="undefined"){for(var I in G.series.yaxis.ticks){if(G.series.yaxis.ticks.hasOwnProperty(I)){var X=(this.isCategoriesMode("yaxis",G))?G.series.yaxis.ticks[I].label:G.series.yaxis.ticks[I].v;if(X===V){P=P.replace(N,G.series.yaxis.ticks[I].label)}}}}if(typeof G.series.xaxis.tickFormatter!=="undefined"){P=P.replace(L,G.series.xaxis.tickFormatter(U,G.series.xaxis).replace(/\$/g,"$$"))}if(typeof G.series.yaxis.tickFormatter!=="undefined"){P=P.replace(S,G.series.yaxis.tickFormatter(V,G.series.yaxis).replace(/\$/g,"$$"))}if(E){P=P.replace(R,E)}return P};B.prototype.isTimeMode=function(F,E){return(typeof E.series[F].options.mode!=="undefined"&&E.series[F].options.mode==="time")};B.prototype.isXDateFormat=function(E){return(typeof this.tooltipOptions.xDateFormat!=="undefined"&&this.tooltipOptions.xDateFormat!==null)};B.prototype.isYDateFormat=function(E){return(typeof this.tooltipOptions.yDateFormat!=="undefined"&&this.tooltipOptions.yDateFormat!==null)};B.prototype.isCategoriesMode=function(F,E){return(typeof E.series[F].options.mode!=="undefined"&&E.series[F].options.mode==="categories")};B.prototype.timestampToDate=function(E,G,F){var H=D.plot.dateGenerator(E,F);return D.plot.formatDate(H,G,this.tooltipOptions.monthNames,this.tooltipOptions.dayNames)};B.prototype.adjustValPrecision=function(H,I,E){var G;var F=I.match(H);if(F!==null){if(RegExp.$1!==""){G=RegExp.$1;E=E.toFixed(G);I=I.replace(H,E)}}return I};B.prototype.hasAxisLabel=function(F,E){return(D.inArray(this.plotPlugins,"axisLabels")!==-1&&typeof E.series[F].options.axisLabel!=="undefined"&&E.series[F].options.axisLabel.length>0)};B.prototype.hasRotatedXAxisTicks=function(E){return(D.inArray(this.plotPlugins,"tickRotor")!==-1&&typeof E.series.xaxis.rotatedTicks!=="undefined")};var C=function(E){new B(E)};D.plot.plugins.push({init:C,options:A,name:"tooltip",version:"0.8.4"})})(jQuery);