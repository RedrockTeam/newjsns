define(["./core","./var/strundefined","./var/rnotwhite","./var/hasOwn","./var/slice","./event/support","./data/var/data_priv","./core/init","./data/accepts","./selector"],function(M,J,H,F,A,C,D){var B=/^key/,E=/^(?:mouse|pointer|contextmenu)|click/,I=/^(?:focusinfocus|focusoutblur)$/,K=/^([^.]*)(?:\.(.+)|)$/;function N(){return true}function L(){return false}function G(){try{return document.activeElement}catch(O){}}M.event={global:{},add:function(W,S,Q,b,T){var d,Z,O,X,P,e,U,R,c,Y,a,V=D.get(W);if(!V){return}if(Q.handler){d=Q;Q=d.handler;T=d.selector}if(!Q.guid){Q.guid=M.guid++}if(!(X=V.events)){X=V.events={}}if(!(Z=V.handle)){Z=V.handle=function(f){return typeof M!==J&&M.event.triggered!==f.type?M.event.dispatch.apply(W,arguments):undefined}}S=(S||"").match(H)||[""];P=S.length;while(P--){O=K.exec(S[P])||[];c=a=O[1];Y=(O[2]||"").split(".").sort();if(!c){continue}U=M.event.special[c]||{};c=(T?U.delegateType:U.bindType)||c;U=M.event.special[c]||{};e=M.extend({type:c,origType:a,data:b,handler:Q,guid:Q.guid,selector:T,needsContext:T&&M.expr.match.needsContext.test(T),namespace:Y.join(".")},d);if(!(R=X[c])){R=X[c]=[];R.delegateCount=0;if(!U.setup||U.setup.call(W,b,Y,Z)===false){if(W.addEventListener){W.addEventListener(c,Z,false)}}}if(U.add){U.add.call(W,e);if(!e.handler.guid){e.handler.guid=Q.guid}}if(T){R.splice(R.delegateCount++,0,e)}else{R.push(e)}M.event.global[c]=true}},remove:function(X,S,Q,U,T){var b,c,O,Y,P,e,V,R,d,Z,a,W=D.hasData(X)&&D.get(X);if(!W||!(Y=W.events)){return}S=(S||"").match(H)||[""];P=S.length;while(P--){O=K.exec(S[P])||[];d=a=O[1];Z=(O[2]||"").split(".").sort();if(!d){for(d in Y){M.event.remove(X,d+S[P],Q,U,true)}continue}V=M.event.special[d]||{};d=(U?V.delegateType:V.bindType)||d;R=Y[d]||[];O=O[2]&&new RegExp("(^|\\.)"+Z.join("\\.(?:.*\\.|)")+"(\\.|$)");c=b=R.length;while(b--){e=R[b];if((T||a===e.origType)&&(!Q||Q.guid===e.guid)&&(!O||O.test(e.namespace))&&(!U||U===e.selector||U==="**"&&e.selector)){R.splice(b,1);if(e.selector){R.delegateCount--}if(V.remove){V.remove.call(X,e)}}}if(c&&!R.length){if(!V.teardown||V.teardown.call(X,Z,W.handle)===false){M.removeEvent(X,d,W.handle)}delete Y[d]}}if(M.isEmptyObject(Y)){delete W.handle;D.remove(X,"events")}},trigger:function(U,R,Q,Y){var W,P,V,b,S,T,X,Z=[Q||document],a=F.call(U,"type")?U.type:U,O=F.call(U,"namespace")?U.namespace.split("."):[];P=V=Q=Q||document;if(Q.nodeType===3||Q.nodeType===8){return}if(I.test(a+M.event.triggered)){return}if(a.indexOf(".")>=0){O=a.split(".");a=O.shift();O.sort()}S=a.indexOf(":")<0&&"on"+a;U=U[M.expando]?U:new M.Event(a,typeof U==="object"&&U);U.isTrigger=Y?2:3;U.namespace=O.join(".");U.namespace_re=U.namespace?new RegExp("(^|\\.)"+O.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;U.result=undefined;if(!U.target){U.target=Q}R=R==null?[U]:M.makeArray(R,[U]);X=M.event.special[a]||{};if(!Y&&X.trigger&&X.trigger.apply(Q,R)===false){return}if(!Y&&!X.noBubble&&!M.isWindow(Q)){b=X.delegateType||a;if(!I.test(b+a)){P=P.parentNode}for(;P;P=P.parentNode){Z.push(P);V=P}if(V===(Q.ownerDocument||document)){Z.push(V.defaultView||V.parentWindow||window)}}W=0;while((P=Z[W++])&&!U.isPropagationStopped()){U.type=W>1?b:X.bindType||a;T=(D.get(P,"events")||{})[U.type]&&D.get(P,"handle");if(T){T.apply(P,R)}T=S&&P[S];if(T&&T.apply&&M.acceptData(P)){U.result=T.apply(P,R);if(U.result===false){U.preventDefault()}}}U.type=a;if(!Y&&!U.isDefaultPrevented()){if((!X._default||X._default.apply(Z.pop(),R)===false)&&M.acceptData(Q)){if(S&&M.isFunction(Q[a])&&!M.isWindow(Q)){V=Q[S];if(V){Q[S]=null}M.event.triggered=a;Q[a]();M.event.triggered=undefined;if(V){Q[S]=V}}}}return U.result},dispatch:function(W){W=M.event.fix(W);var S,R,V,P,X,Q=[],O=A.call(arguments),U=(D.get(this,"events")||{})[W.type]||[],T=M.event.special[W.type]||{};O[0]=W;W.delegateTarget=this;if(T.preDispatch&&T.preDispatch.call(this,W)===false){return}Q=M.event.handlers.call(this,W,U);S=0;while((P=Q[S++])&&!W.isPropagationStopped()){W.currentTarget=P.elem;R=0;while((X=P.handlers[R++])&&!W.isImmediatePropagationStopped()){if(!W.namespace_re||W.namespace_re.test(X.namespace)){W.handleObj=X;W.data=X.data;V=((M.event.special[X.origType]||{}).handle||X.handler).apply(P.elem,O);if(V!==undefined){if((W.result=V)===false){W.preventDefault();W.stopPropagation()}}}}}if(T.postDispatch){T.postDispatch.call(this,W)}return W.result},handlers:function(Q,V){var T,S,R,W,P=[],U=V.delegateCount,O=Q.target;if(U&&O.nodeType&&(!Q.button||Q.type!=="click")){for(;O!==this;O=O.parentNode||this){if(O.disabled!==true||Q.type!=="click"){S=[];for(T=0;T<U;T++){W=V[T];R=W.selector+" ";if(S[R]===undefined){S[R]=W.needsContext?M(R,this).index(O)>=0:M.find(R,this,null,[O]).length}if(S[R]){S.push(W)}}if(S.length){P.push({elem:O,handlers:S})}}}}if(U<V.length){P.push({elem:this,handlers:V.slice(U)})}return P},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(P,O){if(P.which==null){P.which=O.charCode!=null?O.charCode:O.keyCode}return P}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(S,P){var R,T,Q,O=P.button;if(S.pageX==null&&P.clientX!=null){R=S.target.ownerDocument||document;T=R.documentElement;Q=R.body;S.pageX=P.clientX+(T&&T.scrollLeft||Q&&Q.scrollLeft||0)-(T&&T.clientLeft||Q&&Q.clientLeft||0);S.pageY=P.clientY+(T&&T.scrollTop||Q&&Q.scrollTop||0)-(T&&T.clientTop||Q&&Q.clientTop||0)}if(!S.which&&O!==undefined){S.which=(O&1?1:(O&2?3:(O&4?2:0)))}return S}},fix:function(S){if(S[M.expando]){return S}var P,R,T,O=S.type,Q=S,U=this.fixHooks[O];if(!U){this.fixHooks[O]=U=E.test(O)?this.mouseHooks:B.test(O)?this.keyHooks:{}}T=U.props?this.props.concat(U.props):this.props;S=new M.Event(Q);P=T.length;while(P--){R=T[P];S[R]=Q[R]}if(!S.target){S.target=document}if(S.target.nodeType===3){S.target=S.target.parentNode}return U.filter?U.filter(S,Q):S},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==G()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===G()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&M.nodeName(this,"input")){this.click();return false}},_default:function(O){return M.nodeName(O.target,"a")}},beforeunload:{postDispatch:function(O){if(O.result!==undefined&&O.originalEvent){O.originalEvent.returnValue=O.result}}}},simulate:function(O,R,S,Q){var P=M.extend(new M.Event(),S,{type:O,isSimulated:true,originalEvent:{}});if(Q){M.event.trigger(P,null,R)}else{M.event.dispatch.call(R,P)}if(P.isDefaultPrevented()){S.preventDefault()}}};M.removeEvent=function(Q,O,P){if(Q.removeEventListener){Q.removeEventListener(O,P,false)}};M.Event=function(P,O){if(!(this instanceof M.Event)){return new M.Event(P,O)}if(P&&P.type){this.originalEvent=P;this.type=P.type;this.isDefaultPrevented=P.defaultPrevented||P.defaultPrevented===undefined&&P.returnValue===false?N:L}else{this.type=P}if(O){M.extend(this,O)}this.timeStamp=P&&P.timeStamp||M.now();this[M.expando]=true};M.Event.prototype={isDefaultPrevented:L,isPropagationStopped:L,isImmediatePropagationStopped:L,preventDefault:function(){var O=this.originalEvent;this.isDefaultPrevented=N;if(O&&O.preventDefault){O.preventDefault()}},stopPropagation:function(){var O=this.originalEvent;this.isPropagationStopped=N;if(O&&O.stopPropagation){O.stopPropagation()}},stopImmediatePropagation:function(){var O=this.originalEvent;this.isImmediatePropagationStopped=N;if(O&&O.stopImmediatePropagation){O.stopImmediatePropagation()}this.stopPropagation()}};M.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(O,P){M.event.special[O]={delegateType:P,bindType:P,handle:function(S){var U,T=this,Q=S.relatedTarget,R=S.handleObj;if(!Q||(Q!==T&&!M.contains(T,Q))){S.type=R.origType;U=R.handler.apply(this,arguments);S.type=P}return U}}});if(!C.focusinBubbles){M.each({focus:"focusin",blur:"focusout"},function(O,Q){var P=function(R){M.event.simulate(Q,R.target,M.event.fix(R),true)};M.event.special[Q]={setup:function(){var S=this.ownerDocument||this,R=D.access(S,Q);if(!R){S.addEventListener(O,P,true)}D.access(S,Q,(R||0)+1)},teardown:function(){var S=this.ownerDocument||this,R=D.access(S,Q)-1;if(!R){S.removeEventListener(O,P,true);D.remove(S,Q)}else{D.access(S,Q,R)}}}})}M.fn.extend({on:function(Q,R,U,T,O){var P,S;if(typeof Q==="object"){if(typeof R!=="string"){U=U||R;R=undefined}for(S in Q){this.on(S,R,U,Q[S],O)}return this}if(U==null&&T==null){T=R;U=R=undefined}else{if(T==null){if(typeof R==="string"){T=U;U=undefined}else{T=U;U=R;R=undefined}}}if(T===false){T=L}else{if(!T){return this}}if(O===1){P=T;T=function(V){M().off(V);return P.apply(this,arguments)};T.guid=P.guid||(P.guid=M.guid++)}return this.each(function(){M.event.add(this,Q,T,U,R)})},one:function(O,P,R,Q){return this.on(O,P,R,Q,1)},off:function(Q,R,S){var P,O;if(Q&&Q.preventDefault&&Q.handleObj){P=Q.handleObj;M(Q.delegateTarget).off(P.namespace?P.origType+"."+P.namespace:P.origType,P.selector,P.handler);return this}if(typeof Q==="object"){for(O in Q){this.off(O,R,Q[O])}return this}if(R===false||typeof R==="function"){S=R;R=undefined}if(S===false){S=L}return this.each(function(){M.event.remove(this,Q,S,R)})},trigger:function(O,P){return this.each(function(){M.event.trigger(O,P,this)})},triggerHandler:function(O,Q){var P=this[0];if(P){return M.event.trigger(O,Q,P,true)}}});return M});