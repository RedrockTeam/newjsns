define(["./core","./var/rnotwhite","./ajax/var/nonce","./ajax/var/rquery","./core/init","./ajax/parseJSON","./ajax/parseXML","./deferred"],function(S,P,B,E){var C=/#.*$/,O=/([?&])_=[^&]*/,M=/^(.*?):[ \t]*([^\r\n]*)$/mg,K=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,I=/^(?:GET|HEAD)$/,R=/^\/\//,J=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,F={},H={},G="*/".concat("*"),L=window.location.href,A=J.exec(L.toLowerCase())||[];function U(V){return function(Y,X){if(typeof Y!=="string"){X=Y;Y="*"}var Z,W=0,a=Y.toLowerCase().match(P)||[];if(S.isFunction(X)){while((Z=a[W++])){if(Z[0]==="+"){Z=Z.slice(1)||"*";(V[Z]=V[Z]||[]).unshift(X)}else{(V[Z]=V[Z]||[]).push(X)}}}}}function D(W,Y,V,a){var b={},Z=(W===H);function X(c){var d;b[c]=true;S.each(W[c]||[],function(g,e){var f=e(Y,V,a);if(typeof f==="string"&&!Z&&!b[f]){Y.dataTypes.unshift(f);X(f);return false}else{if(Z){return !(d=f)}}});return d}return X(Y.dataTypes[0])||!b["*"]&&X("*")}function T(Z,X){var V,W,Y=S.ajaxSettings.flatOptions||{};for(V in X){if(X[V]!==undefined){(Y[V]?Z:(W||(W={})))[V]=X[V]}}if(W){S.extend(true,Z,W)}return Z}function N(V,b,c){var a,Z,W,Y,X=V.contents,d=V.dataTypes;while(d[0]==="*"){d.shift();if(a===undefined){a=V.mimeType||b.getResponseHeader("Content-Type")}}if(a){for(Z in X){if(X[Z]&&X[Z].test(a)){d.unshift(Z);break}}}if(d[0] in c){W=d[0]}else{for(Z in c){if(!d[0]||V.converters[Z+" "+d[0]]){W=Z;break}if(!Y){Y=Z}}W=W||Y}if(W){if(W!==d[0]){d.unshift(W)}return c[W]}}function Q(X,W,d,c){var Z,Y,h,a,b,f={},g=X.dataTypes.slice();if(g[1]){for(h in X.converters){f[h.toLowerCase()]=X.converters[h]}}Y=g.shift();while(Y){if(X.responseFields[Y]){d[X.responseFields[Y]]=W}if(!b&&c&&X.dataFilter){W=X.dataFilter(W,X.dataType)}b=Y;Y=g.shift();if(Y){if(Y==="*"){Y=b}else{if(b!=="*"&&b!==Y){h=f[b+" "+Y]||f["* "+Y];if(!h){for(Z in f){a=Z.split(" ");if(a[1]===Y){h=f[b+" "+a[0]]||f["* "+a[0]];if(h){if(h===true){h=f[Z]}else{if(f[Z]!==true){Y=a[0];g.unshift(a[1])}}break}}}}if(h!==true){if(h&&X["throws"]){W=h(W)}else{try{W=h(W)}catch(V){return{state:"parsererror",error:h?V:"No conversion from "+b+" to "+Y}}}}}}}}return{state:"success",data:W}}S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:L,type:"GET",isLocal:K.test(A[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":G,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":S.parseJSON,"text xml":S.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(W,V){return V?T(T(W,S.ajaxSettings),V):T(S.ajaxSettings,W)},ajaxPrefilter:U(F),ajaxTransport:U(H),ajax:function(W,p){if(typeof W==="object"){p=W;W=undefined}p=p||{};var q,f,r,n,h,t,k,b,m=S.ajaxSetup({},p),a=m.context||m,V=m.context&&(a.nodeType||a.jquery)?S(a):S.event,d=S.Deferred(),o=S.Callbacks("once memory"),j=m.statusCode||{},g={},l={},c=0,X="canceled",u={readyState:0,getResponseHeader:function(e){var i;if(c===2){if(!n){n={};while((i=M.exec(r))){n[i[1].toLowerCase()]=i[2]}}i=n[e.toLowerCase()]}return i==null?null:i},getAllResponseHeaders:function(){return c===2?r:null},setRequestHeader:function(e,i){var s=e.toLowerCase();if(!c){e=l[s]=l[s]||e;g[e]=i}return this},overrideMimeType:function(e){if(!c){m.mimeType=e}return this},statusCode:function(e){var i;if(e){if(c<2){for(i in e){j[i]=[j[i],e[i]]}}else{u.always(e[u.status])}}return this},abort:function(e){var i=e||X;if(q){q.abort(i)}Z(0,i);return this}};d.promise(u).complete=o.add;u.success=u.done;u.error=u.fail;m.url=((W||m.url||L)+"").replace(C,"").replace(R,A[1]+"//");m.type=p.method||p.type||m.method||m.type;m.dataTypes=S.trim(m.dataType||"*").toLowerCase().match(P)||[""];if(m.crossDomain==null){t=J.exec(m.url.toLowerCase());m.crossDomain=!!(t&&(t[1]!==A[1]||t[2]!==A[2]||(t[3]||(t[1]==="http:"?"80":"443"))!==(A[3]||(A[1]==="http:"?"80":"443"))))}if(m.data&&m.processData&&typeof m.data!=="string"){m.data=S.param(m.data,m.traditional)}D(F,m,p,u);if(c===2){return u}k=S.event&&m.global;if(k&&S.active++===0){S.event.trigger("ajaxStart")}m.type=m.type.toUpperCase();m.hasContent=!I.test(m.type);f=m.url;if(!m.hasContent){if(m.data){f=(m.url+=(E.test(f)?"&":"?")+m.data);delete m.data}if(m.cache===false){m.url=O.test(f)?f.replace(O,"$1_="+B++):f+(E.test(f)?"&":"?")+"_="+B++}}if(m.ifModified){if(S.lastModified[f]){u.setRequestHeader("If-Modified-Since",S.lastModified[f])}if(S.etag[f]){u.setRequestHeader("If-None-Match",S.etag[f])}}if(m.data&&m.hasContent&&m.contentType!==false||p.contentType){u.setRequestHeader("Content-Type",m.contentType)}u.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+(m.dataTypes[0]!=="*"?", "+G+"; q=0.01":""):m.accepts["*"]);for(b in m.headers){u.setRequestHeader(b,m.headers[b])}if(m.beforeSend&&(m.beforeSend.call(a,u,m)===false||c===2)){return u.abort()}X="abort";for(b in {success:1,error:1,complete:1}){u[b](m[b])}q=D(H,m,p,u);if(!q){Z(-1,"No Transport")}else{u.readyState=1;if(k){V.trigger("ajaxSend",[u,m])}if(m.async&&m.timeout>0){h=setTimeout(function(){u.abort("timeout")},m.timeout)}try{c=1;q.send(g,Z)}catch(Y){if(c<2){Z(-1,Y)}else{throw Y}}}function Z(y,w,Aa,z){var x,i,v,Ab,e,s=w;if(c===2){return}c=2;if(h){clearTimeout(h)}q=undefined;r=z||"";u.readyState=y>0?4:0;x=y>=200&&y<300||y===304;if(Aa){Ab=N(m,u,Aa)}Ab=Q(m,Ab,u,x);if(x){if(m.ifModified){e=u.getResponseHeader("Last-Modified");if(e){S.lastModified[f]=e}e=u.getResponseHeader("etag");if(e){S.etag[f]=e}}if(y===204||m.type==="HEAD"){s="nocontent"}else{if(y===304){s="notmodified"}else{s=Ab.state;i=Ab.data;v=Ab.error;x=!v}}}else{v=s;if(y||!s){s="error";if(y<0){y=0}}}u.status=y;u.statusText=(w||s)+"";if(x){d.resolveWith(a,[i,s,u])}else{d.rejectWith(a,[u,s,v])}u.statusCode(j);j=undefined;if(k){V.trigger(x?"ajaxSuccess":"ajaxError",[u,m,x?i:v])}o.fireWith(a,[u,s]);if(k){V.trigger("ajaxComplete",[u,m]);if(!(--S.active)){S.event.trigger("ajaxStop")}}}return u},getJSON:function(W,X,V){return S.get(W,X,V,"json")},getScript:function(W,V){return S.get(W,undefined,V,"script")}});S.each(["get","post"],function(V,W){S[W]=function(Y,a,X,Z){if(S.isFunction(a)){Z=Z||X;X=a;a=undefined}return S.ajax({url:Y,type:W,dataType:Z,data:a,success:X})}});return S});