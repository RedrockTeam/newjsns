define(["../core","../var/support","../ajax"],function(E,A){E.ajaxSettings.xhr=function(){try{return new XMLHttpRequest()}catch(G){}};var B=0,C={},D={0:200,1223:204},F=E.ajaxSettings.xhr();if(window.attachEvent){window.attachEvent("onunload",function(){for(var G in C){C[G]()}})}A.cors=!!F&&("withCredentials" in F);A.ajax=F=!!F;E.ajaxTransport(function(H){var G;if(A.cors||F&&!H.crossDomain){return{send:function(I,L){var J,M=H.xhr(),N=++B;M.open(H.type,H.url,H.async,H.username,H.password);if(H.xhrFields){for(J in H.xhrFields){M[J]=H.xhrFields[J]}}if(H.mimeType&&M.overrideMimeType){M.overrideMimeType(H.mimeType)}if(!H.crossDomain&&!I["X-Requested-With"]){I["X-Requested-With"]="XMLHttpRequest"}for(J in I){M.setRequestHeader(J,I[J])}G=function(O){return function(){if(G){delete C[N];G=M.onload=M.onerror=null;if(O==="abort"){M.abort()}else{if(O==="error"){L(M.status,M.statusText)}else{L(D[M.status]||M.status,M.statusText,typeof M.responseText==="string"?{text:M.responseText}:undefined,M.getAllResponseHeaders())}}}}};M.onload=G();M.onerror=G("error");G=C[N]=G("abort");try{M.send(H.hasContent&&H.data||null)}catch(K){if(G){throw K}}},abort:function(){if(G){G()}}}}})});