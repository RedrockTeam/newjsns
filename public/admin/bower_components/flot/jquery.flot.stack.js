(function(C){var A={series:{stack:null}};function B(D){function F(H,J){var I=null;for(var G=0;G<J.length;++G){if(H==J[G]){break}if(J[G].stack==H.stack){I=J[G]}}return I}function E(I,M,Z){if(M.stack==null||M.stack===false){return}var H=F(M,I.getData());if(!H){return}var G=Z.pointsize,S=Z.points,K=H.datapoints.pointsize,V=H.datapoints.points,e=[],a,O,U,b,P,R,J=M.lines.show,d=M.bars.horizontal,c=G>2&&(d?Z.format[2].x:Z.format[2].y),X=J&&M.lines.steps,f=true,W=d?1:0,Q=d?0:1,L=0,Y=0,N,T;while(true){if(L>=S.length){break}N=e.length;if(S[L]==null){for(T=0;T<G;++T){e.push(S[L+T])}L+=G}else{if(Y>=V.length){if(!J){for(T=0;T<G;++T){e.push(S[L+T])}}L+=G}else{if(V[Y]==null){for(T=0;T<G;++T){e.push(null)}f=true;Y+=K}else{a=S[L+W];O=S[L+Q];b=V[Y+W];P=V[Y+Q];R=0;if(a==b){for(T=0;T<G;++T){e.push(S[L+T])}e[N+Q]+=P;R=P;L+=G;Y+=K}else{if(a>b){if(J&&L>0&&S[L-G]!=null){U=O+(S[L-G+Q]-O)*(b-a)/(S[L-G+W]-a);e.push(b);e.push(U+P);for(T=2;T<G;++T){e.push(S[L+T])}R=P}Y+=K}else{if(f&&J){L+=G;continue}for(T=0;T<G;++T){e.push(S[L+T])}if(J&&Y>0&&V[Y-K]!=null){R=P+(V[Y-K+Q]-P)*(a-b)/(V[Y-K+W]-b)}e[N+Q]+=R;L+=G}}f=false;if(N!=e.length&&c){e[N+2]+=R}}}}if(X&&N!=e.length&&N>0&&e[N]!=null&&e[N]!=e[N-G]&&e[N+1]!=e[N-G+1]){for(T=0;T<G;++T){e[N+G+T]=e[N+T]}e[N+1]=e[N-G+1]}}Z.points=e}D.hooks.processDatapoints.push(E)}C.plot.plugins.push({init:B,options:A,name:"stack",version:"1.2"})})(jQuery);