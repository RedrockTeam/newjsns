var webpage=require("webpage"),fs=require("fs");var html_path=fs.absolute("test.html");var examples=[];function run_example(C){if(C>=examples.length){phantom.exit(0);return}var B=examples[C];var A=0;var D=webpage.create();D.viewportSize={width:500,height:300};D.clipRect={width:500,height:300};D.onAlert=function(F){var E=JSON.parse(F);if(E.fn=="snapshot"){D.render("output/"+B.name+A+".png");A+=1}else{if(E.fn=="mousemove"){D.sendEvent("mousemove",E.x,E.y)}}};D.open(html_path,function(E){if(E=="fail"){console.log("Failed to load test page: "+B.name);phantom.exit(1)}else{D.evaluate(B.runner)}D.close();run_example(C+1)})}exports.def=function(B,A){examples.push({name:B,runner:A})};exports.run=function(){if(fs.isDirectory("output")){fs.list("output").forEach(function(A){if(A!="."&&A!=".."){fs.remove("output/"+A)}})}else{fs.makeDirectory("output")}run_example(0)};