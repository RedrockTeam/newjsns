function RGBColor(A){this.ok=false;if(A.charAt(0)=="#"){A=A.substr(1,6)}A=A.replace(/ /g,"");A=A.toLowerCase();var G={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var F in G){if(A==F){A=G[F]}}var H=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(I){return[parseInt(I[1]),parseInt(I[2]),parseInt(I[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(I){return[parseInt(I[1],16),parseInt(I[2],16),parseInt(I[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(I){return[parseInt(I[1]+I[1],16),parseInt(I[2]+I[2],16),parseInt(I[3]+I[3],16)]}}];for(var E=0;E<H.length;E++){var B=H[E].re;var D=H[E].process;var C=B.exec(A);if(C){channels=D(C);this.r=channels[0];this.g=channels[1];this.b=channels[2];this.ok=true}}this.r=(this.r<0||isNaN(this.r))?0:((this.r>255)?255:this.r);this.g=(this.g<0||isNaN(this.g))?0:((this.g>255)?255:this.g);this.b=(this.b<0||isNaN(this.b))?0:((this.b>255)?255:this.b);this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"};this.toHex=function(){var J=this.r.toString(16);var I=this.g.toString(16);var K=this.b.toString(16);if(J.length==1){J="0"+J}if(I.length==1){I="0"+I}if(K.length==1){K="0"+K}return"#"+J+I+K};this.getHelpXML=function(){var R=new Array();for(var N=0;N<H.length;N++){var P=H[N].example;for(var M=0;M<P.length;M++){R[R.length]=P[M]}}for(var S in G){R[R.length]=S}var I=document.createElement("ul");I.setAttribute("id","rgbcolor-examples");for(var N=0;N<R.length;N++){try{var O=document.createElement("li");var L=new RGBColor(R[N]);var Q=document.createElement("div");Q.style.cssText="margin: 3px; border: 1px solid black; background:"+L.toHex()+"; color:"+L.toHex();Q.appendChild(document.createTextNode("test"));var J=document.createTextNode(" "+R[N]+" -> "+L.toRGB()+" -> "+L.toHex());O.appendChild(Q);O.appendChild(J);I.appendChild(O)}catch(K){}}return I}}if(!window.console){window.console={};window.console.log=function(A){};window.console.dir=function(A){}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(B){for(var A=0;A<this.length;A++){if(this[A]==B){return A}}return -1}}(function(){this.canvg=function(H,C,F){if(H==null&&C==null&&F==null){var B=document.getElementsByTagName("svg");for(var E=0;E<B.length;E++){var J=B[E];var I=document.createElement("canvas");I.width=J.clientWidth;I.height=J.clientHeight;J.parentNode.insertBefore(I,J);J.parentNode.removeChild(J);var K=document.createElement("div");K.appendChild(J);canvg(I,K.innerHTML)}return}F=F||{};if(typeof H=="string"){H=document.getElementById(H)}var D;if(H.svg==null){D=A();H.svg=D}else{D=H.svg;D.stop()}D.opts=F;var G=H.getContext("2d");if(typeof(C.documentElement)!="undefined"){D.loadXmlDoc(G,C)}else{if(C.substr(0,1)=="<"){D.loadXml(G,C)}else{D.load(G,C)}}};function A(){var B={};B.FRAMERATE=30;B.MAX_VIRTUAL_PIXELS=30000;B.init=function(C){B.Definitions={};B.Styles={};B.Animations=[];B.Images=[];B.ctx=C;B.ViewPort=new (function(){this.viewPorts=[];this.Clear=function(){this.viewPorts=[]};this.SetCurrent=function(E,D){this.viewPorts.push({width:E,height:D})};this.RemoveCurrent=function(){this.viewPorts.pop()};this.Current=function(){return this.viewPorts[this.viewPorts.length-1]};this.width=function(){return this.Current().width};this.height=function(){return this.Current().height};this.ComputeSize=function(D){if(D!=null&&typeof(D)=="number"){return D}if(D=="x"){return this.width()}if(D=="y"){return this.height()}return Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}})};B.init();B.ImagesLoaded=function(){for(var C=0;C<B.Images.length;C++){if(!B.Images[C].loaded){return false}}return true};B.trim=function(C){return C.replace(/^\s+|\s+$/g,"")};B.compressSpaces=function(C){return C.replace(/[\s\r\t\n]+/gm," ")};B.ajax=function(C){var D;if(window.XMLHttpRequest){D=new XMLHttpRequest()}else{D=new ActiveXObject("Microsoft.XMLHTTP")}if(D){D.open("GET",C,false);D.send(null);return D.responseText}return null};B.parseXml=function(D){if(window.DOMParser){var E=new DOMParser();return E.parseFromString(D,"text/xml")}else{D=D.replace(/<!DOCTYPE svg[^>]*>/,"");var C=new ActiveXObject("Microsoft.XMLDOM");C.async="false";C.loadXML(D);return C}};B.Property=function(D,E){this.name=D;this.value=E;this.hasValue=function(){return(this.value!=null&&this.value!=="")};this.numValue=function(){if(!this.hasValue()){return 0}var F=parseFloat(this.value);if((this.value+"").match(/%$/)){F=F/100}return F};this.valueOrDefault=function(F){if(this.hasValue()){return this.value}return F};this.numValueOrDefault=function(F){if(this.hasValue()){return this.numValue()}return F};var C=this;this.Color={addOpacity:function(F){var H=C.value;if(F!=null&&F!=""){var G=new RGBColor(C.value);if(G.ok){H="rgba("+G.r+", "+G.g+", "+G.b+", "+F+")"}}return new B.Property(C.name,H)}};this.Definition={getDefinition:function(){var F=C.value.replace(/^(url\()?#([^\)]+)\)?$/,"$2");return B.Definitions[F]},isUrl:function(){return C.value.indexOf("url(")==0},getFillStyle:function(F){var G=this.getDefinition();if(G!=null&&G.createGradient){return G.createGradient(B.ctx,F)}if(G!=null&&G.createPattern){return G.createPattern(B.ctx,F)}return null}};this.Length={DPI:function(F){return 96},EM:function(H){var F=12;var G=new B.Property("fontSize",B.Font.Parse(B.ctx.font).fontSize);if(G.hasValue()){F=G.Length.toPixels(H)}return F},toPixels:function(G){if(!C.hasValue()){return 0}var F=C.value+"";if(F.match(/em$/)){return C.numValue()*this.EM(G)}if(F.match(/ex$/)){return C.numValue()*this.EM(G)/2}if(F.match(/px$/)){return C.numValue()}if(F.match(/pt$/)){return C.numValue()*1.25}if(F.match(/pc$/)){return C.numValue()*15}if(F.match(/cm$/)){return C.numValue()*this.DPI(G)/2.54}if(F.match(/mm$/)){return C.numValue()*this.DPI(G)/25.4}if(F.match(/in$/)){return C.numValue()*this.DPI(G)}if(F.match(/%$/)){return C.numValue()*B.ViewPort.ComputeSize(G)}return C.numValue()}};this.Time={toMilliseconds:function(){if(!C.hasValue()){return 0}var F=C.value+"";if(F.match(/s$/)){return C.numValue()*1000}if(F.match(/ms$/)){return C.numValue()}return C.numValue()}};this.Angle={toRadians:function(){if(!C.hasValue()){return 0}var F=C.value+"";if(F.match(/deg$/)){return C.numValue()*(Math.PI/180)}if(F.match(/grad$/)){return C.numValue()*(Math.PI/200)}if(F.match(/rad$/)){return C.numValue()}return C.numValue()*(Math.PI/180)}}};B.Font=new (function(){this.Styles=["normal","italic","oblique","inherit"];this.Variants=["normal","small-caps","inherit"];this.Weights=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900","inherit"];this.CreateFont=function(I,H,J,F,E,G){var D=G!=null?this.Parse(G):this.CreateFont("","","","","",B.ctx.font);return{fontFamily:E||D.fontFamily,fontSize:F||D.fontSize,fontStyle:I||D.fontStyle,fontWeight:J||D.fontWeight,fontVariant:H||D.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var C=this;this.Parse=function(E){var I={};var D=B.trim(B.compressSpaces(E||"")).split(" ");var H={fontSize:false,fontStyle:false,fontWeight:false,fontVariant:false};var F="";for(var G=0;G<D.length;G++){if(!H.fontStyle&&C.Styles.indexOf(D[G])!=-1){if(D[G]!="inherit"){I.fontStyle=D[G]}H.fontStyle=true}else{if(!H.fontVariant&&C.Variants.indexOf(D[G])!=-1){if(D[G]!="inherit"){I.fontVariant=D[G]}H.fontStyle=H.fontVariant=true}else{if(!H.fontWeight&&C.Weights.indexOf(D[G])!=-1){if(D[G]!="inherit"){I.fontWeight=D[G]}H.fontStyle=H.fontVariant=H.fontWeight=true}else{if(!H.fontSize){if(D[G]!="inherit"){I.fontSize=D[G].split("/")[0]}H.fontStyle=H.fontVariant=H.fontWeight=H.fontSize=true}else{if(D[G]!="inherit"){F+=D[G]}}}}}}if(F!=""){I.fontFamily=F}return I}});B.ToNumberArray=function(D){var E=B.trim(B.compressSpaces((D||"").replace(/,/g," "))).split(" ");for(var C=0;C<E.length;C++){E[C]=parseFloat(E[C])}return E};B.Point=function(C,D){this.x=C;this.y=D;this.angleTo=function(E){return Math.atan2(E.y-this.y,E.x-this.x)};this.applyTransform=function(E){var F=this.x*E[0]+this.y*E[2]+E[4];var G=this.x*E[1]+this.y*E[3]+E[5];this.x=F;this.y=G}};B.CreatePoint=function(C){var D=B.ToNumberArray(C);return new B.Point(D[0],D[1])};B.CreatePath=function(D){var E=B.ToNumberArray(D);var F=[];for(var C=0;C<E.length;C+=2){F.push(new B.Point(E[C],E[C+1]))}return F};B.BoundingBox=function(E,F,C,D){this.x1=Number.NaN;this.y1=Number.NaN;this.x2=Number.NaN;this.y2=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(G,H){if(G!=null){if(isNaN(this.x1)||isNaN(this.x2)){this.x1=G;this.x2=G}if(G<this.x1){this.x1=G}if(G>this.x2){this.x2=G}}if(H!=null){if(isNaN(this.y1)||isNaN(this.y2)){this.y1=H;this.y2=H}if(H<this.y1){this.y1=H}if(H>this.y2){this.y2=H}}};this.addX=function(G){this.addPoint(G,null)};this.addY=function(G){this.addPoint(null,G)};this.addBoundingBox=function(G){this.addPoint(G.x1,G.y1);this.addPoint(G.x2,G.y2)};this.addQuadraticCurve=function(H,G,I,J,K,L){var M=H+2/3*(I-H);var O=G+2/3*(J-G);var N=M+1/3*(K-H);var P=O+1/3*(L-G);this.addBezierCurve(H,G,M,N,O,P,K,L)};this.addBezierCurve=function(L,M,U,V,W,X,N,P){var S=[L,M],Z=[U,V],I=[W,X],T=[N,P];this.addPoint(S[0],S[1]);this.addPoint(T[0],T[1]);for(i=0;i<=1;i++){var R=function(a){return Math.pow(1-a,3)*S[i]+3*Math.pow(1-a,2)*a*Z[i]+3*(1-a)*Math.pow(a,2)*I[i]+Math.pow(a,3)*T[i]};var O=6*S[i]-12*Z[i]+6*I[i];var Q=-3*S[i]+9*Z[i]-9*I[i]+3*T[i];var G=3*Z[i]-3*S[i];if(Q==0){if(O==0){continue}var J=-G/O;if(0<J&&J<1){if(i==0){this.addX(R(J))}if(i==1){this.addY(R(J))}}continue}var Y=Math.pow(O,2)-4*G*Q;if(Y<0){continue}var H=(-O+Math.sqrt(Y))/(2*Q);if(0<H&&H<1){if(i==0){this.addX(R(H))}if(i==1){this.addY(R(H))}}var K=(-O-Math.sqrt(Y))/(2*Q);if(0<K&&K<1){if(i==0){this.addX(R(K))}if(i==1){this.addY(R(K))}}}};this.isPointInBox=function(G,H){return(this.x1<=G&&G<=this.x2&&this.y1<=H&&H<=this.y2)};this.addPoint(E,F);this.addPoint(C,D)};B.Transform=function(G){var F=this;this.Type={};this.Type.translate=function(J){this.p=B.CreatePoint(J);this.apply=function(K){K.translate(this.p.x||0,this.p.y||0)};this.applyToPoint=function(K){K.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}};this.Type.rotate=function(J){var K=B.ToNumberArray(J);this.angle=new B.Property("angle",K[0]);this.cx=K[1]||0;this.cy=K[2]||0;this.apply=function(L){L.translate(this.cx,this.cy);L.rotate(this.angle.Angle.toRadians());L.translate(-this.cx,-this.cy)};this.applyToPoint=function(L){var M=this.angle.Angle.toRadians();L.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]);L.applyTransform([Math.cos(M),Math.sin(M),-Math.sin(M),Math.cos(M),0,0]);L.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}};this.Type.scale=function(J){this.p=B.CreatePoint(J);this.apply=function(K){K.scale(this.p.x||1,this.p.y||this.p.x||1)};this.applyToPoint=function(K){K.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}};this.Type.matrix=function(J){this.m=B.ToNumberArray(J);this.apply=function(K){K.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])};this.applyToPoint=function(K){K.applyTransform(this.m)}};this.Type.SkewBase=function(J){this.base=F.Type.matrix;this.base(J);this.angle=new B.Property("angle",J)};this.Type.SkewBase.prototype=new this.Type.matrix;this.Type.skewX=function(J){this.base=F.Type.SkewBase;this.base(J);this.m=[1,0,Math.tan(this.angle.Angle.toRadians()),1,0,0]};this.Type.skewX.prototype=new this.Type.SkewBase;this.Type.skewY=function(J){this.base=F.Type.SkewBase;this.base(J);this.m=[1,Math.tan(this.angle.Angle.toRadians()),0,1,0,0]};this.Type.skewY.prototype=new this.Type.SkewBase;this.transforms=[];this.apply=function(K){for(var J=0;J<this.transforms.length;J++){this.transforms[J].apply(K)}};this.applyToPoint=function(K){for(var J=0;J<this.transforms.length;J++){this.transforms[J].applyToPoint(K)}};var I=B.trim(B.compressSpaces(G)).split(/\s(?=[a-z])/);for(var D=0;D<I.length;D++){var C=I[D].split("(")[0];var E=I[D].split("(")[1].replace(")","");var H=new this.Type[C](E);this.transforms.push(H)}};B.AspectRatio=function(J,Q,M,D,E,N,K,I,O,L){Q=B.compressSpaces(Q);Q=Q.replace(/^defer\s/,"");var H=Q.split(" ")[0]||"xMidYMid";var R=Q.split(" ")[1]||"meet";var C=M/D;var P=E/N;var F=Math.min(C,P);var G=Math.max(C,P);if(R=="meet"){D*=F;N*=F}if(R=="slice"){D*=G;N*=G}O=new B.Property("refX",O);L=new B.Property("refY",L);if(O.hasValue()&&L.hasValue()){J.translate(-F*O.Length.toPixels("x"),-F*L.Length.toPixels("y"))}else{if(H.match(/^xMid/)&&((R=="meet"&&F==P)||(R=="slice"&&G==P))){J.translate(M/2-D/2,0)}if(H.match(/YMid$/)&&((R=="meet"&&F==C)||(R=="slice"&&G==C))){J.translate(0,E/2-N/2)}if(H.match(/^xMax/)&&((R=="meet"&&F==P)||(R=="slice"&&G==P))){J.translate(M-D,0)}if(H.match(/YMax$/)&&((R=="meet"&&F==C)||(R=="slice"&&G==C))){J.translate(0,E-N)}}if(H=="none"){J.scale(C,P)}else{if(R=="meet"){J.scale(F,F)}else{if(R=="slice"){J.scale(G,G)}}}J.translate(K==null?0:-K,I==null?0:-I)};B.Element={};B.Element.ElementBase=function(K){this.attributes={};this.styles={};this.children=[];this.attribute=function(M,N){var O=this.attributes[M];if(O!=null){return O}O=new B.Property(M,"");if(N==true){this.attributes[M]=O}return O};this.style=function(P,Q){var M=this.styles[P];if(M!=null){return M}var R=this.attribute(P);if(R!=null&&R.hasValue()){return R}var N=this.parent;if(N!=null){var O=N.style(P);if(O!=null&&O.hasValue()){return O}}M=new B.Property(P,"");if(Q==true){this.styles[P]=M}return M};this.render=function(N){if(this.style("display").value=="none"){return}if(this.attribute("visibility").value=="hidden"){return}N.save();this.setContext(N);if(this.attribute("mask").hasValue()){var O=this.attribute("mask").Definition.getDefinition();if(O!=null){O.apply(N,this)}}else{if(this.style("filter").hasValue()){var M=this.style("filter").Definition.getDefinition();if(M!=null){M.apply(N,this)}}else{this.renderChildren(N)}}this.clearContext(N);N.restore()};this.setContext=function(M){};this.clearContext=function(M){};this.renderChildren=function(N){for(var M=0;M<this.children.length;M++){this.children[M].render(N)}};this.addChild=function(O,M){var N=O;if(M){N=B.CreateElement(O)}N.parent=this;this.children.push(N)};if(K!=null&&K.nodeType==1){for(var I=0;I<K.childNodes.length;I++){var L=K.childNodes[I];if(L.nodeType==1){this.addChild(L,true)}}for(var I=0;I<K.attributes.length;I++){var C=K.attributes[I];this.attributes[C.nodeName]=new B.Property(C.nodeName,C.nodeValue)}var E=B.Styles[K.nodeName];if(E!=null){for(var D in E){this.styles[D]=E[D]}}if(this.attribute("class").hasValue()){var F=B.compressSpaces(this.attribute("class").value).split(" ");for(var G=0;G<F.length;G++){E=B.Styles["."+F[G]];if(E!=null){for(var D in E){this.styles[D]=E[D]}}E=B.Styles[K.nodeName+"."+F[G]];if(E!=null){for(var D in E){this.styles[D]=E[D]}}}}if(this.attribute("style").hasValue()){var E=this.attribute("style").value.split(";");for(var I=0;I<E.length;I++){if(B.trim(E[I])!=""){var J=E[I].split(":");var D=B.trim(J[0]);var H=B.trim(J[1]);this.styles[D]=new B.Property(D,H)}}}if(this.attribute("id").hasValue()){if(B.Definitions[this.attribute("id").value]==null){B.Definitions[this.attribute("id").value]=this}}}};B.Element.RenderedElementBase=function(C){this.base=B.Element.ElementBase;this.base(C);this.setContext=function(G){if(this.style("fill").Definition.isUrl()){var H=this.style("fill").Definition.getFillStyle(this);if(H!=null){G.fillStyle=H}}else{if(this.style("fill").hasValue()){var I=this.style("fill");if(this.style("fill-opacity").hasValue()){I=I.Color.addOpacity(this.style("fill-opacity").value)}G.fillStyle=(I.value=="none"?"rgba(0,0,0,0)":I.value)}}if(this.style("stroke").Definition.isUrl()){var H=this.style("stroke").Definition.getFillStyle(this);if(H!=null){G.strokeStyle=H}}else{if(this.style("stroke").hasValue()){var D=this.style("stroke");if(this.style("stroke-opacity").hasValue()){D=D.Color.addOpacity(this.style("stroke-opacity").value)}G.strokeStyle=(D.value=="none"?"rgba(0,0,0,0)":D.value)}}if(this.style("stroke-width").hasValue()){G.lineWidth=this.style("stroke-width").Length.toPixels()}if(this.style("stroke-linecap").hasValue()){G.lineCap=this.style("stroke-linecap").value}if(this.style("stroke-linejoin").hasValue()){G.lineJoin=this.style("stroke-linejoin").value}if(this.style("stroke-miterlimit").hasValue()){G.miterLimit=this.style("stroke-miterlimit").value}if(typeof(G.font)!="undefined"){G.font=B.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").Length.toPixels()+"px":"",this.style("font-family").value).toString()}if(this.attribute("transform").hasValue()){var E=new B.Transform(this.attribute("transform").value);E.apply(G)}if(this.attribute("clip-path").hasValue()){var F=this.attribute("clip-path").Definition.getDefinition();if(F!=null){F.apply(G)}}if(this.style("opacity").hasValue()){G.globalAlpha=this.style("opacity").numValue()}}};B.Element.RenderedElementBase.prototype=new B.Element.ElementBase;B.Element.PathElementBase=function(C){this.base=B.Element.RenderedElementBase;this.base(C);this.path=function(D){if(D!=null){D.beginPath()}return new B.BoundingBox()};this.renderChildren=function(G){this.path(G);B.Mouse.checkPath(this,G);if(G.fillStyle!=""){G.fill()}if(G.strokeStyle!=""){G.stroke()}var D=this.getMarkers();if(D!=null){if(this.style("marker-start").Definition.isUrl()){var F=this.style("marker-start").Definition.getDefinition();F.render(G,D[0][0],D[0][1])}if(this.style("marker-mid").Definition.isUrl()){var F=this.style("marker-mid").Definition.getDefinition();for(var E=1;E<D.length-1;E++){F.render(G,D[E][0],D[E][1])}}if(this.style("marker-end").Definition.isUrl()){var F=this.style("marker-end").Definition.getDefinition();F.render(G,D[D.length-1][0],D[D.length-1][1])}}};this.getBoundingBox=function(){return this.path()};this.getMarkers=function(){return null}};B.Element.PathElementBase.prototype=new B.Element.RenderedElementBase;B.Element.svg=function(C){this.base=B.Element.RenderedElementBase;this.base(C);this.baseClearContext=this.clearContext;this.clearContext=function(D){this.baseClearContext(D);B.ViewPort.RemoveCurrent()};this.baseSetContext=this.setContext;this.setContext=function(E){E.strokeStyle="rgba(0,0,0,0)";E.lineCap="butt";E.lineJoin="miter";E.miterLimit=4;this.baseSetContext(E);if(this.attribute("x").hasValue()&&this.attribute("y").hasValue()){E.translate(this.attribute("x").Length.toPixels("x"),this.attribute("y").Length.toPixels("y"))}var G=B.ViewPort.width();var D=B.ViewPort.height();if(typeof(this.root)=="undefined"&&this.attribute("width").hasValue()&&this.attribute("height").hasValue()){G=this.attribute("width").Length.toPixels("x");D=this.attribute("height").Length.toPixels("y");var I=0;var J=0;if(this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()){I=-this.attribute("refX").Length.toPixels("x");J=-this.attribute("refY").Length.toPixels("y")}E.beginPath();E.moveTo(I,J);E.lineTo(G,J);E.lineTo(G,D);E.lineTo(I,D);E.closePath();E.clip()}B.ViewPort.SetCurrent(G,D);if(this.attribute("viewBox").hasValue()){var K=B.ToNumberArray(this.attribute("viewBox").value);var F=K[0];var H=K[1];G=K[2];D=K[3];B.AspectRatio(E,this.attribute("preserveAspectRatio").value,B.ViewPort.width(),G,B.ViewPort.height(),D,F,H,this.attribute("refX").value,this.attribute("refY").value);B.ViewPort.RemoveCurrent();B.ViewPort.SetCurrent(K[2],K[3])}}};B.Element.svg.prototype=new B.Element.RenderedElementBase;B.Element.rect=function(C){this.base=B.Element.PathElementBase;this.base(C);this.path=function(J){var H=this.attribute("x").Length.toPixels("x");var I=this.attribute("y").Length.toPixels("y");var G=this.attribute("width").Length.toPixels("x");var D=this.attribute("height").Length.toPixels("y");var F=this.attribute("rx").Length.toPixels("x");var E=this.attribute("ry").Length.toPixels("y");if(this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()){E=F}if(this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()){F=E}if(J!=null){J.beginPath();J.moveTo(H+F,I);J.lineTo(H+G-F,I);J.quadraticCurveTo(H+G,I,H+G,I+E);J.lineTo(H+G,I+D-E);J.quadraticCurveTo(H+G,I+D,H+G-F,I+D);J.lineTo(H+F,I+D);J.quadraticCurveTo(H,I+D,H,I+D-E);J.lineTo(H,I+E);J.quadraticCurveTo(H,I,H+F,I);J.closePath()}return new B.BoundingBox(H,I,H+G,I+D)}};B.Element.rect.prototype=new B.Element.PathElementBase;B.Element.circle=function(C){this.base=B.Element.PathElementBase;this.base(C);this.path=function(F){var G=this.attribute("cx").Length.toPixels("x");var D=this.attribute("cy").Length.toPixels("y");var E=this.attribute("r").Length.toPixels();if(F!=null){F.beginPath();F.arc(G,D,E,0,Math.PI*2,true);F.closePath()}return new B.BoundingBox(G-E,D-E,G+E,D+E)}};B.Element.circle.prototype=new B.Element.PathElementBase;B.Element.ellipse=function(C){this.base=B.Element.PathElementBase;this.base(C);this.path=function(G){var I=4*((Math.sqrt(2)-1)/3);var E=this.attribute("rx").Length.toPixels("x");var F=this.attribute("ry").Length.toPixels("y");var H=this.attribute("cx").Length.toPixels("x");var D=this.attribute("cy").Length.toPixels("y");if(G!=null){G.beginPath();G.moveTo(H,D-F);G.bezierCurveTo(H+(I*E),D-F,H+E,D-(I*F),H+E,D);G.bezierCurveTo(H+E,D+(I*F),H+(I*E),D+F,H,D+F);G.bezierCurveTo(H-(I*E),D+F,H-E,D+(I*F),H-E,D);G.bezierCurveTo(H-E,D-(I*F),H-(I*E),D-F,H,D-F);G.closePath()}return new B.BoundingBox(H-E,D-F,H+E,D+F)}};B.Element.ellipse.prototype=new B.Element.PathElementBase;B.Element.line=function(C){this.base=B.Element.PathElementBase;this.base(C);this.getPoints=function(){return[new B.Point(this.attribute("x1").Length.toPixels("x"),this.attribute("y1").Length.toPixels("y")),new B.Point(this.attribute("x2").Length.toPixels("x"),this.attribute("y2").Length.toPixels("y"))]};this.path=function(E){var D=this.getPoints();if(E!=null){E.beginPath();E.moveTo(D[0].x,D[0].y);E.lineTo(D[1].x,D[1].y)}return new B.BoundingBox(D[0].x,D[0].y,D[1].x,D[1].y)};this.getMarkers=function(){var D=this.getPoints();var E=D[0].angleTo(D[1]);return[[D[0],E],[D[1],E]]}};B.Element.line.prototype=new B.Element.PathElementBase;B.Element.polyline=function(C){this.base=B.Element.PathElementBase;this.base(C);this.points=B.CreatePath(this.attribute("points").value);this.path=function(E){var F=new B.BoundingBox(this.points[0].x,this.points[0].y);if(E!=null){E.beginPath();E.moveTo(this.points[0].x,this.points[0].y)}for(var D=1;D<this.points.length;D++){F.addPoint(this.points[D].x,this.points[D].y);if(E!=null){E.lineTo(this.points[D].x,this.points[D].y)}}return F};this.getMarkers=function(){var D=[];for(var E=0;E<this.points.length-1;E++){D.push([this.points[E],this.points[E].angleTo(this.points[E+1])])}D.push([this.points[this.points.length-1],D[D.length-1][1]]);return D}};B.Element.polyline.prototype=new B.Element.PathElementBase;B.Element.polygon=function(C){this.base=B.Element.polyline;this.base(C);this.basePath=this.path;this.path=function(D){var E=this.basePath(D);if(D!=null){D.lineTo(this.points[0].x,this.points[0].y);D.closePath()}return E}};B.Element.polygon.prototype=new B.Element.polyline;B.Element.path=function(D){this.base=B.Element.PathElementBase;this.base(D);var C=this.attribute("d").value;C=C.replace(/,/gm," ");C=C.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");C=C.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");C=C.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");C=C.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");C=C.replace(/([0-9])([+\-])/gm,"$1 $2");C=C.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");C=C.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");C=B.compressSpaces(C);C=B.trim(C);this.PathParser=new (function(E){this.tokens=E.split(" ");this.reset=function(){this.i=-1;this.command="";this.previousCommand="";this.start=new B.Point(0,0);this.control=new B.Point(0,0);this.current=new B.Point(0,0);this.points=[];this.angles=[]};this.isEnd=function(){return this.i>=this.tokens.length-1};this.isCommandOrEnd=function(){if(this.isEnd()){return true}return this.tokens[this.i+1].match(/^[A-Za-z]$/)!=null};this.isRelativeCommand=function(){return this.command==this.command.toLowerCase()};this.getToken=function(){this.i=this.i+1;return this.tokens[this.i]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.previousCommand=this.command;this.command=this.getToken()};this.getPoint=function(){var F=new B.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(F)};this.getAsControlPoint=function(){var F=this.getPoint();this.control=F;return F};this.getAsCurrentPoint=function(){var F=this.getPoint();this.current=F;return F};this.getReflectedControlPoint=function(){if(this.previousCommand.toLowerCase()!="c"&&this.previousCommand.toLowerCase()!="s"){return this.current}var F=new B.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return F};this.makeAbsolute=function(F){if(this.isRelativeCommand()){F.x=this.current.x+F.x;F.y=this.current.y+F.y}return F};this.addMarker=function(G,F,H){if(H!=null&&this.angles.length>0&&this.angles[this.angles.length-1]==null){this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(H)}this.addMarkerAngle(G,F==null?null:F.angleTo(G))};this.addMarkerAngle=function(F,G){this.points.push(F);this.angles.push(G)};this.getMarkerPoints=function(){return this.points};this.getMarkerAngles=function(){for(var F=0;F<this.angles.length;F++){if(this.angles[F]==null){for(var G=F+1;G<this.angles.length;G++){if(this.angles[G]!=null){this.angles[F]=this.angles[G];break}}}}return this.angles}})(C);this.path=function(P){var O=this.PathParser;O.reset();var I=new B.BoundingBox();if(P!=null){P.beginPath()}while(!O.isEnd()){O.nextCommand();switch(O.command.toUpperCase()){case"M":var G=O.getAsCurrentPoint();O.addMarker(G);I.addPoint(G.x,G.y);if(P!=null){P.moveTo(G.x,G.y)}O.start=O.current;while(!O.isCommandOrEnd()){var G=O.getAsCurrentPoint();O.addMarker(G,O.start);I.addPoint(G.x,G.y);if(P!=null){P.lineTo(G.x,G.y)}}break;case"L":while(!O.isCommandOrEnd()){var Q=O.current;var G=O.getAsCurrentPoint();O.addMarker(G,Q);I.addPoint(G.x,G.y);if(P!=null){P.lineTo(G.x,G.y)}}break;case"H":while(!O.isCommandOrEnd()){var Z=new B.Point((O.isRelativeCommand()?O.current.x:0)+O.getScalar(),O.current.y);O.addMarker(Z,O.current);O.current=Z;I.addPoint(O.current.x,O.current.y);if(P!=null){P.lineTo(O.current.x,O.current.y)}}break;case"V":while(!O.isCommandOrEnd()){var Z=new B.Point(O.current.x,(O.isRelativeCommand()?O.current.y:0)+O.getScalar());O.addMarker(Z,O.current);O.current=Z;I.addPoint(O.current.x,O.current.y);if(P!=null){P.lineTo(O.current.x,O.current.y)}}break;case"C":while(!O.isCommandOrEnd()){var U=O.current;var W=O.getPoint();var S=O.getAsControlPoint();var d=O.getAsCurrentPoint();O.addMarker(d,S,W);I.addBezierCurve(U.x,U.y,W.x,W.y,S.x,S.y,d.x,d.y);if(P!=null){P.bezierCurveTo(W.x,W.y,S.x,S.y,d.x,d.y)}}break;case"S":while(!O.isCommandOrEnd()){var U=O.current;var W=O.getReflectedControlPoint();var S=O.getAsControlPoint();var d=O.getAsCurrentPoint();O.addMarker(d,S,W);I.addBezierCurve(U.x,U.y,W.x,W.y,S.x,S.y,d.x,d.y);if(P!=null){P.bezierCurveTo(W.x,W.y,S.x,S.y,d.x,d.y)}}break;case"Q":while(!O.isCommandOrEnd()){var U=O.current;var S=O.getAsControlPoint();var d=O.getAsCurrentPoint();O.addMarker(d,S,S);I.addQuadraticCurve(U.x,U.y,S.x,S.y,d.x,d.y);if(P!=null){P.quadraticCurveTo(S.x,S.y,d.x,d.y)}}break;case"T":while(!O.isCommandOrEnd()){var U=O.current;var S=O.getReflectedControlPoint();O.control=S;var d=O.getAsCurrentPoint();O.addMarker(d,S,S);I.addQuadraticCurve(U.x,U.y,S.x,S.y,d.x,d.y);if(P!=null){P.quadraticCurveTo(S.x,S.y,d.x,d.y)}}break;case"A":while(!O.isCommandOrEnd()){var U=O.current;var k=O.getScalar();var M=O.getScalar();var j=O.getScalar()*(Math.PI/180);var J=O.getScalar();var L=O.getScalar();var d=O.getAsCurrentPoint();var N=new B.Point(Math.cos(j)*(U.x-d.x)/2+Math.sin(j)*(U.y-d.y)/2,-Math.sin(j)*(U.x-d.x)/2+Math.cos(j)*(U.y-d.y)/2);var h=Math.pow(N.x,2)/Math.pow(k,2)+Math.pow(N.y,2)/Math.pow(M,2);if(h>1){k*=Math.sqrt(h);M*=Math.sqrt(h)}var F=(J==L?-1:1)*Math.sqrt(((Math.pow(k,2)*Math.pow(M,2))-(Math.pow(k,2)*Math.pow(N.y,2))-(Math.pow(M,2)*Math.pow(N.x,2)))/(Math.pow(k,2)*Math.pow(N.y,2)+Math.pow(M,2)*Math.pow(N.x,2)));if(isNaN(F)){F=0}var K=new B.Point(F*k*N.y/M,F*-M*N.x/k);var Y=new B.Point((U.x+d.x)/2+Math.cos(j)*K.x-Math.sin(j)*K.y,(U.y+d.y)/2+Math.sin(j)*K.x+Math.cos(j)*K.y);var V=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))};var E=function(c,a){return(c[0]*a[0]+c[1]*a[1])/(V(c)*V(a))};var R=function(c,a){return(c[0]*a[1]<c[1]*a[0]?-1:1)*Math.acos(E(c,a))};var X=R([1,0],[(N.x-K.x)/k,(N.y-K.y)/M]);var b=[(N.x-K.x)/k,(N.y-K.y)/M];var H=[(-N.x-K.x)/k,(-N.y-K.y)/M];var g=R(b,H);if(E(b,H)<=-1){g=Math.PI}if(E(b,H)>=1){g=0}if(L==0&&g>0){g=g-2*Math.PI}if(L==1&&g<0){g=g+2*Math.PI}var T=new B.Point(Y.x-k*Math.cos((X+g)/2),Y.y-M*Math.sin((X+g)/2));O.addMarkerAngle(T,(X+g)/2+(L==0?1:-1)*Math.PI/2);O.addMarkerAngle(d,g+(L==0?1:-1)*Math.PI/2);I.addPoint(d.x,d.y);if(P!=null){var E=k>M?k:M;var e=k>M?1:k/M;var f=k>M?M/k:1;P.translate(Y.x,Y.y);P.rotate(j);P.scale(e,f);P.arc(0,0,E,X,X+g,1-L);P.scale(1/e,1/f);P.rotate(-j);P.translate(-Y.x,-Y.y)}}break;case"Z":if(P!=null){P.closePath()}O.current=O.start}}return I};this.getMarkers=function(){var H=this.PathParser.getMarkerPoints();var G=this.PathParser.getMarkerAngles();var E=[];for(var F=0;F<H.length;F++){E.push([H[F],G[F]])}return E}};B.Element.path.prototype=new B.Element.PathElementBase;B.Element.pattern=function(C){this.base=B.Element.ElementBase;this.base(C);this.createPattern=function(G,E){var D=new B.Element.svg();D.attributes["viewBox"]=new B.Property("viewBox",this.attribute("viewBox").value);D.attributes["x"]=new B.Property("x",this.attribute("x").value);D.attributes["y"]=new B.Property("y",this.attribute("y").value);D.attributes["width"]=new B.Property("width",this.attribute("width").value);D.attributes["height"]=new B.Property("height",this.attribute("height").value);D.children=this.children;var F=document.createElement("canvas");F.width=this.attribute("width").Length.toPixels("x");F.height=this.attribute("height").Length.toPixels("y");D.render(F.getContext("2d"));return G.createPattern(F,"repeat")}};B.Element.pattern.prototype=new B.Element.ElementBase;B.Element.marker=function(C){this.base=B.Element.ElementBase;this.base(C);this.baseRender=this.render;this.render=function(F,E,G){F.translate(E.x,E.y);if(this.attribute("orient").valueOrDefault("auto")=="auto"){F.rotate(G)}if(this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"){F.scale(F.lineWidth,F.lineWidth)}F.save();var D=new B.Element.svg();D.attributes["viewBox"]=new B.Property("viewBox",this.attribute("viewBox").value);D.attributes["refX"]=new B.Property("refX",this.attribute("refX").value);D.attributes["refY"]=new B.Property("refY",this.attribute("refY").value);D.attributes["width"]=new B.Property("width",this.attribute("markerWidth").value);D.attributes["height"]=new B.Property("height",this.attribute("markerHeight").value);D.attributes["fill"]=new B.Property("fill",this.attribute("fill").valueOrDefault("black"));D.attributes["stroke"]=new B.Property("stroke",this.attribute("stroke").valueOrDefault("none"));D.children=this.children;D.render(F);F.restore();if(this.attribute("markerUnits").valueOrDefault("strokeWidth")=="strokeWidth"){F.scale(1/F.lineWidth,1/F.lineWidth)}if(this.attribute("orient").valueOrDefault("auto")=="auto"){F.rotate(-G)}F.translate(-E.x,-E.y)}};B.Element.marker.prototype=new B.Element.ElementBase;B.Element.defs=function(C){this.base=B.Element.ElementBase;this.base(C);this.render=function(D){}};B.Element.defs.prototype=new B.Element.ElementBase;B.Element.GradientBase=function(E){this.base=B.Element.ElementBase;this.base(E);this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox");this.stops=[];for(var D=0;D<this.children.length;D++){var C=this.children[D];this.stops.push(C)}this.getGradient=function(){};this.createGradient=function(K,G){var P=this;if(this.attribute("xlink:href").hasValue()){P=this.attribute("xlink:href").Definition.getDefinition()}var I=this.getGradient(K,G);for(var N=0;N<P.stops.length;N++){I.addColorStop(P.stops[N].offset,P.stops[N].color)}if(this.attribute("gradientTransform").hasValue()){var L=B.ViewPort.viewPorts[0];var H=new B.Element.rect();H.attributes["x"]=new B.Property("x",-B.MAX_VIRTUAL_PIXELS/3);H.attributes["y"]=new B.Property("y",-B.MAX_VIRTUAL_PIXELS/3);H.attributes["width"]=new B.Property("width",B.MAX_VIRTUAL_PIXELS);H.attributes["height"]=new B.Property("height",B.MAX_VIRTUAL_PIXELS);var M=new B.Element.g();M.attributes["transform"]=new B.Property("transform",this.attribute("gradientTransform").value);M.children=[H];var F=new B.Element.svg();F.attributes["x"]=new B.Property("x",0);F.attributes["y"]=new B.Property("y",0);F.attributes["width"]=new B.Property("width",L.width);F.attributes["height"]=new B.Property("height",L.height);F.children=[M];var O=document.createElement("canvas");O.width=L.width;O.height=L.height;var J=O.getContext("2d");J.fillStyle=I;F.render(J);return J.createPattern(O,"no-repeat")}return I}};B.Element.GradientBase.prototype=new B.Element.ElementBase;B.Element.linearGradient=function(C){this.base=B.Element.GradientBase;this.base(C);this.getGradient=function(H,F){var J=F.getBoundingBox();var G=(this.gradientUnits=="objectBoundingBox"?J.x()+J.width()*this.attribute("x1").numValue():this.attribute("x1").Length.toPixels("x"));var I=(this.gradientUnits=="objectBoundingBox"?J.y()+J.height()*this.attribute("y1").numValue():this.attribute("y1").Length.toPixels("y"));var D=(this.gradientUnits=="objectBoundingBox"?J.x()+J.width()*this.attribute("x2").numValue():this.attribute("x2").Length.toPixels("x"));var E=(this.gradientUnits=="objectBoundingBox"?J.y()+J.height()*this.attribute("y2").numValue():this.attribute("y2").Length.toPixels("y"));return H.createLinearGradient(G,I,D,E)}};B.Element.linearGradient.prototype=new B.Element.GradientBase;B.Element.radialGradient=function(C){this.base=B.Element.GradientBase;this.base(C);this.getGradient=function(K,E){var F=E.getBoundingBox();var H=(this.gradientUnits=="objectBoundingBox"?F.x()+F.width()*this.attribute("cx").numValue():this.attribute("cx").Length.toPixels("x"));var G=(this.gradientUnits=="objectBoundingBox"?F.y()+F.height()*this.attribute("cy").numValue():this.attribute("cy").Length.toPixels("y"));var J=H;var I=G;if(this.attribute("fx").hasValue()){J=(this.gradientUnits=="objectBoundingBox"?F.x()+F.width()*this.attribute("fx").numValue():this.attribute("fx").Length.toPixels("x"))}if(this.attribute("fy").hasValue()){I=(this.gradientUnits=="objectBoundingBox"?F.y()+F.height()*this.attribute("fy").numValue():this.attribute("fy").Length.toPixels("y"))}var D=(this.gradientUnits=="objectBoundingBox"?(F.width()+F.height())/2*this.attribute("r").numValue():this.attribute("r").Length.toPixels());return K.createRadialGradient(J,I,0,H,G,D)}};B.Element.radialGradient.prototype=new B.Element.GradientBase;B.Element.stop=function(D){this.base=B.Element.ElementBase;this.base(D);this.offset=this.attribute("offset").numValue();var C=this.style("stop-color");if(this.style("stop-opacity").hasValue()){C=C.Color.addOpacity(this.style("stop-opacity").value)}this.color=C.value};B.Element.stop.prototype=new B.Element.ElementBase;B.Element.AnimateBase=function(C){this.base=B.Element.ElementBase;this.base(C);B.Animations.push(this);this.duration=0;this.begin=this.attribute("begin").Time.toMilliseconds();this.maxDuration=this.begin+this.attribute("dur").Time.toMilliseconds();this.getProperty=function(){var D=this.attribute("attributeType").value;var E=this.attribute("attributeName").value;if(D=="CSS"){return this.parent.style(E,true)}return this.parent.attribute(E,true)};this.initialValue=null;this.removed=false;this.calcValue=function(){return""};this.update=function(E){if(this.initialValue==null){this.initialValue=this.getProperty().value}if(this.duration>this.maxDuration){if(this.attribute("repeatCount").value=="indefinite"){this.duration=0}else{if(this.attribute("fill").valueOrDefault("remove")=="remove"&&!this.removed){this.removed=true;this.getProperty().value=this.initialValue;return true}else{return false}}}this.duration=this.duration+E;var F=false;if(this.begin<this.duration){var G=this.calcValue();if(this.attribute("type").hasValue()){var D=this.attribute("type").value;G=D+"("+G+")"}this.getProperty().value=G;F=true}return F};this.progress=function(){return((this.duration-this.begin)/(this.maxDuration-this.begin))}};B.Element.AnimateBase.prototype=new B.Element.ElementBase;B.Element.animate=function(C){this.base=B.Element.AnimateBase;this.base(C);this.calcValue=function(){var D=this.attribute("from").numValue();var E=this.attribute("to").numValue();return D+(E-D)*this.progress()}};B.Element.animate.prototype=new B.Element.AnimateBase;B.Element.animateColor=function(C){this.base=B.Element.AnimateBase;this.base(C);this.calcValue=function(){var E=new RGBColor(this.attribute("from").value);var G=new RGBColor(this.attribute("to").value);if(E.ok&&G.ok){var F=E.r+(G.r-E.r)*this.progress();var D=E.g+(G.g-E.g)*this.progress();var H=E.b+(G.b-E.b)*this.progress();return"rgb("+parseInt(F,10)+","+parseInt(D,10)+","+parseInt(H,10)+")"}return this.attribute("from").value}};B.Element.animateColor.prototype=new B.Element.AnimateBase;B.Element.animateTransform=function(C){this.base=B.Element.animate;this.base(C)};B.Element.animateTransform.prototype=new B.Element.animate;B.Element.font=function(E){this.base=B.Element.ElementBase;this.base(E);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.isRTL=false;this.isArabic=false;this.fontFace=null;this.missingGlyph=null;this.glyphs=[];for(var D=0;D<this.children.length;D++){var C=this.children[D];if(C.type=="font-face"){this.fontFace=C;if(C.style("font-family").hasValue()){B.Definitions[C.style("font-family").value]=this}}else{if(C.type=="missing-glyph"){this.missingGlyph=C}else{if(C.type=="glyph"){if(C.arabicForm!=""){this.isRTL=true;this.isArabic=true;if(typeof(this.glyphs[C.unicode])=="undefined"){this.glyphs[C.unicode]=[]}this.glyphs[C.unicode][C.arabicForm]=C}else{this.glyphs[C.unicode]=C}}}}}};B.Element.font.prototype=new B.Element.ElementBase;B.Element.fontface=function(C){this.base=B.Element.ElementBase;this.base(C);this.ascent=this.attribute("ascent").value;this.descent=this.attribute("descent").value;this.unitsPerEm=this.attribute("units-per-em").numValue()};B.Element.fontface.prototype=new B.Element.ElementBase;B.Element.missingglyph=function(C){this.base=B.Element.path;this.base(C);this.horizAdvX=0};B.Element.missingglyph.prototype=new B.Element.path;B.Element.glyph=function(C){this.base=B.Element.path;this.base(C);this.horizAdvX=this.attribute("horiz-adv-x").numValue();this.unicode=this.attribute("unicode").value;this.arabicForm=this.attribute("arabic-form").value};B.Element.glyph.prototype=new B.Element.path;B.Element.text=function(D){this.base=B.Element.RenderedElementBase;this.base(D);if(D!=null){this.children=[];for(var C=0;C<D.childNodes.length;C++){var E=D.childNodes[C];if(E.nodeType==1){this.addChild(E,true)}else{if(E.nodeType==3){this.addChild(new B.Element.tspan(E),false)}}}}this.baseSetContext=this.setContext;this.setContext=function(F){this.baseSetContext(F);if(this.style("dominant-baseline").hasValue()){F.textBaseline=this.style("dominant-baseline").value}if(this.style("alignment-baseline").hasValue()){F.textBaseline=this.style("alignment-baseline").value}};this.renderChildren=function(J){var H=this.style("text-anchor").valueOrDefault("start");var M=this.attribute("x").Length.toPixels("x");var N=this.attribute("y").Length.toPixels("y");for(var K=0;K<this.children.length;K++){var L=this.children[K];if(L.attribute("x").hasValue()){L.x=L.attribute("x").Length.toPixels("x")}else{if(L.attribute("dx").hasValue()){M+=L.attribute("dx").Length.toPixels("x")}L.x=M}var F=L.measureText(J);if(H!="start"&&(K==0||L.attribute("x").hasValue())){var O=F;for(var I=K+1;I<this.children.length;I++){var G=this.children[I];if(G.attribute("x").hasValue()){break}O+=G.measureText(J)}L.x-=(H=="end"?O:O/2)}M=L.x+F;if(L.attribute("y").hasValue()){L.y=L.attribute("y").Length.toPixels("y")}else{if(L.attribute("dy").hasValue()){N+=L.attribute("dy").Length.toPixels("y")}L.y=N}N=L.y;L.render(J)}}};B.Element.text.prototype=new B.Element.RenderedElementBase;B.Element.TextElementBase=function(C){this.base=B.Element.RenderedElementBase;this.base(C);this.getGlyph=function(F,G,D){var H=G[D];var I=null;if(F.isArabic){var E="isolated";if((D==0||G[D-1]==" ")&&D<G.length-2&&G[D+1]!=" "){E="terminal"}if(D>0&&G[D-1]!=" "&&D<G.length-2&&G[D+1]!=" "){E="medial"}if(D>0&&G[D-1]!=" "&&(D==G.length-1||G[D+1]==" ")){E="initial"}if(typeof(F.glyphs[H])!="undefined"){I=F.glyphs[H][E];if(I==null&&F.glyphs[H].type=="glyph"){I=F.glyphs[H]}}}else{I=F.glyphs[H]}if(I==null){I=F.missingGlyph}return I};this.renderChildren=function(H){var L=this.parent.style("font-family").Definition.getDefinition();if(L!=null){var F=this.parent.style("font-size").numValueOrDefault(B.Font.Parse(B.ctx.font).fontSize);var G=this.parent.style("font-style").valueOrDefault(B.Font.Parse(B.ctx.font).fontStyle);var I=this.getText();if(L.isRTL){I=I.split("").reverse().join("")}var K=B.ToNumberArray(this.parent.attribute("dx").value);for(var J=0;J<I.length;J++){var D=this.getGlyph(L,I,J);var E=F/L.fontFace.unitsPerEm;H.translate(this.x,this.y);H.scale(E,-E);var M=H.lineWidth;H.lineWidth=H.lineWidth*L.fontFace.unitsPerEm/F;if(G=="italic"){H.transform(1,0,0.4,1,0,0)}D.render(H);if(G=="italic"){H.transform(1,0,-0.4,1,0,0)}H.lineWidth=M;H.scale(1/E,-1/E);H.translate(-this.x,-this.y);this.x+=F*(D.horizAdvX||L.horizAdvX)/L.fontFace.unitsPerEm;if(typeof(K[J])!="undefined"&&!isNaN(K[J])){this.x+=K[J]}}return}if(H.strokeStyle!=""){H.strokeText(B.compressSpaces(this.getText()),this.x,this.y)}if(H.fillStyle!=""){H.fillText(B.compressSpaces(this.getText()),this.x,this.y)}};this.getText=function(){};this.measureText=function(G){var L=this.parent.style("font-family").Definition.getDefinition();if(L!=null){var E=this.parent.style("font-size").numValueOrDefault(B.Font.Parse(B.ctx.font).fontSize);var F=0;var H=this.getText();if(L.isRTL){H=H.split("").reverse().join("")}var K=B.ToNumberArray(this.parent.attribute("dx").value);for(var I=0;I<H.length;I++){var D=this.getGlyph(L,H,I);F+=(D.horizAdvX||L.horizAdvX)*E/L.fontFace.unitsPerEm;if(typeof(K[I])!="undefined"&&!isNaN(K[I])){F+=K[I]}}return F}var M=B.compressSpaces(this.getText());if(!G.measureText){return M.length*10}G.save();this.setContext(G);var J=G.measureText(M).width;G.restore();return J}};B.Element.TextElementBase.prototype=new B.Element.RenderedElementBase;B.Element.tspan=function(C){this.base=B.Element.TextElementBase;this.base(C);this.text=C.nodeType==3?C.nodeValue:C.childNodes.length>0?C.childNodes[0].nodeValue:C.text;this.getText=function(){return this.text}};B.Element.tspan.prototype=new B.Element.TextElementBase;B.Element.tref=function(C){this.base=B.Element.TextElementBase;this.base(C);this.getText=function(){var D=this.attribute("xlink:href").Definition.getDefinition();if(D!=null){return D.children[0].getText()}}};B.Element.tref.prototype=new B.Element.TextElementBase;B.Element.a=function(D){this.base=B.Element.TextElementBase;this.base(D);this.hasText=true;for(var C=0;C<D.childNodes.length;C++){if(D.childNodes[C].nodeType!=3){this.hasText=false}}this.text=this.hasText?D.childNodes[0].nodeValue:"";this.getText=function(){return this.text};this.baseRenderChildren=this.renderChildren;this.renderChildren=function(G){if(this.hasText){this.baseRenderChildren(G);var F=new B.Property("fontSize",B.Font.Parse(B.ctx.font).fontSize);B.Mouse.checkBoundingBox(this,new B.BoundingBox(this.x,this.y-F.Length.toPixels("y"),this.x+this.measureText(G),this.y))}else{var E=new B.Element.g();E.children=this.children;E.parent=this;E.render(G)}};this.onclick=function(){window.open(this.attribute("xlink:href").value)};this.onmousemove=function(){B.ctx.canvas.style.cursor="pointer"}};B.Element.a.prototype=new B.Element.TextElementBase;B.Element.image=function(D){this.base=B.Element.RenderedElementBase;this.base(D);B.Images.push(this);this.img=document.createElement("img");this.loaded=false;var C=this;this.img.onload=function(){C.loaded=true};this.img.src=this.attribute("xlink:href").value;this.renderChildren=function(I){var G=this.attribute("x").Length.toPixels("x");var H=this.attribute("y").Length.toPixels("y");var F=this.attribute("width").Length.toPixels("x");var E=this.attribute("height").Length.toPixels("y");if(F==0||E==0){return}I.save();I.translate(G,H);B.AspectRatio(I,this.attribute("preserveAspectRatio").value,F,this.img.width,E,this.img.height,0,0);I.drawImage(this.img,0,0);I.restore()}};B.Element.image.prototype=new B.Element.RenderedElementBase;B.Element.g=function(C){this.base=B.Element.RenderedElementBase;this.base(C);this.getBoundingBox=function(){var E=new B.BoundingBox();for(var D=0;D<this.children.length;D++){E.addBoundingBox(this.children[D].getBoundingBox())}return E}};B.Element.g.prototype=new B.Element.RenderedElementBase;B.Element.symbol=function(C){this.base=B.Element.RenderedElementBase;this.base(C);this.baseSetContext=this.setContext;this.setContext=function(E){this.baseSetContext(E);if(this.attribute("viewBox").hasValue()){var G=B.ToNumberArray(this.attribute("viewBox").value);var F=G[0];var D=G[1];width=G[2];height=G[3];B.AspectRatio(E,this.attribute("preserveAspectRatio").value,this.attribute("width").Length.toPixels("x"),width,this.attribute("height").Length.toPixels("y"),height,F,D);B.ViewPort.SetCurrent(G[2],G[3])}}};B.Element.symbol.prototype=new B.Element.RenderedElementBase;B.Element.style=function(Q){this.base=B.Element.ElementBase;this.base(Q);var R=Q.childNodes[0].nodeValue+(Q.childNodes.length>1?Q.childNodes[1].nodeValue:"");R=R.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"");R=B.compressSpaces(R);var P=R.split("}");for(var H=0;H<P.length;H++){if(B.trim(P[H])!=""){var U=P[H].split("{");var K=U[0].split(",");var N=U[1].split(";");for(var F=0;F<K.length;F++){var D=B.trim(K[F]);if(D!=""){var E={};for(var G=0;G<N.length;G++){var V=N[G].indexOf(":");var X=N[G].substr(0,V);var W=N[G].substr(V+1,N[G].length-V);if(X!=null&&W!=null){E[B.trim(X)]=new B.Property(B.trim(X),B.trim(W))}}B.Styles[D]=E;if(D=="@font-face"){var Y=E["font-family"].value.replace(/"/g,"");var C=E["src"].value.split(",");for(var O=0;O<C.length;O++){if(C[O].indexOf('format("svg")')>0){var I=C[O].indexOf("url");var L=C[O].indexOf(")",I);var T=C[O].substr(I+5,L-I-6);var S=B.parseXml(B.ajax(T));var J=S.getElementsByTagName("font");for(var M=0;M<J.length;M++){var Z=B.CreateElement(J[M]);B.Definitions[Y]=Z}}}}}}}}};B.Element.style.prototype=new B.Element.ElementBase;B.Element.use=function(C){this.base=B.Element.RenderedElementBase;this.base(C);this.baseSetContext=this.setContext;this.setContext=function(D){this.baseSetContext(D);if(this.attribute("x").hasValue()){D.translate(this.attribute("x").Length.toPixels("x"),0)}if(this.attribute("y").hasValue()){D.translate(0,this.attribute("y").Length.toPixels("y"))}};this.getDefinition=function(){var D=this.attribute("xlink:href").Definition.getDefinition();if(this.attribute("width").hasValue()){D.attribute("width",true).value=this.attribute("width").value}if(this.attribute("height").hasValue()){D.attribute("height",true).value=this.attribute("height").value}return D};this.path=function(E){var D=this.getDefinition();if(D!=null){D.path(E)}};this.renderChildren=function(E){var D=this.getDefinition();if(D!=null){D.render(E)}}};B.Element.use.prototype=new B.Element.RenderedElementBase;B.Element.mask=function(C){this.base=B.Element.ElementBase;this.base(C);this.apply=function(G,D){var J=this.attribute("x").Length.toPixels("x");var K=this.attribute("y").Length.toPixels("y");var I=this.attribute("width").Length.toPixels("x");var E=this.attribute("height").Length.toPixels("y");var N=D.attribute("mask").value;D.attribute("mask").value="";var L=document.createElement("canvas");L.width=J+I;L.height=K+E;var H=L.getContext("2d");this.renderChildren(H);var M=document.createElement("canvas");M.width=J+I;M.height=K+E;var F=M.getContext("2d");D.render(F);F.globalCompositeOperation="destination-in";F.fillStyle=H.createPattern(L,"no-repeat");F.fillRect(0,0,J+I,K+E);G.fillStyle=F.createPattern(M,"no-repeat");G.fillRect(0,0,J+I,K+E);D.attribute("mask").value=N};this.render=function(D){}};B.Element.mask.prototype=new B.Element.ElementBase;B.Element.clipPath=function(C){this.base=B.Element.ElementBase;this.base(C);this.apply=function(E){for(var D=0;D<this.children.length;D++){if(this.children[D].path){this.children[D].path(E);E.clip()}}};this.render=function(D){}};B.Element.clipPath.prototype=new B.Element.ElementBase;B.Element.filter=function(C){this.base=B.Element.ElementBase;this.base(C);this.apply=function(I,E){var F=E.getBoundingBox();var M=this.attribute("x").Length.toPixels("x");var N=this.attribute("y").Length.toPixels("y");if(M==0||N==0){M=F.x1;N=F.y1}var K=this.attribute("width").Length.toPixels("x");var Q=this.attribute("height").Length.toPixels("y");if(K==0||Q==0){K=F.width();Q=F.height()}var G=E.style("filter").value;E.style("filter").value="";var D=0.2;var O=D*K;var L=D*Q;var P=document.createElement("canvas");P.width=K+2*O;P.height=Q+2*L;var H=P.getContext("2d");H.translate(-M+O,-N+L);E.render(H);for(var J=0;J<this.children.length;J++){this.children[J].apply(H,0,0,K+2*O,Q+2*L)}I.drawImage(P,0,0,K+2*O,Q+2*L,M-O,N-L,K+2*O,Q+2*L);E.style("filter",true).value=G};this.render=function(D){}};B.Element.filter.prototype=new B.Element.ElementBase;B.Element.feGaussianBlur=function(E){this.base=B.Element.ElementBase;this.base(E);function H(J){J=Math.max(J,0.01);var L=Math.ceil(J*4)+1;mask=[];for(var K=0;K<L;K++){mask[K]=Math.exp(-0.5*(K/J)*(K/J))}return mask}function D(L){var K=0;for(var J=1;J<L.length;J++){K+=Math.abs(L[J])}K=2*K+Math.abs(L[0]);for(var J=0;J<L.length;J++){L[J]/=K}return L}function G(J,N,V,P,O){for(var S=0;S<O;S++){for(var R=0;R<P;R++){var T=F(J,R,S,P,O,3)/255;for(var Q=0;Q<4;Q++){var M=V[0]*(T==0?255:F(J,R,S,P,O,Q))*(T==0||Q==3?1:T);for(var U=1;U<V.length;U++){var K=F(J,Math.max(R-U,0),S,P,O,3)/255;var L=F(J,Math.min(R+U,P-1),S,P,O,3)/255;M+=V[U]*((K==0?255:F(J,Math.max(R-U,0),S,P,O,Q))*(K==0||Q==3?1:K)+(L==0?255:F(J,Math.min(R+U,P-1),S,P,O,Q))*(L==0||Q==3?1:L))}C(N,S,R,O,P,Q,M)}}}}function F(N,K,L,M,J,O){return N[L*M*4+K*4+O]}function C(O,L,M,N,J,P,K){O[M*N*4+L*4+P]=K}function I(M,L,K,J){var O=M.getImageData(0,0,L,K);var N=H(J);N=D(N);tmp=[];G(O.data,tmp,N,L,K);G(tmp,O.data,N,K,L);M.clearRect(0,0,L,K);M.putImageData(O,0,0)}this.apply=function(N,L,M,K,J){I(N,K,J,this.attribute("stdDeviation").numValue())}};B.Element.filter.prototype=new B.Element.feGaussianBlur;B.Element.title=function(C){};B.Element.title.prototype=new B.Element.ElementBase;B.Element.desc=function(C){};B.Element.desc.prototype=new B.Element.ElementBase;B.Element.MISSING=function(C){console.log("ERROR: Element '"+C.nodeName+"' not yet implemented.")};B.Element.MISSING.prototype=new B.Element.ElementBase;B.CreateElement=function(E){var C=E.nodeName.replace(/^[^:]+:/,"");C=C.replace(/\-/g,"");var D=null;if(typeof(B.Element[C])!="undefined"){D=new B.Element[C](E)}else{D=new B.Element.MISSING(E)}D.type=E.nodeName;return D};B.load=function(D,C){B.loadXml(D,B.ajax(C))};B.loadXml=function(D,C){B.loadXmlDoc(D,B.parseXml(C))};B.loadXmlDoc=function(H,C){B.init(H);var E=function(K){var J=H.canvas;while(J){K.x-=J.offsetLeft;K.y-=J.offsetTop;J=J.offsetParent}if(window.scrollX){K.x+=window.scrollX}if(window.scrollY){K.y+=window.scrollY}return K};if(B.opts["ignoreMouse"]!=true){H.canvas.onclick=function(J){var K=E(new B.Point(J!=null?J.clientX:event.clientX,J!=null?J.clientY:event.clientY));B.Mouse.onclick(K.x,K.y)};H.canvas.onmousemove=function(J){var K=E(new B.Point(J!=null?J.clientX:event.clientX,J!=null?J.clientY:event.clientY));B.Mouse.onmousemove(K.x,K.y)}}var D=B.CreateElement(C.documentElement);D.root=true;var G=true;var I=function(){B.ViewPort.Clear();if(H.canvas.parentNode){B.ViewPort.SetCurrent(H.canvas.parentNode.clientWidth,H.canvas.parentNode.clientHeight)}if(B.opts["ignoreDimensions"]!=true){if(D.style("width").hasValue()){H.canvas.width=D.style("width").Length.toPixels("x");H.canvas.style.width=H.canvas.width+"px"}if(D.style("height").hasValue()){H.canvas.height=D.style("height").Length.toPixels("y");H.canvas.style.height=H.canvas.height+"px"}}var J=H.canvas.clientWidth||H.canvas.width;var K=H.canvas.clientHeight||H.canvas.height;B.ViewPort.SetCurrent(J,K);if(B.opts!=null&&B.opts["offsetX"]!=null){D.attribute("x",true).value=B.opts["offsetX"]}if(B.opts!=null&&B.opts["offsetY"]!=null){D.attribute("y",true).value=B.opts["offsetY"]}if(B.opts!=null&&B.opts["scaleWidth"]!=null&&B.opts["scaleHeight"]!=null){var M=1,L=1;if(D.attribute("width").hasValue()){M=D.attribute("width").Length.toPixels("x")/B.opts["scaleWidth"]}if(D.attribute("height").hasValue()){L=D.attribute("height").Length.toPixels("y")/B.opts["scaleHeight"]}D.attribute("width",true).value=B.opts["scaleWidth"];D.attribute("height",true).value=B.opts["scaleHeight"];D.attribute("viewBox",true).value="0 0 "+(J*M)+" "+(K*L);D.attribute("preserveAspectRatio",true).value="none"}if(B.opts["ignoreClear"]!=true){H.clearRect(0,0,J,K)}D.render(H);if(G){G=false;if(B.opts!=null&&typeof(B.opts["renderCallback"])=="function"){B.opts["renderCallback"]()}}};var F=true;if(B.ImagesLoaded()){F=false;I()}B.intervalID=setInterval(function(){var K=false;if(F&&B.ImagesLoaded()){F=false;K=true}if(B.opts["ignoreMouse"]!=true){K=K|B.Mouse.hasEvents()}if(B.opts["ignoreAnimation"]!=true){for(var J=0;J<B.Animations.length;J++){K=K|B.Animations[J].update(1000/B.FRAMERATE)}}if(B.opts!=null&&typeof(B.opts["forceRedraw"])=="function"){if(B.opts["forceRedraw"]()==true){K=true}}if(K){I();B.Mouse.runEvents()}},1000/B.FRAMERATE)};B.stop=function(){if(B.intervalID){clearInterval(B.intervalID)}};B.Mouse=new (function(){this.events=[];this.hasEvents=function(){return this.events.length!=0};this.onclick=function(C,D){this.events.push({type:"onclick",x:C,y:D,run:function(E){if(E.onclick){E.onclick()}}})};this.onmousemove=function(C,D){this.events.push({type:"onmousemove",x:C,y:D,run:function(E){if(E.onmousemove){E.onmousemove()}}})};this.eventElements=[];this.checkPath=function(E,F){for(var C=0;C<this.events.length;C++){var D=this.events[C];if(F.isPointInPath&&F.isPointInPath(D.x,D.y)){this.eventElements[C]=E}}};this.checkBoundingBox=function(E,F){for(var C=0;C<this.events.length;C++){var D=this.events[C];if(F.isPointInBox(D.x,D.y)){this.eventElements[C]=E}}};this.runEvents=function(){B.ctx.canvas.style.cursor="";for(var C=0;C<this.events.length;C++){var D=this.events[C];var E=this.eventElements[C];while(E){D.run(E);E=E.parent}}this.events=[];this.eventElements=[]}});return B}})();if(CanvasRenderingContext2D){CanvasRenderingContext2D.prototype.drawSvg=function(B,C,D,E,A){canvg(this.canvas,B,{ignoreMouse:true,ignoreAnimation:true,ignoreDimensions:true,ignoreClear:true,offsetX:C,offsetY:D,scaleWidth:E,scaleHeight:A})}}(function(D){var O,I="div",K="absolute",B="relative",H="hidden",M="visible",C="px",L=D.css,F=D.CanVGRenderer,J=D.SVGRenderer,E=D.extend,G=D.merge,N=D.addEvent,P=D.createElement,A=D.discardElement;E(F.prototype,J.prototype);E(F.prototype,{create:function(Q,S,R,T){this.setContainer(S,R,T);this.configure(Q)},setContainer:function(Y,U,Z){var W=Y.style,Q=Y.parentNode,X=W.left,a=W.top,T=Y.offsetWidth,R=Y.offsetHeight,S,V={visibility:H,position:K};this.init.apply(this,[Y,U,Z]);S=P("canvas",{width:T,height:R},{position:B,left:X,top:a},Y);this.canvas=S;this.ttLine=P(I,null,V,Q);this.ttDiv=P(I,null,V,Q);this.ttTimer=O;var b=P(I,{width:T,height:R},{visibility:H,left:X,top:a},Q);this.hiddenSvg=b;b.appendChild(this.box)},configure:function(X){var R=this,U=X.options.tooltip,S=U.borderWidth,T=R.ttDiv,W=U.style,V=R.ttLine,Q=parseInt(W.padding,10);W=G(W,{padding:Q+C,"background-color":U.backgroundColor,"border-style":"solid","border-width":S+C,"border-radius":U.borderRadius+C});if(U.shadow){W=G(W,{"box-shadow":"1px 1px 3px gray","-webkit-box-shadow":"1px 1px 3px gray"})}L(T,W);L(V,{"border-left":"1px solid darkgray"});N(X,"tooltipRefresh",function(c){var b=X.container,Y=b.offsetLeft,a=b.offsetTop,Z;T.innerHTML=c.text;Z=X.tooltip.getPosition(T.offsetWidth,T.offsetHeight,{plotX:c.x,plotY:c.y});L(T,{visibility:M,left:Z.x+C,top:Z.y+C,"border-color":c.borderColor});L(V,{visibility:M,left:Y+c.x+C,top:a+X.plotTop+C,height:X.plotHeight+C});if(R.ttTimer!==O){clearTimeout(R.ttTimer)}R.ttTimer=setTimeout(function(){L(T,{visibility:H});L(V,{visibility:H})},3000)})},destroy:function(){var Q=this;A(Q.canvas);if(Q.ttTimer!==O){clearTimeout(Q.ttTimer)}A(Q.ttLine);A(Q.ttDiv);A(Q.hiddenSvg);return J.prototype.destroy.apply(Q)},color:function(S,Q,R){if(S&&S.linearGradient){S=S.stops[S.stops.length-1][1]}return J.prototype.color.call(this,S,Q,R)},draw:function(){var Q=this;window.canvg(Q.canvas,Q.hiddenSvg.innerHTML)}})}(Highcharts));