(function(F){var B=F.getOptions(),E=B.plotOptions,C=F.seriesTypes,D=F.merge,G=function(){},A=F.each;E.funnel=D(E.pie,{center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",dataLabels:{connectorWidth:1,connectorColor:"#606060"},size:true,states:{select:{color:"#C0C0C0",borderColor:"#000000",shadow:false}}});C.funnel=F.extendClass(C.pie,{type:"funnel",animate:G,translate:function(){var e=function(k,l){return(/%$/).test(k)?l*parseInt(k,10)/100:parseInt(k,10)},S=0,V=this,H=V.chart,Q=H.plotWidth,L=H.plotHeight,h=0,a=V.options,K=a.center,i=e(K[0],Q),j=e(K[0],L),W=e(a.width,Q),J,d,g=e(a.height,L),f=e(a.neckWidth,Q),M=e(a.neckHeight,L),b=g-M,R=V.data,T,I,U=a.dataLabels.position==="left"?1:0,c,Z,X,P,Y,N,O;V.getWidthAt=d=function(k){return k>g-M||g===M?f:f+(W-f)*((g-M-k)/(g-M))};V.getX=function(l,k){return i+(k?-1:1)*((d(l)/2)+a.dataLabels.distance)};V.center=[i,j,g];V.centerX=i;A(R,function(k){S+=k.y});A(R,function(k){O=null;I=S?k.y/S:0;Z=j-g/2+h*g;Y=Z+I*g;J=d(Z);c=i-J/2;X=c+J;J=d(Y);P=i-J/2;N=P+J;if(Z>b){c=P=i-f/2;X=N=i+f/2}else{if(Y>b){O=Y;J=d(b);P=i-J/2;N=P+J;Y=b}}T=["M",c,Z,"L",X,Z,N,Y];if(O){T.push(N,O,P,O)}T.push(P,Y,"Z");k.shapeType="path";k.shapeArgs={d:T};k.percentage=I*100;k.plotX=i;k.plotY=(Z+(O||Y))/2;k.tooltipPos=[i,k.plotY];k.slice=G;k.half=U;h+=I});V.setTooltipPoints()},drawPoints:function(){var J=this,I=J.options,H=J.chart,K=H.renderer;A(J.data,function(M){var L=M.graphic,N=M.shapeArgs;if(!L){M.graphic=K.path(N).attr({fill:M.color,stroke:I.borderColor,"stroke-width":I.borderWidth}).add(J.group)}else{L.animate(N)}})},sortByAngle:G,drawDataLabels:function(){var H=this.data,K=this.options.dataLabels.distance,I,O,N,J=H.length,L,M;this.center[2]-=2*K;while(J--){N=H[J];I=N.half;O=I?1:-1;M=N.plotY;L=this.getX(M,I);N.labelPos=[0,M,L+(K-5)*O,M,L+K*O,M,I?"right":"left",0]}C.pie.prototype.drawDataLabels.call(this)}})}(Highcharts));