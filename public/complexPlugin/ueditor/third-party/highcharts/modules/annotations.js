(function(M,J){function P(A){return typeof A==="number"}function N(A){return A!==O&&A!==null}var O,G,E,F=M.Chart,H=M.extend,Q=M.each;E=["path","rect","circle"];G={top:0,left:0,center:0.5,middle:0.5,bottom:1,right:1};var I=J.inArray,L=M.merge,K=function(){this.init.apply(this,arguments)};K.prototype={init:function(D,A){var C=A.shape&&A.shape.type;this.chart=D;var B,R;R={xAxis:0,yAxis:0,title:{style:{},text:"",x:0,y:0},shape:{params:{stroke:"#000000",fill:"transparent",strokeWidth:2}}};B={circle:{params:{x:0,y:0}}};if(B[C]){R.shape=L(R.shape,B[C])}this.options=L({},R,A)},render:function(T){var V=this.chart,S=this.chart.renderer,R=this.group,U=this.title,A=this.shape,B=this.options,C=B.title,D=B.shape;if(!R){R=this.group=S.g()}if(!A&&D&&I(D.type,E)!==-1){A=this.shape=S[B.shape.type](D.params),A.add(R)}if(!U&&C){U=this.title=S.label(C),U.add(R)}R.add(V.annotations.group);this.linkObjects();T!==!1&&this.redraw()},redraw:function(){var Z=this.options,n=this.chart,Y=this.group,X=this.title,i=this.shape,p=this.linkedObject,U=n.xAxis[Z.xAxis],D=n.yAxis[Z.yAxis],W=Z.width,R=Z.height,t=G[Z.anchorY],u=G[Z.anchorX],S,V,m,C;if(p){S=p instanceof M.Point?"point":p instanceof M.Series?"series":null,S==="point"?(Z.xValue=p.x,Z.yValue=p.y,V=p.series):S==="series"&&(V=p),Y.visibility!==V.group.visibility&&Y.attr({visibility:V.group.visibility})}p=N(Z.xValue)?U.toPixels(Z.xValue+U.minPointOffset)-U.minPixelPadding:Z.x;S=N(Z.yValue)?D.toPixels(Z.yValue):Z.y;if(!isNaN(p)&&!isNaN(S)&&P(p)&&P(S)){X&&(X.attr(Z.title),X.css(Z.title.style));if(i){X=H({},Z.shape.params);if(Z.units==="values"){for(m in X){I(m,["width","x"])>-1?X[m]=U.translate(X[m]):I(m,["height","y"])>-1&&(X[m]=D.translate(X[m]))}X.width&&(X.width-=U.toPixels(0)-U.left);X.x&&(X.x+=U.minPixelPadding);if(Z.shape.type==="path"){m=X.d;V=p;for(var A=S,B=m.length,T=0;T<B;){typeof m[T]==="number"&&typeof m[T+1]==="number"?(m[T]=U.toPixels(m[T])-V,m[T+1]=D.toPixels(m[T+1])-A,T+=2):T+=1}}}Z.shape.type==="circle"&&(X.x+=X.r,X.y+=X.r);i.attr(X)}Y.bBox=null;if(!P(W)){C=Y.getBBox(),W=C.width}if(!P(R)){C||(C=Y.getBBox()),R=C.height}if(!P(u)){u=G.center}if(!P(t)){t=G.center}p-=W*u;S-=R*t;n.animation&&N(Y.translateX)&&N(Y.translateY)?Y.animate({translateX:p,translateY:S}):Y.translate(p,S)}},destroy:function(){var C=this,A=this.chart.annotations.allItems,B=A.indexOf(C);B>-1&&A.splice(B,1);Q(["title","shape","group"],function(D){C[D]&&(C[D].destroy(),C[D]=null)});C.group=C.title=C.shape=C.chart=C.options=null},update:function(B,A){H(this.options,B);this.linkObjects();this.render(A)},linkObjects:function(){var D=this.chart,A=this.linkedObject,C=A&&(A.id||A.options.id),B=this.options.linkedTo;if(N(B)){if(!N(A)||B!==C){this.linkedObject=D.get(B)}}else{this.linkedObject=null}}};H(F.prototype,{annotations:{add:function(R,A){var D=this.allItems,C=this.chart,S,B;Object.prototype.toString.call(R)==="[object Array]"||(R=[R]);for(B=R.length;B--;){S=new K(C,R[B]),D.push(S),S.render(A)}},redraw:function(){Q(this.allItems,function(A){A.redraw()})}}});F.prototype.callbacks.push(function(C){var A=C.options.annotations,B;B=C.renderer.g("annotations");B.attr({zIndex:7});B.add();C.annotations.allItems=[];C.annotations.chart=C;C.annotations.group=B;Object.prototype.toString.call(A)==="[object Array]"&&A.length>0&&C.annotations.add(C.options.annotations);M.addEvent(C,"redraw",function(){C.annotations.redraw()})})})(Highcharts,HighchartsAdapter);