(function(A){var C=A.each,B=function(D,E){this.init(D,E)};A.extend(B.prototype,{init:function(D,E){this.options=D;this.chartOptions=E;this.columns=D.columns||this.rowsToColumns(D.rows)||[];this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},getColumnDistribution:function(){var D=this.chartOptions,F=D&&D.chart&&D.chart.type,E=[];C(D&&D.series||[],function(G){E.push((A.seriesTypes[G.type||F||"line"].prototype.pointArrayMap||[0]).length)});this.valueCount={global:(A.seriesTypes[F||"line"].prototype.pointArrayMap||[0]).length,individual:E}},dataFound:function(){this.parseTypes();this.findHeaderRow();this.parsed();this.complete()},parseCSV:function(){var G=this,I=this.options,H=I.csv,L=this.columns,J=I.startRow||0,F=I.endRow||Number.MAX_VALUE,E=I.startColumn||0,D=I.endColumn||Number.MAX_VALUE,K=0;H&&(H=H.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(I.lineDelimiter||"\n"),C(H,function(P,M){var N=G.trim(P),O=N.indexOf("#")===0;M>=J&&M<=F&&!O&&N!==""&&(N=P.split(I.itemDelimiter||","),C(N,function(Q,R){R>=E&&R<=D&&(L[R-E]||(L[R-E]=[]),L[R-E][K]=Q)}),K+=1)}),this.dataFound())},parseTable:function(){var G=this.options,I=G.table,H=this.columns,K=G.startRow||0,J=G.endRow||Number.MAX_VALUE,F=G.startColumn||0,E=G.endColumn||Number.MAX_VALUE,D;I&&(typeof I==="string"&&(I=document.getElementById(I)),C(I.getElementsByTagName("tr"),function(M,L){D=0;L>=K&&L<=J&&C(M.childNodes,function(N){if((N.tagName==="TD"||N.tagName==="TH")&&D>=F&&D<=E){H[D]||(H[D]=[]),H[D][L-K]=N.innerHTML,D+=1}})}),this.dataFound())},parseGoogleSpreadsheet:function(){var H=this,J=this.options,I=J.googleSpreadsheetKey,M=this.columns,K=J.startRow||0,G=J.endRow||Number.MAX_VALUE,E=J.startColumn||0,D=J.endColumn||Number.MAX_VALUE,L,F;I&&jQuery.getJSON("https://spreadsheets.google.com/feeds/cells/"+I+"/"+(J.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",function(R){var R=R.feed.entry,Q,S=R.length,P=0,N=0,O;for(O=0;O<S;O++){Q=R[O],P=Math.max(P,Q.gs$cell.col),N=Math.max(N,Q.gs$cell.row)}for(O=0;O<P;O++){if(O>=E&&O<=D){M[O-E]=[],M[O-E].length=Math.min(N,G-K)}}for(O=0;O<S;O++){if(Q=R[O],L=Q.gs$cell.row-1,F=Q.gs$cell.col-1,F>=E&&F<=D&&L>=K&&L<=G){M[F-E][L-K]=Q.content.$t}}H.dataFound()})},findHeaderRow:function(){C(this.columns,function(){});this.headerRow=0},trim:function(D){return typeof D==="string"?D.replace(/^\s+|\s+$/g,""):D},parseTypes:function(){for(var F=this.columns,H=F.length,G,D,I,E;H--;){for(G=F[H].length;G--;){D=F[H][G],I=parseFloat(D),E=this.trim(D),E==I?(F[H][G]=I,I>31536000000?F[H].isDatetime=!0:F[H].isNumeric=!0):(D=this.parseDate(D),H===0&&typeof D==="number"&&!isNaN(D)?(F[H][G]=D,F[H].isDatetime=!0):F[H][G]=E===""?null:E)}}},dateFormats:{"YYYY-mm-dd":{regex:"^([0-9]{4})-([0-9]{2})-([0-9]{2})$",parser:function(D){return Date.UTC(+D[1],D[2]-1,+D[3])}}},parseDate:function(E){var G=this.options.parseDate,F,D,H;G&&(F=G(E));if(typeof E==="string"){for(D in this.dateFormats){G=this.dateFormats[D],(H=E.match(G.regex))&&(F=G.parser(H))}}return F},rowsToColumns:function(F){var H,G,D,I,E;if(F){E=[];G=F.length;for(H=0;H<G;H++){I=F[H].length;for(D=0;D<I;D++){E[D]||(E[D]=[]),E[D][H]=F[H][D]}}}return E},parsed:function(){this.options.parsed&&this.options.parsed.call(this,this.columns)},complete:function(){var H=this.columns,J,I,M=this.options,K,G,E,D,L,F;if(M.complete){this.getColumnDistribution();H.length>1&&(J=H.shift(),this.headerRow===0&&J.shift(),J.isDatetime?I="datetime":J.isNumeric||(I="category"));for(D=0;D<H.length;D++){if(this.headerRow===0){H[D].name=H[D].shift()}}G=[];for(D=0,F=0;D<H.length;F++){K=A.pick(this.valueCount.individual[F],this.valueCount.global);E=[];for(L=0;L<H[D].length;L++){E[L]=[J[L],H[D][L]!==void 0?H[D][L]:null],K>1&&E[L].push(H[D+1][L]!==void 0?H[D+1][L]:null),K>2&&E[L].push(H[D+2][L]!==void 0?H[D+2][L]:null),K>3&&E[L].push(H[D+3][L]!==void 0?H[D+3][L]:null),K>4&&E[L].push(H[D+4][L]!==void 0?H[D+4][L]:null)}G[F]={name:H[D].name,data:E};D+=K}M.complete({xAxis:{type:I},series:G})}}});A.Data=B;A.data=function(D,E){return new B(D,E)};A.wrap(A.Chart.prototype,"init",function(E,G,F){var D=this;G&&G.data?A.data(A.extend(G.data,{complete:function(H){G.series&&C(G.series,function(I,J){G.series[J]=A.merge(I,H.series[J])});G=A.merge(H,G);E.call(D,G,F)}}),G):E.call(D,G,F)})})(Highcharts);