(function(G){var B,M=G.Axis,A=G.Chart,R=G.Point,O=G.Pointer,H=G.each,J=G.extend,N=G.merge,K=G.pick,I=G.numberFormat,C=G.getOptions(),Q=G.seriesTypes,D=C.plotOptions,S=G.wrap,F=G.Color,L=function(){};function E(T,V,W){var U=4,X=[];while(U--){X[U]=Math.round(V.rgba[U]+(T.rgba[U]-V.rgba[U])*(1-W))}return"rgba("+X.join(",")+")"}C.mapNavigation={buttonOptions:{align:"right",verticalAlign:"bottom",x:0,width:18,height:18,style:{fontSize:"15px",fontWeight:"bold",textAlign:"center"}},buttons:{zoomIn:{onclick:function(){this.mapZoom(0.5)},text:"+",y:-32},zoomOut:{onclick:function(){this.mapZoom(2)},text:"-",y:0}}};G.splitPath=function(U){var T;U=U.replace(/([A-Za-z])/g," $1 ");U=U.replace(/^\s*/,"").replace(/\s*$/,"");U=U.split(/[ ,]+/);for(T=0;T<U.length;T++){if(!/[a-zA-Z]/.test(U[T])){U[T]=parseFloat(U[T])}}return U};G.maps={};S(M.prototype,"getSeriesExtremes",function(U){var V=this.isXAxis,T,X,W=[];H(this.series,function(Z,Y){if(Z.useMapGeometry){W[Y]=Z.xData;Z.xData=[]}});U.call(this);T=K(this.dataMin,Number.MAX_VALUE);X=K(this.dataMax,Number.MIN_VALUE);H(this.series,function(Z,Y){if(Z.useMapGeometry){T=Math.min(T,Z[V?"minX":"minY"]);X=Math.max(X,Z[V?"maxX":"maxY"]);Z.xData=W[Y]}});this.dataMin=T;this.dataMax=X});S(M.prototype,"setAxisTranslation",function(X){var Z=this.chart,a,W=Z.plotWidth/Z.plotHeight,U=this.isXAxis,T,Y=Z.xAxis[0],V;X.call(this);if(Z.options.chart.type==="map"&&!U&&Y.transA!==B){this.transA=Y.transA=Math.min(this.transA,Y.transA);a=(Y.max-Y.min)/(this.max-this.min);V=a>W?this:Y;T=(V.max-V.min)*V.transA;V.minPixelPadding=(V.len-T)/2}});S(A.prototype,"render",function(U){var T=this,V=T.options.mapNavigation;U.call(T);T.renderMapNavigation();if(V.zoomOnDoubleClick){G.addEvent(T.container,"dblclick",function(W){T.pointer.onContainerDblClick(W)})}if(V.zoomOnMouseWheel){G.addEvent(T.container,document.onmousewheel===undefined?"DOMMouseScroll":"mousewheel",function(W){T.pointer.onContainerMouseWheel(W)})}});J(O.prototype,{onContainerDblClick:function(U){var T=this.chart;U=this.normalize(U);if(T.isInsidePlot(U.chartX-T.plotLeft,U.chartY-T.plotTop)){T.mapZoom(0.5,T.xAxis[0].toValue(U.chartX),T.yAxis[0].toValue(U.chartY))}},onContainerMouseWheel:function(U){var T=this.chart,V;U=this.normalize(U);V=U.detail||-(U.wheelDelta/120);if(T.isInsidePlot(U.chartX-T.plotLeft,U.chartY-T.plotTop)){T.mapZoom(V>0?2:0.5,T.xAxis[0].toValue(U.chartX),T.yAxis[0].toValue(U.chartY))}}});S(O.prototype,"init",function(U,T,V){U.call(this,T,V);if(V.mapNavigation.enableTouchZoom){this.pinchX=this.pinchHor=this.pinchY=this.pinchVert=true}});J(A.prototype,{renderMapNavigation:function(){var T=this,W=this.options.mapNavigation,X=W.buttons,V,U,Z,Y=function(){this.handler.call(T)};if(W.enableButtons){for(V in X){if(X.hasOwnProperty(V)){Z=N(W.buttonOptions,X[V]);U=T.renderer.button(Z.text,0,0,Y).attr({width:Z.width,height:Z.height}).css(Z.style).add();U.handler=Z.onclick;U.align(J(Z,{width:U.width,height:U.height}),null,"spacingBox")}}}},fitToBox:function(U,T){H([["x","width"],["y","height"]],function(X){var W=X[0],V=X[1];if(U[W]+U[V]>T[W]+T[V]){if(U[V]>T[V]){U[V]=T[V];U[W]=T[W]}else{U[W]=T[W]+T[V]-U[V]}}if(U[V]>T[V]){U[V]=T[V]}if(U[W]<T[W]){U[W]=T[W]}});return U},mapZoom:function(f,b,X){if(this.isMapZooming){return}var h=this,U=h.xAxis[0],Y=U.max-U.min,g=K(b,U.min+Y/2),d=Y*f,W=h.yAxis[0],i=W.max-W.min,j=K(X,W.min+i/2),Z=i*f,T=g-d/2,a=j-Z/2,e=K(h.options.chart.animation,true),c,V=h.fitToBox({x:T,y:a,width:d,height:Z},{x:U.dataMin,y:W.dataMin,width:U.dataMax-U.dataMin,height:W.dataMax-W.dataMin});U.setExtremes(V.x,V.x+V.width,false);W.setExtremes(V.y,V.y+V.height,false);c=e?e.duration||500:0;if(c){h.isMapZooming=true;setTimeout(function(){h.isMapZooming=false},c)}h.redraw()}});D.map=N(D.scatter,{animation:false,nullColor:"#F8F8F8",borderColor:"silver",borderWidth:1,marker:null,stickyTracking:false,dataLabels:{verticalAlign:"middle"},turboThreshold:0,tooltip:{followPointer:true,pointFormat:"{point.name}: {point.y}<br/>"},states:{normal:{animation:true}}});var P=G.extendClass(R,{applyOptions:function(U,V){var T=R.prototype.applyOptions.call(this,U,V);if(T.path&&typeof T.path==="string"){T.path=T.options.path=G.splitPath(T.path)}return T},onMouseOver:function(){clearTimeout(this.colorInterval);R.prototype.onMouseOver.call(this)},onMouseOut:function(){var V=this,X=+new Date(),T=F(V.options.color),Y=F(V.pointAttr.hover.fill),U=V.series.options.states.normal.animation,W=U&&(U.duration||500);if(W&&T.rgba.length===4&&Y.rgba.length===4){delete V.pointAttr[""].fill;clearTimeout(V.colorInterval);V.colorInterval=setInterval(function(){var a=(new Date()-X)/W,Z=V.graphic;if(a>1){a=1}if(Z){Z.attr("fill",E(Y,T,a))}if(a>=1){clearTimeout(V.colorInterval)}},13)}R.prototype.onMouseOut.call(V)}});Q.map=G.extendClass(Q.scatter,{type:"map",pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},colorKey:"y",pointClass:P,trackerGroups:["group","markerGroup","dataLabelsGroup"],getSymbol:L,supportsDrilldown:true,getExtremesFromAll:true,useMapGeometry:true,init:function(X){var d=this,U=X.options.legend.valueDecimals,Y=[],e,b,f,V,Z,a,T,g,W,h,c=X.options.legend.layout==="horizontal";G.Series.prototype.init.apply(this,arguments);a=d.options.colorRange;T=d.options.valueRanges;if(T){H(T,function(i){b=i.from;f=i.to;e="";if(b===B){e="< "}else{if(f===B){e="> "}}if(b!==B){e+=I(b,U)}if(b!==B&&f!==B){e+=" - "}if(f!==B){e+=I(f,U)}Y.push(G.extend({chart:d.chart,name:e,options:{},drawLegendSymbol:Q.area.prototype.drawLegendSymbol,visible:true,setState:function(){},setVisible:function(){}},i))});d.legendItems=Y}else{if(a){b=a.from;f=a.to;V=a.fromLabel;Z=a.toLabel;W=c?[0,0,1,0]:[0,1,0,0];if(!c){h=V;V=Z;Z=h}g={linearGradient:{x1:W[0],y1:W[1],x2:W[2],y2:W[3]},stops:[[0,b],[1,f]]};Y=[{chart:d.chart,options:{},fromLabel:V,toLabel:Z,color:g,drawLegendSymbol:this.drawLegendSymbolGradient,visible:true,setState:function(){},setVisible:function(){}}];d.legendItems=Y}}},drawLegendSymbol:Q.area.prototype.drawLegendSymbol,drawLegendSymbolGradient:function(a,e){var Z=a.options.symbolPadding,b=K(a.options.padding,8),V,U,d=this.chart.renderer.fontMetrics(a.options.itemStyle.fontSize).h,c=a.options.layout==="horizontal",Y,W,T,X=K(a.options.rectangleLength,200);if(c){V=-(Z/2);U=0}else{V=-X+a.baseline-(Z/2);U=b+d}e.fromText=this.chart.renderer.text(e.fromLabel,U,V).attr({zIndex:2}).add(e.legendGroup);Y=e.fromText.getBBox();e.legendSymbol=this.chart.renderer.rect(c?Y.x+Y.width+Z:Y.x-d-Z,Y.y,c?X:d,c?d:X,2).attr({zIndex:1}).add(e.legendGroup);W=e.legendSymbol.getBBox();e.toText=this.chart.renderer.text(e.toLabel,W.x+W.width+Z,c?V:W.y+W.height-Z).attr({zIndex:2}).add(e.legendGroup);T=e.toText.getBBox();if(c){a.offsetWidth=Y.width+W.width+T.width+(Z*2)+b;a.itemY=d+b}else{a.offsetWidth=Math.max(Y.width,T.width)+(Z)+W.width+b;a.itemY=W.height+b;a.itemX=Z}},getBox:function(X){var U=Number.MIN_VALUE,W=Number.MAX_VALUE,T=Number.MIN_VALUE,V=Number.MAX_VALUE;H(X||this.options.data,function(d){var b=d.path,a=b.length,c=false,Z=Number.MIN_VALUE,e=Number.MAX_VALUE,f=Number.MIN_VALUE,Y=Number.MAX_VALUE;while(a--){if(typeof b[a]==="number"&&!isNaN(b[a])){if(c){Z=Math.max(Z,b[a]);e=Math.min(e,b[a])}else{f=Math.max(f,b[a]);Y=Math.min(Y,b[a])}c=!c}}d._maxX=Z;d._minX=e;d._maxY=f;d._minY=Y;U=Math.max(U,Z);W=Math.min(W,e);T=Math.max(T,f);V=Math.min(V,Y)});this.minY=V;this.maxY=T;this.minX=W;this.maxX=U},translatePath:function(Y){var X=this,U=false,W=X.xAxis,V=X.yAxis,T;Y=[].concat(Y);T=Y.length;while(T--){if(typeof Y[T]==="number"){if(U){Y[T]=Math.round(W.translate(Y[T]))}else{Y[T]=Math.round(V.len-V.translate(Y[T]))}U=!U}}return Y},setData:function(){G.Series.prototype.setData.apply(this,arguments);this.getBox()},translate:function(){var U=this,T=Number.MAX_VALUE,V=Number.MIN_VALUE;U.generatePoints();H(U.data,function(W){W.shapeType="path";W.shapeArgs={d:U.translatePath(W.path)};if(typeof W.y==="number"){if(W.y>V){V=W.y}else{if(W.y<T){T=W.y}}}});U.translateColors(T,V)},translateColors:function(Z,V){var W=this.options,U=W.valueRanges,X=W.colorRange,T=this.colorKey,Y,a;if(X){Y=F(X.from);a=F(X.to)}H(this.data,function(c){var e=c[T],f,d,b,g;if(U){b=U.length;while(b--){f=U[b];Y=f.from;a=f.to;if((Y===B||e>=Y)&&(a===B||e<=a)){d=f.color;break}}}else{if(X&&e!==undefined){g=1-((V-e)/(V-Z));d=e===null?W.nullColor:E(Y,a,g)}}if(d){c.color=null;c.options.color=d}})},drawGraph:L,drawDataLabels:L,drawPoints:function(){var V=this,U=V.xAxis,T=V.yAxis,W=V.colorKey;H(V.data,function(X){X.plotY=1;if(X[W]===null){X[W]=0;X.isNull=true}});Q.column.prototype.drawPoints.apply(V);H(V.data,function(Z){var Y=Z.dataLabels,c=U.toPixels(Z._minX,true),b=U.toPixels(Z._maxX,true),a=T.toPixels(Z._minY,true),X=T.toPixels(Z._maxY,true);Z.plotX=Math.round(c+(b-c)*K(Y&&Y.anchorX,0.5));Z.plotY=Math.round(a+(X-a)*K(Y&&Y.anchorY,0.5));if(Z.isNull){Z[W]=null}});G.Series.prototype.drawDataLabels.call(V)},animateDrilldown:function(Y){var T=this.chart.plotBox,W=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1],X=W.bBox,U=this.chart.options.drilldown.animation,V;if(!Y){V=Math.min(X.width/T.width,X.height/T.height);W.shapeArgs={scaleX:V,scaleY:V,translateX:X.x,translateY:X.y};H(this.points,function(Z){Z.graphic.attr(W.shapeArgs).animate({scaleX:1,scaleY:1,translateX:0,translateY:0},U)});delete this.animate}},animateDrillupFrom:function(T){Q.column.prototype.animateDrillupFrom.call(this,T)},animateDrillupTo:function(T){Q.column.prototype.animateDrillupTo.call(this,T)}});D.mapline=N(D.map,{lineWidth:1,backgroundColor:"none"});Q.mapline=G.extendClass(Q.map,{type:"mapline",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth",fill:"backgroundColor"},drawLegendSymbol:Q.line.prototype.drawLegendSymbol});D.mappoint=N(D.scatter,{dataLabels:{enabled:true,format:"{point.name}",color:"black",style:{textShadow:"0 0 5px white"}}});Q.mappoint=G.extendClass(Q.scatter,{type:"mappoint"});G.Map=function(V,T){var U={endOnTick:false,gridLineWidth:0,labels:{enabled:false},lineWidth:0,minPadding:0,maxPadding:0,startOnTick:false,tickWidth:0,title:null},W;W=V.series;V.series=null;V=N({chart:{type:"map",panning:"xy"},xAxis:U,yAxis:N(U,{reversed:true})},V,{chart:{inverted:false}});V.series=W;return new G.Chart(V,T)}}(Highcharts));