(function(N){function R(V,T,U){for(var A=4,B=[];A--;){B[A]=Math.round(T.rgba[A]+(V.rgba[A]-T.rgba[A])*(1-U))}return"rgba("+B.join(",")+")"}var C=N.Axis,S=N.Chart,D=N.Point,Q=N.Pointer,M=N.each,G=N.extend,E=N.merge,L=N.pick,P=N.numberFormat,O=N.getOptions(),K=N.seriesTypes,F=O.plotOptions,I=N.wrap,J=N.Color,H=function(){};O.mapNavigation={buttonOptions:{align:"right",verticalAlign:"bottom",x:0,width:18,height:18,style:{fontSize:"15px",fontWeight:"bold",textAlign:"center"}},buttons:{zoomIn:{onclick:function(){this.mapZoom(0.5)},text:"+",y:-32},zoomOut:{onclick:function(){this.mapZoom(2)},text:"-",y:0}}};N.splitPath=function(B){var A,B=B.replace(/([A-Za-z])/g," $1 "),B=B.replace(/^\s*/,"").replace(/\s*$/,""),B=B.split(/[ ,]+/);for(A=0;A<B.length;A++){/[a-zA-Z]/.test(B[A])||(B[A]=parseFloat(B[A]))}return B};N.maps={};I(C.prototype,"getSeriesExtremes",function(V){var T=this.isXAxis,U,A,B=[];M(this.series,function(X,W){if(X.useMapGeometry){B[W]=X.xData,X.xData=[]}});V.call(this);U=L(this.dataMin,Number.MAX_VALUE);A=L(this.dataMax,Number.MIN_VALUE);M(this.series,function(X,W){if(X.useMapGeometry){U=Math.min(U,X[T?"minX":"minY"]),A=Math.max(A,X[T?"maxX":"maxY"]),X.xData=B[W]}});this.dataMin=U;this.dataMax=A});I(C.prototype,"setAxisTranslation",function(V){var T=this.chart,U=T.plotWidth/T.plotHeight,A=this.isXAxis,B=T.xAxis[0];V.call(this);if(T.options.chart.type==="map"&&!A&&B.transA!==void 0){this.transA=B.transA=Math.min(this.transA,B.transA),V=(B.max-B.min)/(this.max-this.min),B=V>U?this:B,U=(B.max-B.min)*B.transA,B.minPixelPadding=(B.len-U)/2}});I(S.prototype,"render",function(T){var A=this,B=A.options.mapNavigation;T.call(A);A.renderMapNavigation();B.zoomOnDoubleClick&&N.addEvent(A.container,"dblclick",function(U){A.pointer.onContainerDblClick(U)});B.zoomOnMouseWheel&&N.addEvent(A.container,document.onmousewheel===void 0?"DOMMouseScroll":"mousewheel",function(U){A.pointer.onContainerMouseWheel(U)})});G(Q.prototype,{onContainerDblClick:function(B){var A=this.chart,B=this.normalize(B);A.isInsidePlot(B.chartX-A.plotLeft,B.chartY-A.plotTop)&&A.mapZoom(0.5,A.xAxis[0].toValue(B.chartX),A.yAxis[0].toValue(B.chartY))},onContainerMouseWheel:function(T){var A=this.chart,B,T=this.normalize(T);B=T.detail||-(T.wheelDelta/120);A.isInsidePlot(T.chartX-A.plotLeft,T.chartY-A.plotTop)&&A.mapZoom(B>0?2:0.5,A.xAxis[0].toValue(T.chartX),A.yAxis[0].toValue(T.chartY))}});I(Q.prototype,"init",function(T,A,B){T.call(this,A,B);if(B.mapNavigation.enableTouchZoom){this.pinchX=this.pinchHor=this.pinchY=this.pinchVert=!0}});G(S.prototype,{renderMapNavigation:function(){var W=this,U=this.options.mapNavigation,V=U.buttons,A,B,X,T=function(){this.handler.call(W)};if(U.enableButtons){for(A in V){if(V.hasOwnProperty(A)){X=E(U.buttonOptions,V[A]),B=W.renderer.button(X.text,0,0,T).attr({width:X.width,height:X.height}).css(X.style).add(),B.handler=X.onclick,B.align(G(X,{width:B.width,height:B.height}),null,"spacingBox")}}}},fitToBox:function(B,A){M([["x","width"],["y","height"]],function(U){var T=U[0],U=U[1];B[T]+B[U]>A[T]+A[U]&&(B[U]>A[U]?(B[U]=A[U],B[T]=A[T]):B[T]=A[T]+A[U]-B[U]);B[U]>A[U]&&(B[U]=A[U]);B[T]<A[T]&&(B[T]=A[T])});return B},mapZoom:function(W,U,V){if(!this.isMapZooming){var Y=this,A=Y.xAxis[0],X=A.max-A.min,T=L(U,A.min+X/2),U=X*W,X=Y.yAxis[0],B=X.max-X.min,V=L(V,X.min+B/2);W*=B;T-=U/2;B=V-W/2;V=L(Y.options.chart.animation,!0);U=Y.fitToBox({x:T,y:B,width:U,height:W},{x:A.dataMin,y:X.dataMin,width:A.dataMax-A.dataMin,height:X.dataMax-X.dataMin});A.setExtremes(U.x,U.x+U.width,!1);X.setExtremes(U.y,U.y+U.height,!1);if(A=V?V.duration||500:0){Y.isMapZooming=!0,setTimeout(function(){Y.isMapZooming=!1},A)}Y.redraw()}}});F.map=E(F.scatter,{animation:!1,nullColor:"#F8F8F8",borderColor:"silver",borderWidth:1,marker:null,stickyTracking:!1,dataLabels:{verticalAlign:"middle"},turboThreshold:0,tooltip:{followPointer:!0,pointFormat:"{point.name}: {point.y}<br/>"},states:{normal:{animation:!0}}});C=N.extendClass(D,{applyOptions:function(T,A){var B=D.prototype.applyOptions.call(this,T,A);if(B.path&&typeof B.path==="string"){B.path=B.options.path=N.splitPath(B.path)}return B},onMouseOver:function(){clearTimeout(this.colorInterval);D.prototype.onMouseOver.call(this)},onMouseOut:function(){var V=this,T=+new Date,U=J(V.options.color),A=J(V.pointAttr.hover.fill),B=V.series.options.states.normal.animation,W=B&&(B.duration||500);if(W&&U.rgba.length===4&&A.rgba.length===4){delete V.pointAttr[""].fill,clearTimeout(V.colorInterval),V.colorInterval=setInterval(function(){var Y=(new Date-T)/W,X=V.graphic;Y>1&&(Y=1);X&&X.attr("fill",R(A,U,Y));Y>=1&&clearTimeout(V.colorInterval)},13)}D.prototype.onMouseOut.call(V)}});K.map=N.extendClass(K.scatter,{type:"map",pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},colorKey:"y",pointClass:C,trackerGroups:["group","markerGroup","dataLabelsGroup"],getSymbol:H,supportsDrilldown:!0,getExtremesFromAll:!0,useMapGeometry:!0,init:function(Z){var X=this,Y=Z.options.legend.valueDecimals,k=[],A,g,U,T,B,V,W;V=Z.options.legend.layout==="horizontal";N.Series.prototype.init.apply(this,arguments);B=X.options.colorRange;if(T=X.options.valueRanges){M(T,function(b){g=b.from;U=b.to;A="";g===void 0?A="< ":U===void 0&&(A="> ");g!==void 0&&(A+=P(g,Y));g!==void 0&&U!==void 0&&(A+=" - ");U!==void 0&&(A+=P(U,Y));k.push(N.extend({chart:X.chart,name:A,options:{},drawLegendSymbol:K.area.prototype.drawLegendSymbol,visible:!0,setState:function(){},setVisible:function(){}},b))}),X.legendItems=k}else{if(B){g=B.from,U=B.to,T=B.fromLabel,B=B.toLabel,W=V?[0,0,1,0]:[0,1,0,0],V||(V=T,T=B,B=V),V={linearGradient:{x1:W[0],y1:W[1],x2:W[2],y2:W[3]},stops:[[0,g],[1,U]]},k=[{chart:X.chart,options:{},fromLabel:T,toLabel:B,color:V,drawLegendSymbol:this.drawLegendSymbolGradient,visible:!0,setState:function(){},setVisible:function(){}}],X.legendItems=k}}},drawLegendSymbol:K.area.prototype.drawLegendSymbol,drawLegendSymbolGradient:function(X,V){var W=X.options.symbolPadding,Z=L(X.options.padding,8),A,Y,U=this.chart.renderer.fontMetrics(X.options.itemStyle.fontSize).h,T=X.options.layout==="horizontal",B;B=L(X.options.rectangleLength,200);T?(A=-(W/2),Y=0):(A=-B+X.baseline-W/2,Y=Z+U);V.fromText=this.chart.renderer.text(V.fromLabel,Y,A).attr({zIndex:2}).add(V.legendGroup);Y=V.fromText.getBBox();V.legendSymbol=this.chart.renderer.rect(T?Y.x+Y.width+W:Y.x-U-W,Y.y,T?B:U,T?U:B,2).attr({zIndex:1}).add(V.legendGroup);B=V.legendSymbol.getBBox();V.toText=this.chart.renderer.text(V.toLabel,B.x+B.width+W,T?A:B.y+B.height-W).attr({zIndex:2}).add(V.legendGroup);A=V.toText.getBBox();T?(X.offsetWidth=Y.width+B.width+A.width+W*2+Z,X.itemY=U+Z):(X.offsetWidth=Math.max(Y.width,A.width)+W+B.width+Z,X.itemY=B.height+Z,X.itemX=W)},getBox:function(V){var T=Number.MIN_VALUE,U=Number.MAX_VALUE,A=Number.MIN_VALUE,B=Number.MAX_VALUE;M(V||this.options.data,function(d){for(var Z=d.path,Y=Z.length,W=!1,e=Number.MIN_VALUE,c=Number.MAX_VALUE,X=Number.MIN_VALUE,b=Number.MAX_VALUE;Y--;){typeof Z[Y]==="number"&&!isNaN(Z[Y])&&(W?(e=Math.max(e,Z[Y]),c=Math.min(c,Z[Y])):(X=Math.max(X,Z[Y]),b=Math.min(b,Z[Y])),W=!W)}d._maxX=e;d._minX=c;d._maxY=X;d._minY=b;T=Math.max(T,e);U=Math.min(U,c);A=Math.max(A,X);B=Math.min(B,b)});this.minY=B;this.maxY=A;this.minX=U;this.maxX=T},translatePath:function(V){var T=!1,U=this.xAxis,A=this.yAxis,B,V=[].concat(V);for(B=V.length;B--;){typeof V[B]==="number"&&(V[B]=T?Math.round(U.translate(V[B])):Math.round(A.len-A.translate(V[B])),T=!T)}return V},setData:function(){N.Series.prototype.setData.apply(this,arguments);this.getBox()},translate:function(){var T=this,A=Number.MAX_VALUE,B=Number.MIN_VALUE;T.generatePoints();M(T.data,function(U){U.shapeType="path";U.shapeArgs={d:T.translatePath(U.path)};if(typeof U.y==="number"){if(U.y>B){B=U.y}else{if(U.y<A){A=U.y}}}});T.translateColors(A,B)},translateColors:function(W,U){var V=this.options,Y=V.valueRanges,A=V.colorRange,X=this.colorKey,T,B;A&&(T=J(A.from),B=J(A.to));M(this.data,function(Z){var d=Z[X],c,b,a;if(Y){for(a=Y.length;a--;){if(c=Y[a],T=c.from,B=c.to,(T===void 0||d>=T)&&(B===void 0||d<=B)){b=c.color;break}}}else{A&&d!==void 0&&(c=1-(U-d)/(U-W),b=d===null?V.nullColor:R(T,B,c))}if(b){Z.color=null,Z.options.color=b}})},drawGraph:H,drawDataLabels:H,drawPoints:function(){var T=this.xAxis,A=this.yAxis,B=this.colorKey;M(this.data,function(U){U.plotY=1;if(U[B]===null){U[B]=0,U.isNull=!0}});K.column.prototype.drawPoints.apply(this);M(this.data,function(V){var W=V.dataLabels,Z=T.toPixels(V._minX,!0),U=T.toPixels(V._maxX,!0),X=A.toPixels(V._minY,!0),Y=A.toPixels(V._maxY,!0);V.plotX=Math.round(Z+(U-Z)*L(W&&W.anchorX,0.5));V.plotY=Math.round(X+(Y-X)*L(W&&W.anchorY,0.5));V.isNull&&(V[B]=null)});N.Series.prototype.drawDataLabels.call(this)},animateDrilldown:function(V){var T=this.chart.plotBox,U=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1],A=U.bBox,B=this.chart.options.drilldown.animation;if(!V){V=Math.min(A.width/T.width,A.height/T.height),U.shapeArgs={scaleX:V,scaleY:V,translateX:A.x,translateY:A.y},M(this.points,function(W){W.graphic.attr(U.shapeArgs).animate({scaleX:1,scaleY:1,translateX:0,translateY:0},B)}),delete this.animate}},animateDrillupFrom:function(A){K.column.prototype.animateDrillupFrom.call(this,A)},animateDrillupTo:function(A){K.column.prototype.animateDrillupTo.call(this,A)}});F.mapline=E(F.map,{lineWidth:1,backgroundColor:"none"});K.mapline=N.extendClass(K.map,{type:"mapline",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth",fill:"backgroundColor"},drawLegendSymbol:K.line.prototype.drawLegendSymbol});F.mappoint=E(F.scatter,{dataLabels:{enabled:!0,format:"{point.name}",color:"black",style:{textShadow:"0 0 5px white"}}});K.mappoint=N.extendClass(K.scatter,{type:"mappoint"});N.Map=function(U,B){var T={endOnTick:!1,gridLineWidth:0,labels:{enabled:!1},lineWidth:0,minPadding:0,maxPadding:0,startOnTick:!1,tickWidth:0,title:null},A;A=U.series;U.series=null;U=E({chart:{type:"map",panning:"xy"},xAxis:T,yAxis:E(T,{reversed:!0})},U,{chart:{inverted:!1}});U.series=A;return new N.Chart(U,B)}})(Highcharts);