!function(G,E){var F,J={},A=function(O,M){var N,K,L;if("string"==typeof O){return C(O)}for(N=[],K=O.length,L=0;K>L;L++){N.push(C(O[L]))}return M.apply(null,N)},H=function(M,K,L){2===arguments.length&&(L=K,K=null),A(K||[],function(){I(M,L,arguments)})},I=function(N,L,M){var O,K={exports:L};"function"==typeof L&&(M.length||(M=[A,K.exports,K]),O=L.apply(null,M),void 0!==O&&(K.exports=O)),J[N]=K.exports},C=function(K){var L=J[K]||G[K];if(!L){throw new Error("`"+K+"` is undefined")}return L},D=function(P){var N,O,M,Q,K,L;L=function(R){return R&&R.charAt(0).toUpperCase()+R.substr(1)};for(N in J){if(O=P,J.hasOwnProperty(N)){for(M=N.split("/"),K=L(M.pop());Q=L(M.shift());){O[Q]=O[Q]||{},O=O[Q]}O[K]=J[N]}}},B=E(G,H,A);D(B),"object"==typeof module&&"object"==typeof module.exports?module.exports=B:"function"==typeof define&&define.amd?define([],B):(F=G.WebUploader,G.WebUploader=B,G.WebUploader.noConflict=function(){G.WebUploader=F})}(this,function(C,A,B){return A("dollar-third",[],function(){return C.jQuery||C.Zepto}),A("dollar",["dollar-third"],function(D){return D}),A("promise-third",["dollar"],function(D){return{Deferred:D.Deferred,when:D.when,isPromise:function(E){return E&&"function"==typeof E.then}}}),A("promise",["promise-third"],function(D){return D}),A("base",["dollar","promise"],function(H,I){function E(K){return function(){return G.apply(K,arguments)}}function F(L,K){return function(){return L.apply(K,arguments)}}function J(L){var K;return Object.create?Object.create(L):(K=function(){},K.prototype=L,new K)}var D=function(){},G=Function.call;return{version:"0.1.2",$:H,Deferred:I.Deferred,isPromise:I.isPromise,when:I.when,browser:function(O){var M={},N=O.match(/WebKit\/([\d.]+)/),R=O.match(/Chrome\/([\d.]+)/)||O.match(/CriOS\/([\d.]+)/),K=O.match(/MSIE\s([\d\.]+)/)||O.match(/(?:trident)(?:.*rv:([\w.]+))?/i),P=O.match(/Firefox\/([\d.]+)/),Q=O.match(/Safari\/([\d.]+)/),L=O.match(/OPR\/([\d.]+)/);return N&&(M.webkit=parseFloat(N[1])),R&&(M.chrome=parseFloat(R[1])),K&&(M.ie=parseFloat(K[1])),P&&(M.firefox=parseFloat(P[1])),Q&&(M.safari=parseFloat(Q[1])),L&&(M.opera=parseFloat(L[1])),M}(navigator.userAgent),os:function(N){var L={},M=N.match(/(?:Android);?[\s\/]+([\d.]+)?/),K=N.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/);return M&&(L.android=parseFloat(M[1])),K&&(L.ios=parseFloat(K[1].replace(/_/g,"."))),L}(navigator.userAgent),inherits:function(N,M,K){var L;return"function"==typeof M?(L=M,M=null):L=M&&M.hasOwnProperty("constructor")?M.constructor:function(){return N.apply(this,arguments)},H.extend(!0,L,N,K||{}),L.__super__=N.prototype,L.prototype=J(N.prototype),M&&H.extend(!0,L.prototype,M),L},noop:D,bindFn:F,log:function(){return C.console?F(console.log,console):D}(),nextTick:function(){return function(K){setTimeout(K,1)}}(),slice:E([].slice),guid:function(){var K=0;return function(M){for(var N=(+new Date).toString(32),L=0;5>L;L++){N+=Math.floor(65535*Math.random()).toString(32)}return(M||"wu_")+N+(K++).toString(32)}}(),formatSize:function(N,L,M){var K;for(M=M||["B","K","M","G","TB"];(K=M.shift())&&N>1024;){N/=1024}return("B"===K?N:N.toFixed(L||2))+K}}}),A("mediator",["base"],function(H){function F(O,M,N,L){return I.grep(O,function(P){return !(!P||M&&P.e!==M||N&&P.cb!==N&&P.cb._cb!==N||L&&P.ctx!==L)})}function G(N,L,M){I.each((N||"").split(E),function(P,O){M(O,L)})}function K(P,N){for(var O,L=!1,M=-1,Q=P.length;++M<Q;){if(O=P[M],O.cb.apply(O.ctx2,N)===!1){L=!0;break}}return !L}var D,I=H.$,J=[].slice,E=/\s+/;return D={on:function(O,N,L){var M,P=this;return N?(M=this._events||(this._events=[]),G(O,N,function(S,Q){var R={e:S};R.cb=Q,R.ctx=L,R.ctx2=L||P,R.id=M.length,M.push(R)}),this):this},once:function(O,N,L){var M=this;return N?(G(O,N,function(R,P){var Q=function(){return M.off(R,Q),P.apply(L||M,arguments)};Q._cb=P,M.on(R,Q,L)}),M):M},off:function(O,M,N){var L=this._events;return L?O||M||N?(G(O,M,function(Q,P){I.each(F(L,Q,P,N),function(){delete L[this.id]})}),this):(this._events=[],this):this},trigger:function(N){var M,L,O;return this._events&&N?(M=J.call(arguments,1),L=F(this._events,N),O=F(this._events,"all"),K(L,M)&&K(O,arguments)):this}},I.extend({installTo:function(L){return I.extend(L,D)}},D)}),A("uploader",["base","mediator"],function(G,E){function F(H){this.options=D.extend(!0,{},F.options,H),this._init(this.options)}var D=G.$;return F.options={},E.installTo(F.prototype),D.each({upload:"start-upload",stop:"stop-upload",getFile:"get-file",getFiles:"get-files",addFile:"add-file",addFiles:"add-file",sort:"sort-files",removeFile:"remove-file",skipFile:"skip-file",retry:"retry",isInProgress:"is-in-progress",makeThumb:"make-thumb",getDimension:"get-dimension",addButton:"add-btn",getRuntimeType:"get-runtime-type",refresh:"refresh",disable:"disable",enable:"enable",reset:"reset"},function(I,H){F.prototype[I]=function(){return this.request(H,arguments)}}),D.extend(F.prototype,{state:"pending",_init:function(I){var H=this;H.request("init",I,function(){H.state="ready",H.trigger("ready")})},option:function(J,H){var I=this.options;return arguments.length>1?void (D.isPlainObject(H)&&D.isPlainObject(I[J])?D.extend(I[J],H):I[J]=H):J?I[J]:I},getStats:function(){var H=this.request("get-stats");return{successNum:H.numOfSuccess,cancelNum:H.numOfCancel,invalidNum:H.numOfInvalid,uploadFailNum:H.numOfUploadFailed,queueNum:H.numOfQueue}},trigger:function(J){var I=[].slice.call(arguments,1),H=this.options,K="on"+J.substring(0,1).toUpperCase()+J.substring(1);return E.trigger.apply(this,arguments)===!1||D.isFunction(H[K])&&H[K].apply(this,I)===!1||D.isFunction(this[K])&&this[K].apply(this,I)===!1||E.trigger.apply(E,[this,J].concat(I))===!1?!1:!0},request:G.noop}),G.create=F.create=function(H){return new F(H)},G.Uploader=F,F}),A("runtime/runtime",["base","mediator"],function(H,F){function G(J){this.options=D.extend({container:document.body},J),this.uid=H.guid("rt_")}var D=H.$,E={},I=function(K){for(var J in K){if(K.hasOwnProperty(J)){return J}}return null};return D.extend(G.prototype,{getContainer:function(){var L,J,K=this.options;return this._container?this._container:(L=D(K.container||document.body),J=D(document.createElement("div")),J.attr("id","rt_"+this.uid),J.css({position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),L.append(J),L.addClass("webuploader-container"),this._container=J,J)},init:H.noop,exec:H.noop,destroy:function(){this._container&&this._container.parentNode.removeChild(this.__container),this.off()}}),G.orders="html5,flash",G.addRuntime=function(K,J){E[K]=J},G.hasRuntime=function(J){return !!(J?E[J]:I(E))},G.create=function(M,L){var J,K;if(L=L||G.orders,D.each(L.split(/\s*,\s*/g),function(){return E[this]?(J=this,!1):void 0}),J=J||I(E),!J){throw new Error("Runtime Error")}return K=new E[J](M)},F.installTo(G.prototype),G}),A("runtime/client",["base","mediator","runtime/runtime"],function(H,F,G){function D(K,J){var L,I=H.Deferred();this.uid=H.guid("client_"),this.runtimeReady=function(M){return I.done(M)},this.connectRuntime=function(N,M){if(L){throw new Error("already connected!")}return I.done(M),"string"==typeof N&&E.get(N)&&(L=E.get(N)),L=L||E.get(null,J),L?(H.$.extend(L.options,N),L.__promise.then(I.resolve),L.__client++):(L=G.create(N,N.runtimeOrder),L.__promise=I.promise(),L.once("ready",I.resolve),L.init(),E.add(L),L.__client=1),J&&(L.__standalone=J),L},this.getRuntime=function(){return L},this.disconnectRuntime=function(){L&&(L.__client--,L.__client<=0&&(E.remove(L),delete L.__promise,L.destroy()),L=null)},this.exec=function(){if(L){var M=H.slice(arguments);return K&&M.unshift(K),L.exec.apply(this,M)}},this.getRuid=function(){return L&&L.uid},this.destroy=function(M){return function(){M&&M.apply(this,arguments),this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()}}(this.destroy)}var E;return E=function(){var I={};return{add:function(J){I[J.uid]=J},get:function(K,L){var J;if(K){return I[K]}for(J in I){if(!L||!I[J].__standalone){return I[J]}}return null},remove:function(J){delete I[J.uid]}}}(),F.installTo(D.prototype),D}),A("lib/blob",["base","runtime/client"],function(F,D){function E(I,H){var G=this;G.source=H,G.ruid=I,D.call(G,"Blob"),this.uid=H.uid||this.uid,this.type=H.type||"",this.size=H.size||0,I&&G.connectRuntime(I)}return F.inherits(D,{constructor:E,slice:function(H,G){return this.exec("slice",H,G)},getSource:function(){return this.source}}),E}),A("lib/file",["base","lib/blob"],function(H,F){function G(J,I){var K;F.apply(this,arguments),this.name=I.name||"untitled"+D++,K=E.exec(I.name)?RegExp.$1.toLowerCase():"",!K&&this.type&&(K=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(this.type)?RegExp.$1.toLowerCase():"",this.name+="."+K),!this.type&&~"jpg,jpeg,png,gif,bmp".indexOf(K)&&(this.type="image/"+("jpg"===K?"jpeg":K)),this.ext=K,this.lastModifiedDate=I.lastModifiedDate||(new Date).toLocaleString()}var D=1,E=/\.([^.]+)$/;return H.inherits(F,G)}),A("lib/filepicker",["base","runtime/client","lib/file"],function(F,G,D){function E(I){if(I=this.options=H.extend({},E.options,I),I.container=H(I.id),!I.container.length){throw new Error("按钮指定错误")}I.innerHTML=I.innerHTML||I.label||I.container.html()||"",I.button=H(I.button||document.createElement("div")),I.button.html(I.innerHTML),I.container.html(I.button),G.call(this,"FilePicker",!0)}var H=F.$;return E.options={button:null,container:null,label:null,innerHTML:null,multiple:!0,accept:null,name:"file"},F.inherits(G,{constructor:E,init:function(){var J=this,K=J.options,I=K.button;I.addClass("webuploader-pick"),J.on("all",function(M){var L;switch(M){case"mouseenter":I.addClass("webuploader-pick-hover");break;case"mouseleave":I.removeClass("webuploader-pick-hover");break;case"change":L=J.exec("getFiles"),J.trigger("select",H.map(L,function(N){return N=new D(J.getRuid(),N),N._refer=K.container,N}),K.container)}}),J.connectRuntime(K,function(){J.refresh(),J.exec("init",K),J.trigger("ready")}),H(C).on("resize",function(){J.refresh()})},refresh:function(){var M=this.getRuntime().getContainer(),K=this.options.button,L=K.outerWidth?K.outerWidth():K.width(),I=K.outerHeight?K.outerHeight():K.height(),J=K.offset();L&&I&&M.css({bottom:"auto",right:"auto",width:L+"px",height:I+"px"}).offset(J)},enable:function(){var I=this.options.button;I.removeClass("webuploader-pick-disable"),this.refresh()},disable:function(){var I=this.options.button;this.getRuntime().getContainer().css({top:"-99999px"}),I.addClass("webuploader-pick-disable")},destroy:function(){this.runtime&&(this.exec("destroy"),this.disconnectRuntime())}}),E}),A("widgets/widget",["base","uploader"],function(H,F){function G(N){if(!N){return !1}var L=N.length,M=D.type(N);return 1===N.nodeType&&L?!0:"array"===M||"function"!==M&&"string"!==M&&(0===L||"number"==typeof L&&L>0&&L-1 in N)}function K(L){this.owner=L,this.options=L.options}var D=H.$,I=F.prototype._init,J={},E=[];return D.extend(K.prototype,{init:H.noop,invoke:function(N,L){var M=this.responseMap;return M&&N in M&&M[N] in this&&D.isFunction(this[M[N]])?this[M[N]].apply(this,L):J},request:function(){return this.owner.request.apply(this.owner,arguments)}}),D.extend(F.prototype,{_init:function(){var M=this,L=M._widgets=[];return D.each(E,function(O,N){L.push(new N(M))}),I.apply(M,arguments)},request:function(U,W,L){var V,O,P,M,N=0,S=this._widgets,T=S.length,Q=[],R=[];for(W=G(W)?W:[W];T>N;N++){V=S[N],O=V.invoke(U,W),O!==J&&(H.isPromise(O)?R.push(O):Q.push(O))}return L||R.length?(P=H.when.apply(H,R),M=P.pipe?"pipe":"then",P[M](function(){var X=H.Deferred(),Y=arguments;return setTimeout(function(){X.resolve.apply(X,Y)},1),X.promise()})[M](L||H.noop)):Q[0]}}),F.register=K.register=function(M,N){var O,L={init:"init"};return 1===arguments.length?(N=M,N.responseMap=L):N.responseMap=D.extend(L,M),O=H.inherits(K,N),E.push(O),O},K}),A("widgets/filepicker",["base","uploader","lib/filepicker","widgets/widget"],function(G,E,F){var D=G.$;return D.extend(E.options,{pick:null,accept:null}),E.register({"add-btn":"addButton",refresh:"refresh",disable:"disable",enable:"enable"},{init:function(H){return this.pickers=[],H.pick&&this.addButton(H.pick)},refresh:function(){D.each(this.pickers,function(){this.refresh()})},addButton:function(L){var J,N,H,I=this,K=I.options,M=K.accept;if(L){return H=G.Deferred(),D.isPlainObject(L)||(L={id:L}),J=D.extend({},L,{accept:D.isPlainObject(M)?[M]:M,swf:K.swf,runtimeOrder:K.runtimeOrder}),N=new F(J),N.once("ready",H.resolve),N.on("select",function(O){I.owner.request("add-file",[O])}),N.init(),this.pickers.push(N),H.promise()}},disable:function(){D.each(this.pickers,function(){this.disable()})},enable:function(){D.each(this.pickers,function(){this.enable()})}})}),A("lib/image",["base","runtime/client","lib/blob"],function(H,F,G){function D(I){this.options=E.extend({},D.options,I),F.call(this,"Image"),this.on("load",function(){this._info=this.exec("info"),this._meta=this.exec("meta")})}var E=H.$;return D.options={quality:90,crop:!1,preserveHeaders:!0,allowMagnify:!0},H.inherits(F,{constructor:D,info:function(I){return I?(this._info=I,this):this._info},meta:function(I){return I?(this._meta=I,this):this._meta},loadFromBlob:function(K){var I=this,J=K.getRuid();this.connectRuntime(J,function(){I.exec("init",I.options),I.exec("loadFromBlob",K)})},resize:function(){var I=H.slice(arguments);return this.exec.apply(this,["resize"].concat(I))},getAsDataUrl:function(I){return this.exec("getAsDataUrl",I)},getAsBlob:function(J){var I=this.exec("getAsBlob",J);return new G(this.getRuid(),I)}}),D}),A("widgets/image",["base","uploader","lib/image","widgets/widget"],function(H,F,G){var D,E=H.$;return D=function(L){var J=0,K=[],I=function(){for(var M;K.length&&L>J;){M=K.shift(),J+=M[0],M[1]()}};return function(N,M,O){K.push([M,O]),N.once("destroy",function(){J-=M,setTimeout(I,1)}),setTimeout(I,1)}}(5242880),E.extend(F.options,{thumb:{width:110,height:110,quality:70,allowMagnify:!0,crop:!0,preserveHeaders:!1,type:"image/jpeg"},compress:{width:1600,height:1600,quality:90,allowMagnify:!1,crop:!1,preserveHeaders:!0}}),F.register({"make-thumb":"makeThumb","before-send-file":"compressImage"},{makeThumb:function(M,L,N,I){var J,K;return M=this.request("get-file",M),M.type.match(/^image/)?(J=E.extend({},this.options.thumb),E.isPlainObject(N)&&(J=E.extend(J,N),N=null),N=N||J.width,I=I||J.height,K=new G(J),K.once("load",function(){M._info=M._info||K.info(),M._meta=M._meta||K.meta(),K.resize(N,I)}),K.once("complete",function(){L(!1,K.getAsDataUrl(J.type)),K.destroy()}),K.once("error",function(){L(!0),K.destroy()}),void D(K,M.source.size,function(){M._info&&K.info(M._info),M._meta&&K.meta(M._meta),K.loadFromBlob(M.source)})):void L(!0)},compressImage:function(L){var J,M,I=this.options.compress||this.options.resize,K=I&&I.compressSize||307200;return L=this.request("get-file",L),!I||!~"image/jpeg,image/jpg".indexOf(L.type)||L.size<K||L._compressed?void 0:(I=E.extend({},I),M=H.Deferred(),J=new G(I),M.always(function(){J.destroy(),J=null}),J.once("error",M.reject),J.once("load",function(){L._info=L._info||J.info(),L._meta=L._meta||J.meta(),J.resize(I.width,I.height)}),J.once("complete",function(){var P,O;try{P=J.getAsBlob(I.type),O=L.size,P.size<O&&(L.source=P,L.size=P.size,L.trigger("resize",P.size,O)),L._compressed=!0,M.resolve()}catch(N){M.resolve()}}),L._info&&J.info(L._info),L._meta&&J.meta(L._meta),J.loadFromBlob(L.source),M.promise())}})}),A("file",["base","mediator"],function(I,G){function H(){return J+K++}function L(M){this.name=M.name||"Untitled",this.size=M.size||0,this.type=M.type||"application",this.lastModifiedDate=M.lastModifiedDate||1*new Date,this.id=H(),this.ext=E.exec(this.name)?RegExp.$1:"",this.statusText="",F[this.id]=L.Status.INITED,this.source=M,this.loaded=0,this.on("error",function(N){this.setStatus(L.Status.ERROR,N)})}var D=I.$,J="WU_FILE_",K=0,E=/\.([^.]+)$/,F={};return D.extend(L.prototype,{setStatus:function(O,M){var N=F[this.id];"undefined"!=typeof M&&(this.statusText=M),O!==N&&(F[this.id]=O,this.trigger("statuschange",O,N))},getStatus:function(){return F[this.id]},getSource:function(){return this.source},destory:function(){delete F[this.id]}}),G.installTo(L.prototype),L.Status={INITED:"inited",QUEUED:"queued",PROGRESS:"progress",ERROR:"error",COMPLETE:"complete",CANCELLED:"cancelled",INTERRUPT:"interrupt",INVALID:"invalid"},L}),A("queue",["base","mediator","file"],function(H,F,G){function D(){this.stats={numOfQueue:0,numOfSuccess:0,numOfCancel:0,numOfProgress:0,numOfUploadFailed:0,numOfInvalid:0},this._queue=[],this._map={}}var E=H.$,I=G.Status;return E.extend(D.prototype,{append:function(J){return this._queue.push(J),this._fileAdded(J),this},prepend:function(J){return this._queue.unshift(J),this._fileAdded(J),this},getFile:function(J){return"string"!=typeof J?J:this._map[J]},fetch:function(M){var K,L,J=this._queue.length;for(M=M||I.QUEUED,K=0;J>K;K++){if(L=this._queue[K],M===L.getStatus()){return L}}return null},sort:function(J){"function"==typeof J&&this._queue.sort(J)},getFiles:function(){for(var M,K=[].slice.call(arguments,0),L=[],J=0,N=this._queue.length;N>J;J++){M=this._queue[J],(!K.length||~E.inArray(M.getStatus(),K))&&L.push(M)}return L},_fileAdded:function(L){var J=this,K=this._map[L.id];K||(this._map[L.id]=L,L.on("statuschange",function(N,M){J._onFileStatusChange(N,M)})),L.setStatus(I.QUEUED)},_onFileStatusChange:function(L,J){var K=this.stats;switch(J){case I.PROGRESS:K.numOfProgress--;break;case I.QUEUED:K.numOfQueue--;break;case I.ERROR:K.numOfUploadFailed--;break;case I.INVALID:K.numOfInvalid--}switch(L){case I.QUEUED:K.numOfQueue++;break;case I.PROGRESS:K.numOfProgress++;break;case I.ERROR:K.numOfUploadFailed++;break;case I.COMPLETE:K.numOfSuccess++;break;case I.CANCELLED:K.numOfCancel++;break;case I.INVALID:K.numOfInvalid++}}}),F.installTo(D.prototype),D}),A("widgets/queue",["base","uploader","queue","file","lib/file","runtime/client","widgets/widget"],function(I,G,H,L,D,J){var K=I.$,E=/\.\w+$/,F=L.Status;return G.register({"sort-files":"sortFiles","add-file":"addFiles","get-file":"getFile","fetch-file":"fetchFile","get-stats":"getStats","get-files":"getFiles","remove-file":"removeFile",retry:"retry",reset:"reset","accept-file":"acceptFile"},{init:function(T){var U,M,P,Q,N,O,R,S=this;if(K.isPlainObject(T.accept)&&(T.accept=[T.accept]),T.accept){for(N=[],P=0,M=T.accept.length;M>P;P++){Q=T.accept[P].extensions,Q&&N.push(Q)}N.length&&(O="\\."+N.join(",").replace(/,/g,"$|\\.").replace(/\*/g,".*")+"$"),S.accept=new RegExp(O,"i")}return S.queue=new H,S.stats=S.queue.stats,"html5"===this.request("predict-runtime-type")?(U=I.Deferred(),R=new J("Placeholder"),R.connectRuntime({runtimeOrder:"html5"},function(){S._ruid=R.getRuid(),U.resolve()}),U.promise()):void 0},_wrapFile:function(M){if(!(M instanceof L)){if(!(M instanceof D)){if(!this._ruid){throw new Error("Can't add external files.")}M=new D(this._ruid,M)}M=new L(M)}return M},acceptFile:function(N){var M=!N||N.size<6||this.accept&&E.exec(N.name)&&!this.accept.test(N.name);return !M},_addFile:function(N){var M=this;return N=M._wrapFile(N),M.owner.trigger("beforeFileQueued",N)?M.acceptFile(N)?(M.queue.append(N),M.owner.trigger("fileQueued",N),N):void M.owner.trigger("error","Q_TYPE_DENIED",N):void 0},getFile:function(M){return this.queue.getFile(M)},addFiles:function(N){var M=this;N.length||(N=[N]),N=K.map(N,function(O){return M._addFile(O)}),M.owner.trigger("filesQueued",N),M.options.auto&&M.request("start-upload")},getStats:function(){return this.stats},removeFile:function(N){var M=this;N=N.id?N:M.queue.getFile(N),N.setStatus(F.CANCELLED),M.owner.trigger("fileDequeued",N)},getFiles:function(){return this.queue.getFiles.apply(this.queue,arguments)},fetchFile:function(){return this.queue.fetch.apply(this.queue,arguments)},retry:function(Q,O){var P,M,N,R=this;if(Q){return Q=Q.id?Q:R.queue.getFile(Q),Q.setStatus(F.QUEUED),void (O||R.request("start-upload"))}for(P=R.queue.getFiles(F.ERROR),M=0,N=P.length;N>M;M++){Q=P[M],Q.setStatus(F.QUEUED)}R.request("start-upload")},sortFiles:function(){return this.queue.sort.apply(this.queue,arguments)},reset:function(){this.queue=new H,this.stats=this.queue.stats}})}),A("widgets/runtime",["uploader","runtime/runtime","widgets/widget"],function(E,D){return E.support=function(){return D.hasRuntime.apply(D,arguments)},E.register({"predict-runtime-type":"predictRuntmeType"},{init:function(){if(!this.predictRuntmeType()){throw Error("Runtime Error")}},predictRuntmeType:function(){var I,H,F=this.options.runtimeOrder||D.orders,G=this.type;if(!G){for(F=F.split(/\s*,\s*/g),I=0,H=F.length;H>I;I++){if(D.hasRuntime(F[I])){this.type=G=F[I];break}}}return G}})}),A("lib/transport",["base","runtime/client","mediator"],function(H,F,G){function D(J){var I=this;J=I.options=E.extend(!0,{},D.options,J||{}),F.call(this,"Transport"),this._blob=null,this._formData=J.formData||{},this._headers=J.headers||{},this.on("progress",this._timeout),this.on("load error",function(){I.trigger("progress",1),clearTimeout(I._timer)})}var E=H.$;return D.options={server:"",method:"POST",withCredentials:!1,fileVal:"file",timeout:120000,formData:{},headers:{},sendAsBinary:!1},E.extend(D.prototype,{appendBlob:function(M,K,L){var I=this,J=I.options;I.getRuid()&&I.disconnectRuntime(),I.connectRuntime(K.ruid,function(){I.exec("init")}),I._blob=K,J.fileVal=M||J.fileVal,J.filename=L||J.filename},append:function(J,I){"object"==typeof J?E.extend(this._formData,J):this._formData[J]=I},setRequestHeader:function(J,I){"object"==typeof J?E.extend(this._headers,J):this._headers[J]=I},send:function(I){this.exec("send",I),this._timeout()},abort:function(){return clearTimeout(this._timer),this.exec("abort")},destroy:function(){this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()},getResponse:function(){return this.exec("getResponse")},getResponseAsJson:function(){return this.exec("getResponseAsJson")},getStatus:function(){return this.exec("getStatus")},_timeout:function(){var J=this,I=J.options.timeout;I&&(clearTimeout(J._timer),J._timer=setTimeout(function(){J.abort(),J.trigger("error","timeout")},I))}}),G.installTo(D.prototype),D}),A("widgets/upload",["base","uploader","file","lib/transport","widgets/widget"],function(H,F,G,K){function D(Q,O){for(var P,T=[],L=Q.source,R=L.size,S=O?Math.ceil(R/O):1,M=0,N=0;S>N;){P=Math.min(O,R-M),T.push({file:Q,start:M,end:O?M+P:R,total:R,chunks:S,chunk:N++}),M+=P}return Q.blocks=T.concat(),Q.remaning=T.length,{file:Q,has:function(){return !!T.length},fetch:function(){return T.shift()}}}var I=H.$,J=H.isPromise,E=G.Status;I.extend(F.options,{prepareNextFile:!1,chunked:!1,chunkSize:5242880,chunkRetry:2,threads:3,formData:null}),F.register({"start-upload":"start","stop-upload":"stop","skip-file":"skipFile","is-in-progress":"isInProgress"},{init:function(){var L=this.owner;this.runing=!1,this.pool=[],this.pending=[],this.remaning=0,this.__tick=H.bindFn(this._tick,this),L.on("uploadComplete",function(M){M.blocks&&I.each(M.blocks,function(O,N){N.transport&&(N.transport.abort(),N.transport.destroy()),delete N.transport}),delete M.blocks,delete M.remaning})},start:function(){var L=this;I.each(L.request("get-files",E.INVALID),function(){L.request("remove-file",this)}),L.runing||(L.runing=!0,I.each(L.pool,function(O,N){var M=N.file;M.getStatus()===E.INTERRUPT&&(M.setStatus(E.PROGRESS),L._trigged=!1,N.transport&&N.transport.send())}),L._trigged=!1,L.owner.trigger("startUpload"),H.nextTick(L.__tick))},stop:function(M){var L=this;L.runing!==!1&&(L.runing=!1,M&&I.each(L.pool,function(O,N){N.transport&&N.transport.abort(),N.file.setStatus(E.INTERRUPT)}),L.owner.trigger("stopUpload"))},isInProgress:function(){return !!this.runing},getStats:function(){return this.request("get-stats")},skipFile:function(M,L){M=this.request("get-file",M),M.setStatus(L||E.COMPLETE),M.skipped=!0,M.blocks&&I.each(M.blocks,function(P,N){var O=N.transport;O&&(O.abort(),O.destroy(),delete N.transport)}),this.owner.trigger("uploadSkip",M)},_tick:function(){var N,O,L=this,M=L.options;return L._promise?L._promise.always(L.__tick):void (L.pool.length<M.threads&&(O=L._nextBlock())?(L._trigged=!1,N=function(P){L._promise=null,P&&P.file&&L._startSend(P),H.nextTick(L.__tick)},L._promise=J(O)?O.always(N):N(O)):L.remaning||L.getStats().numOfQueue||(L.runing=!1,L._trigged||H.nextTick(function(){L.owner.trigger("uploadFinished")}),L._trigged=!0))},_nextBlock:function(){var O,M,N=this,L=N._act,P=N.options;return L&&L.has()&&L.file.getStatus()===E.PROGRESS?(P.prepareNextFile&&!N.pending.length&&N._prepareNextFile(),L.fetch()):N.runing?(!N.pending.length&&N.getStats().numOfQueue&&N._prepareNextFile(),O=N.pending.shift(),M=function(Q){return Q?(L=D(Q,P.chunked?P.chunkSize:0),N._act=L,L.fetch()):null},J(O)?O[O.pipe?"pipe":"then"](M):M(O)):void 0},_prepareNextFile:function(){var O,M=this,N=M.request("fetch-file"),L=M.pending;N&&(O=M.request("before-send-file",N,function(){return N.getStatus()===E.QUEUED?(M.owner.trigger("uploadStart",N),N.setStatus(E.PROGRESS),N):M._finishFile(N)}),O.done(function(){var P=I.inArray(O,L);~P&&L.splice(P,1,N)}),O.fail(function(P){N.setStatus(E.ERROR,P),M.owner.trigger("uploadError",N,P),M.owner.trigger("uploadComplete",N)}),L.push(O))},_popBlock:function(M){var L=I.inArray(M,this.pool);this.pool.splice(L,1),M.file.remaning--,this.remaning--},_startSend:function(N){var O,L=this,M=N.file;L.pool.push(N),L.remaning++,N.blob=1===N.chunks?M.source:M.source.slice(N.start,N.end),O=L.request("before-send",N,function(){M.getStatus()===E.PROGRESS?L._doSend(N):(L._popBlock(N),H.nextTick(L.__tick))}),O.fail(function(){1===M.remaning?L._finishFile(M).always(function(){N.percentage=1,L._popBlock(N),L.owner.trigger("uploadComplete",M),H.nextTick(L.__tick)}):(N.percentage=1,L._popBlock(N),H.nextTick(L.__tick))})},_doSend:function(S){var T,L,U=this,O=U.owner,M=U.options,N=S.file,Q=new K(M),R=I.extend({},M.formData),P=I.extend({},M.headers);S.transport=Q,Q.on("destroy",function(){delete S.transport,U._popBlock(S),H.nextTick(U.__tick)}),Q.on("progress",function(X){var W=0,V=0;W=S.percentage=X,S.chunks>1&&(I.each(N.blocks,function(Z,Y){V+=(Y.percentage||0)*(Y.end-Y.start)}),W=V/N.size),O.trigger("uploadProgress",N,W||0)}),T=function(W){var V;return L=Q.getResponseAsJson()||{},L._raw=Q.getResponse(),V=function(X){W=X},O.trigger("uploadAccept",S,L,V)||(W=W||"server"),W},Q.on("error",function(W,V){S.retried=S.retried||0,S.chunks>1&&~"http,abort".indexOf(W)&&S.retried<M.chunkRetry?(S.retried++,Q.send()):(V||"server"!==W||(W=T(W)),N.setStatus(E.ERROR,W),O.trigger("uploadError",N,W),O.trigger("uploadComplete",N))}),Q.on("load",function(){var V;return(V=T())?void Q.trigger("error",V,!0):void (1===N.remaning?U._finishFile(N,L):Q.destroy())}),R=I.extend(R,{id:N.id,name:N.name,type:N.type,lastModifiedDate:N.lastModifiedDate,size:N.size}),S.chunks>1&&I.extend(R,{chunks:S.chunks,chunk:S.chunk}),O.trigger("uploadBeforeSend",S,R,P),Q.appendBlob(M.fileVal,S.blob,N.name),Q.append(R),Q.setRequestHeader(P),Q.send()},_finishFile:function(O,M,N){var L=this.owner;return L.request("after-send-file",arguments,function(){O.setStatus(E.COMPLETE),L.trigger("uploadSuccess",O,M,N)}).fail(function(P){O.getStatus()===E.PROGRESS&&O.setStatus(E.ERROR,P),L.trigger("uploadError",O,P)}).always(function(){L.trigger("uploadComplete",O)})}})}),A("runtime/compbase",[],function(){function D(F,E){this.owner=F,this.options=F.options,this.getRuntime=function(){return E},this.getRuid=function(){return E.uid},this.trigger=function(){return F.trigger.apply(F,arguments)}}return D}),A("runtime/html5/runtime",["base","runtime/runtime","runtime/compbase"],function(G,H,E){function F(){var L={},J=this,K=this.destory;H.apply(J,arguments),J.type=I,J.exec=function(P,O){var R,M=this,N=M.uid,Q=G.slice(arguments,2);return D[P]&&(R=L[N]=L[N]||new D[P](M,J),R[O])?R[O].apply(R,Q):void 0},J.destory=function(){return K&&K.apply(this,arguments)}}var I="html5",D={};return G.inherits(H,{constructor:F,init:function(){var J=this;setTimeout(function(){J.trigger("ready")},1)}}),F.register=function(L,K){var J=D[L]=G.inherits(E,K);return J},C.Blob&&C.FileReader&&C.DataView&&H.addRuntime(I,F),F}),A("runtime/html5/blob",["runtime/html5/runtime","lib/blob"],function(E,D){return E.register("Blob",{slice:function(I,H){var F=this.owner.source,G=F.slice||F.webkitSlice||F.mozSlice;return F=G.call(F,I,H),new D(this.getRuid(),F)}})}),A("runtime/html5/filepicker",["base","runtime/html5/runtime"],function(F,D){var E=F.$;return D.register("FilePicker",{init:function(){var M,L,P,G,N=this.getRuntime().getContainer(),O=this,J=O.owner,K=O.options,H=E(document.createElement("label")),I=E(document.createElement("input"));if(I.attr("type","file"),I.attr("name",K.name),I.addClass("webuploader-element-invisible"),H.on("click",function(){I.trigger("click")}),H.css({opacity:0,width:"100%",height:"100%",display:"block",cursor:"pointer",background:"#ffffff"}),K.multiple&&I.attr("multiple","multiple"),K.accept&&K.accept.length>0){for(M=[],L=0,P=K.accept.length;P>L;L++){M.push(K.accept[L].mimeTypes)}I.attr("accept",M.join(","))}N.append(I),N.append(H),G=function(Q){J.trigger(Q.type)},I.on("change",function(S){var R,Q=arguments.callee;O.files=S.target.files,R=this.cloneNode(!0),this.parentNode.replaceChild(R,this),I.off(),I=E(R).on("change",Q).on("mouseenter mouseleave",G),J.trigger("change")}),H.on("mouseenter mouseleave",G)},getFiles:function(){return this.files},destroy:function(){}})}),A("runtime/html5/util",["base"],function(F){var G=C.createObjectURL&&C||C.URL&&URL.revokeObjectURL&&URL||C.webkitURL,D=F.noop,E=D;return G&&(D=function(){return G.createObjectURL.apply(G,arguments)},E=function(){return G.revokeObjectURL.apply(G,arguments)}),{createObjectURL:D,revokeObjectURL:E,dataURL2Blob:function(M){var K,L,I,J,N,H;for(H=M.split(","),K=~H[0].indexOf("base64")?atob(H[1]):decodeURIComponent(H[1]),I=new ArrayBuffer(K.length),L=new Uint8Array(I),J=0;J<K.length;J++){L[J]=K.charCodeAt(J)}return N=H[0].split(":")[1].split(";")[0],this.arrayBufferToBlob(I,N)},dataURL2ArrayBuffer:function(L){var J,K,H,I;for(I=L.split(","),J=~I[0].indexOf("base64")?atob(I[1]):decodeURIComponent(I[1]),K=new Uint8Array(J.length),H=0;H<J.length;H++){K[H]=J.charCodeAt(H)}return K.buffer},arrayBufferToBlob:function(J,K){var H,I=C.BlobBuilder||C.WebKitBlobBuilder;return I?(H=new I,H.append(J),H.getBlob(K)):new Blob([J],K?{type:K}:{})},canvasToDataUrl:function(J,H,I){return J.toDataURL(H,I/100)},parseMeta:function(I,H){H(!1,{})},updateImageHead:function(H){return H}}}),A("runtime/html5/imagemeta",["runtime/html5/util"],function(E){var D;return D={parsers:{65505:[]},maxMetaDataSize:262144,parse:function(I,G){var H=this,F=new FileReader;F.onload=function(){G(!1,H._parse(this.result)),F=F.onload=F.onerror=null},F.onerror=function(J){G(J.message),F=F.onload=F.onerror=null},I=I.slice(0,H.maxMetaDataSize),F.readAsArrayBuffer(I.getSource())},_parse:function(M,L){if(!(M.byteLength<6)){var P,F,N,O,I=new DataView(M),J=2,G=I.byteLength-4,H=J,K={};if(65496===I.getUint16(0)){for(;G>J&&(P=I.getUint16(J),P>=65504&&65519>=P||65534===P)&&(F=I.getUint16(J+2)+2,!(J+F>I.byteLength));){if(N=D.parsers[P],!L&&N){for(O=0;O<N.length;O+=1){N[O].call(D,I,J,F,K)}}J+=F,H=J}H>6&&(K.imageHead=M.slice?M.slice(2,H):new Uint8Array(M).subarray(2,H))}return K}},updateImageHead:function(J,H){var I,F,G,K=this._parse(J,!0);return G=2,K.imageHead&&(G=2+K.imageHead.byteLength),F=J.slice?J.slice(G):new Uint8Array(J).subarray(G),I=new Uint8Array(H.byteLength+2+F.byteLength),I[0]=255,I[1]=216,I.set(new Uint8Array(H),2),I.set(new Uint8Array(F),H.byteLength+2),I.buffer}},E.parseMeta=function(){return D.parse.apply(D,arguments)},E.updateImageHead=function(){return D.updateImageHead.apply(D,arguments)},D}),A("runtime/html5/imagemeta/exif",["base","runtime/html5/imagemeta"],function(F,D){var E={};return E.ExifMap=function(){return this},E.ExifMap.prototype.map={Orientation:274},E.ExifMap.prototype.get=function(G){return this[G]||this[this.map[G]]},E.exifTagTypes={1:{getValue:function(H,G){return H.getUint8(G)},size:1},2:{getValue:function(H,G){return String.fromCharCode(H.getUint8(G))},size:1,ascii:!0},3:{getValue:function(I,G,H){return I.getUint16(G,H)},size:2},4:{getValue:function(I,G,H){return I.getUint32(G,H)},size:4},5:{getValue:function(I,G,H){return I.getUint32(G,H)/I.getUint32(G+4,H)},size:8},9:{getValue:function(I,G,H){return I.getInt32(G,H)},size:4},10:{getValue:function(I,G,H){return I.getInt32(G,H)/I.getInt32(G+4,H)},size:8}},E.exifTagTypes[7]=E.exifTagTypes[1],E.getExifValue=function(P,S,G,Q,R,J){var K,H,I,N,O,L,M=E.exifTagTypes[Q];if(!M){return void F.log("Invalid Exif data: Invalid tag type.")}if(K=M.size*R,H=K>4?S+P.getUint32(G+8,J):G+8,H+K>P.byteLength){return void F.log("Invalid Exif data: Invalid data offset.")}if(1===R){return M.getValue(P,H,J)}for(I=[],N=0;R>N;N+=1){I[N]=M.getValue(P,H+N*M.size,J)}if(M.ascii){for(O="",N=0;N<I.length&&(L=I[N],"\x00"!==L);N+=1){O+=L}return O}return I},E.parseExifTag=function(K,J,H,I,L){var G=K.getUint16(H,I);L.exif[G]=E.getExifValue(K,J,H,K.getUint16(H+2,I),K.getUint32(H+4,I),I)},E.parseExifTags=function(J,K,N,G,L){var M,H,I;if(N+6>J.byteLength){return void F.log("Invalid Exif data: Invalid directory offset.")}if(M=J.getUint16(N,G),H=N+2+12*M,H+4>J.byteLength){return void F.log("Invalid Exif data: Invalid directory size.")}for(I=0;M>I;I+=1){this.parseExifTag(J,K,N+2+12*I,G,L)}return J.getUint32(H,G)},E.parseExifData=function(L,H,I,M){var G,J,K=H+10;if(1165519206===L.getUint32(H+4)){if(K+8>L.byteLength){return void F.log("Invalid Exif data: Invalid segment size.")}if(0!==L.getUint16(H+8)){return void F.log("Invalid Exif data: Missing byte alignment offset.")}switch(L.getUint16(K)){case 18761:G=!0;break;case 19789:G=!1;break;default:return void F.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==L.getUint16(K+2,G)){return void F.log("Invalid Exif data: Missing TIFF marker.")}J=L.getUint32(K+4,G),M.exif=new E.ExifMap,J=E.parseExifTags(L,K,K+J,G,M)}},D.parsers[65505].push(E.parseExifData),E}),A("runtime/html5/image",["base","runtime/html5/runtime","runtime/html5/util"],function(G,E,F){var D="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D";return E.register("Image",{modified:!1,init:function(){var I=this,H=new Image;H.onload=function(){I._info={type:I.type,width:this.width,height:this.height},I._metas||"image/jpeg"!==I.type?I.owner.trigger("load"):F.parseMeta(I._blob,function(J,K){I._metas=K,I.owner.trigger("load")})},H.onerror=function(){I.owner.trigger("error")},I._img=H},loadFromBlob:function(J){var I=this,H=I._img;I._blob=J,I.type=J.type,H.src=F.createObjectURL(J.getSource()),I.owner.once("load",function(){F.revokeObjectURL(H.src)})},resize:function(J,H){var I=this._canvas||(this._canvas=document.createElement("canvas"));this._resize(this._img,I,J,H),this._blob=null,this.modified=!0,this.owner.trigger("complete")},getAsBlob:function(K){var J,H=this._blob,I=this.options;if(K=K||this.type,this.modified||this.type!==K){if(J=this._canvas,"image/jpeg"===K){if(H=F.canvasToDataUrl(J,"image/jpeg",I.quality),I.preserveHeaders&&this._metas&&this._metas.imageHead){return H=F.dataURL2ArrayBuffer(H),H=F.updateImageHead(H,this._metas.imageHead),H=F.arrayBufferToBlob(H,K)}}else{H=F.canvasToDataUrl(J,K)}H=F.dataURL2Blob(H)}return H},getAsDataUrl:function(I){var H=this.options;return I=I||this.type,"image/jpeg"===I?F.canvasToDataUrl(this._canvas,I,H.quality):this._canvas.toDataURL(I)},getOrientation:function(){return this._metas&&this._metas.exif&&this._metas.exif.get("Orientation")||1},info:function(H){return H?(this._info=H,this):this._info},meta:function(H){return H?(this._meta=H,this):this._meta},destroy:function(){var H=this._canvas;this._img.onload=null,H&&(H.getContext("2d").clearRect(0,0,H.width,H.height),H.width=H.height=0,this._canvas=null),this._img.src=D,this._img=this._blob=null},_resize:function(Q,O,P,T){var H,R,S,K,L,I=this.options,J=Q.width,M=Q.height,N=this.getOrientation();~[5,6,7,8].indexOf(N)&&(P^=T,T^=P,P^=T),H=Math[I.crop?"max":"min"](P/J,T/M),I.allowMagnify||(H=Math.min(1,H)),R=J*H,S=M*H,I.crop?(O.width=P,O.height=T):(O.width=R,O.height=S),K=(O.width-R)/2,L=(O.height-S)/2,I.preserveHeaders||this._rotate2Orientaion(O,N),this._renderImageToCanvas(O,Q,K,L,R,S)},_rotate2Orientaion:function(L,J){var K=L.width,H=L.height,I=L.getContext("2d");switch(J){case 5:case 6:case 7:case 8:L.width=H,L.height=K}switch(J){case 2:I.translate(K,0),I.scale(-1,1);break;case 3:I.translate(K,H),I.rotate(Math.PI);break;case 4:I.translate(0,H),I.scale(1,-1);break;case 5:I.rotate(0.5*Math.PI),I.scale(1,-1);break;case 6:I.rotate(0.5*Math.PI),I.translate(0,-H);break;case 7:I.rotate(0.5*Math.PI),I.translate(K,-H),I.scale(-1,1);break;case 8:I.rotate(-0.5*Math.PI),I.translate(-K,0)}},_renderImageToCanvas:function(){function H(Q,O,P){var T,J,R,S=document.createElement("canvas"),M=S.getContext("2d"),N=0,K=P,L=P;for(S.width=1,S.height=P,M.drawImage(Q,0,0),T=M.getImageData(0,0,1,P).data;L>N;){J=T[4*(L-1)+3],0===J?K=L:N=L,L=K+N>>1}return R=L/P,0===R?1:R}function I(N){var L,M,J=N.naturalWidth,K=N.naturalHeight;return J*K>1048576?(L=document.createElement("canvas"),L.width=L.height=1,M=L.getContext("2d"),M.drawImage(N,-J+1,0),0===M.getImageData(0,0,1,1).data[3]):!1}return G.os.ios?G.os.ios>=7?function(O,N,R,J,P,Q){var L=N.naturalWidth,M=N.naturalHeight,K=H(N,L,M);return O.getContext("2d").drawImage(N,0,0,L*K,M*K,R,J,P,Q)}:function(Z,x,y,b,c,T){var U,R,S,X,Y,V,W,L=x.naturalWidth,M=x.naturalHeight,J=Z.getContext("2d"),K=I(x),P="image/jpeg"===this.type,Q=1024,N=0,O=0;for(K&&(L/=2,M/=2),J.save(),U=document.createElement("canvas"),U.width=U.height=Q,R=U.getContext("2d"),S=P?H(x,L,M):1,X=Math.ceil(Q*c/L),Y=Math.ceil(Q*T/M/S);M>N;){for(V=0,W=0;L>V;){R.clearRect(0,0,Q,Q),R.drawImage(x,-V,-N),J.drawImage(U,0,0,Q,Q,y+W,b+O,X,Y),V+=Q,W+=X}N+=Q,O+=Y}J.restore(),U=R=null}:function(N,L,M,J,K,O){N.getContext("2d").drawImage(L,M,J,K,O)}}()})}),A("runtime/html5/jpegencoder",[],function(){function D(AS){function AQ(L){for(var J=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],K=0;64>K;K++){var O=Az((J[K]*L+50)/100);1>O?O=1:O>255&&(O=255),Ax[Ac[K]]=O}for(var E=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],M=0;64>M;M++){var N=Az((E[M]*L+50)/100);1>N?N=1:N>255&&(N=255),As[Ac[M]]=N}for(var H=[1,1.387039845,1.306562965,1.175875602,1,0.785694958,0.5411961,0.275899379],I=0,F=0;8>F;F++){for(var G=0;8>G;G++){Aq[I]=1/(Ax[Ac[I]]*H[F]*H[G]*8),Ar[I]=1/(As[Ac[I]]*H[F]*H[G]*8),I++}}}function AR(J,H){for(var I=0,F=0,G=new Array,K=1;16>=K;K++){for(var E=1;E<=J[K];E++){G[H[F]]=[],G[H[F]][0]=I,G[H[F]][1]=K,F++,I++}I*=2}return G}function AV(){AG=AR(Ad,Aa),AH=AR(Ah,Ae),AE=AR(Ab,Ag),AF=AR(Af,Z)}function Y(){for(var I=1,G=2,H=1;15>=H;H++){for(var E=I;G>E;E++){Aw[32767+E]=H,Av[32767+E]=[],Av[32767+E][1]=H,Av[32767+E][0]=E}for(var F=-(G-1);-I>=F;F++){Aw[32767+F]=H,Av[32767+F]=[],Av[32767+F][1]=H,Av[32767+F][0]=G-1+F}I<<=1,G<<=1}}function AT(){for(var E=0;256>E;E++){An[E]=19595*E,An[E+256>>0]=38470*E,An[E+512>>0]=7471*E+32768,An[E+768>>0]=-11059*E,An[E+1024>>0]=-21709*E,An[E+1280>>0]=32768*E+8421375,An[E+1536>>0]=-27439*E,An[E+1792>>0]=-5329*E}}function AU(G){for(var E=G[0],F=G[1]-1;F>=0;){E&1<<F&&(Al|=1<<Ai),F--,Ai--,0>Ai&&(255==Al?(AK(255),AK(0)):AK(Al),Ai=7,Al=0)}}function AK(E){Ak.push(Am[E])}function AL(E){AK(E>>8&255),AK(255&E)}function AI(BI,BG){var BH,BL,F,BJ,BK,BA,BB,By,Bz,BE=0,BF=8,BC=64;for(Bz=0;BF>Bz;++Bz){BH=BI[BE],BL=BI[BE+1],F=BI[BE+2],BJ=BI[BE+3],BK=BI[BE+4],BA=BI[BE+5],BB=BI[BE+6],By=BI[BE+7];var BD=BH+By,Bs=BH-By,Bt=BL+BB,Bq=BL-BB,Br=F+BA,Bw=F-BA,Bx=BJ+BK,Bu=BJ-BK,Bv=BD+Bx,Bo=BD-Bx,Bp=Bt+Br,Bn=Bt-Br;BI[BE]=Bv+Bp,BI[BE+4]=Bv-Bp;var Bj=0.707106781*(Bn+Bo);BI[BE+2]=Bo+Bj,BI[BE+6]=Bo-Bj,Bv=Bu+Bw,Bp=Bw+Bq,Bn=Bq+Bs;var Bh=0.382683433*(Bv-Bn),Bi=0.5411961*Bv+Bh,Bl=1.306562965*Bn+Bh,Bm=0.707106781*Bp,Bk=Bs+Bm,Bb=Bs-Bm;BI[BE+5]=Bb+Bi,BI[BE+3]=Bb-Bi,BI[BE+1]=Bk+Bl,BI[BE+7]=Bk-Bl,BE+=8}for(BE=0,Bz=0;BF>Bz;++Bz){BH=BI[BE],BL=BI[BE+8],F=BI[BE+16],BJ=BI[BE+24],BK=BI[BE+32],BA=BI[BE+40],BB=BI[BE+48],By=BI[BE+56];var Bc=BH+By,A9=BH-By,Ba=BL+BB,Bf=BL-BB,Bg=F+BA,Bd=F-BA,Be=BJ+BK,A3=BJ-BK,A4=Bc+Be,A1=Bc-Be,A2=Ba+Bg,A7=Ba-Bg;BI[BE]=A4+A2,BI[BE+32]=A4-A2;var A8=0.707106781*(A7+A1);BI[BE+16]=A1+A8,BI[BE+48]=A1-A8,A4=A3+Bd,A2=Bd+Bf,A7=Bf+A9;var A5=0.382683433*(A4-A7),A6=0.5411961*A4+A5,AY=1.306562965*A7+A5,AZ=0.707106781*A2,AX=A9+AZ,AW=A9-AZ;BI[BE+40]=AW+A6,BI[BE+24]=AW-A6,BI[BE+8]=AX+AY,BI[BE+56]=AX-AY,BE++}var A0;for(Bz=0;BC>Bz;++Bz){A0=BI[Bz]*BG[Bz],At[Bz]=A0>0?A0+0.5|0:A0-0.5|0}return At}function AJ(){AL(65504),AL(16),AK(74),AK(70),AK(73),AK(70),AK(0),AK(1),AK(1),AK(0),AL(1),AL(1),AK(0),AK(0)}function AO(F,E){AL(65472),AL(17),AK(8),AL(E),AL(F),AK(3),AK(1),AK(17),AK(0),AK(2),AK(17),AK(1),AK(3),AK(17),AK(1)}function AP(){AL(65499),AL(132),AK(0);for(var F=0;64>F;F++){AK(Ax[F])}AK(1);for(var E=0;64>E;E++){AK(As[E])}}function AM(){AL(65476),AL(418),AK(0);for(var I=0;16>I;I++){AK(Ad[I+1])}for(var G=0;11>=G;G++){AK(Aa[G])}AK(16);for(var H=0;16>H;H++){AK(Ab[H+1])}for(var L=0;161>=L;L++){AK(Ag[L])}AK(1);for(var E=0;16>E;E++){AK(Ah[E+1])}for(var J=0;11>=J;J++){AK(Ae[J])}AK(17);for(var K=0;16>K;K++){AK(Af[K+1])}for(var F=0;161>=F;F++){AK(Z[F])}}function AN(){AL(65498),AL(12),AK(3),AK(1),AK(0),AK(2),AK(17),AK(3),AK(17),AK(0),AK(63),AK(0)}function AC(U,S,T,W,X){for(var V,M=X[0],N=X[240],L=16,Q=63,R=64,O=AI(U,S),P=0;R>P;++P){Au[Ac[P]]=O[P]}var G=Au[0]-T;T=Au[0],0==G?AU(W[0]):(V=32767+G,AU(W[Aw[V]]),AU(Av[V]));for(var H=63;H>0&&0==Au[H];H--){}if(0==H){return AU(M),T}for(var E,F=1;H>=F;){for(var J=F;0==Au[F]&&H>=F;++F){}var K=F-J;if(K>=L){E=K>>4;for(var I=1;E>=I;++I){AU(N)}K=15&K}V=32767+Au[F],AU(X[(K<<4)+Aw[V]]),AU(Av[V]),F++}return H!=Q&&AU(M),T}function AD(){for(var F=String.fromCharCode,E=0;256>E;E++){Am[E]=F(E)}}function AA(F){if(0>=F&&(F=1),F>100&&(F=100),Ay!=F){var E=0;E=Math.floor(50>F?5000/F:200-2*F),AQ(E),Ay=F}}function AB(){AS||(AS=50),AD(),AV(),Y(),AT(),AA(AS)}var AG,AH,AE,AF,Ay,Az=(Math.round,Math.floor),Ax=new Array(64),As=new Array(64),Aq=new Array(64),Ar=new Array(64),Av=new Array(65535),Aw=new Array(65535),At=new Array(64),Au=new Array(64),Ak=[],Al=0,Ai=7,Aj=new Array(64),Ao=new Array(64),Ap=new Array(64),Am=new Array(256),An=new Array(2048),Ac=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Ad=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Aa=[0,1,2,3,4,5,6,7,8,9,10,11],Ab=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Ag=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Ah=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Ae=[0,1,2,3,4,5,6,7,8,9,10,11],Af=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Z=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(R,L){L&&AA(L),Ak=new Array,Al=0,Ai=7,AL(65496),AJ(),AP(),AO(R.width,R.height),AM(),AN();var M=0,T=0,U=0;Al=0,Ai=7,this.encode.displayName="_encode_";for(var S,K,J,I,H,m,n,l,W,i=R.data,k=R.width,X=R.height,g=4*k,V=0;X>V;){for(S=0;g>S;){for(H=g*V+S,m=H,n=-1,l=0,W=0;64>W;W++){l=W>>3,n=4*(7&W),m=H+l*g+n,V+l>=X&&(m-=g*(V+1+l-X)),S+n>=g&&(m-=S+n-g+4),K=i[m++],J=i[m++],I=i[m++],Aj[W]=(An[K]+An[J+256>>0]+An[I+512>>0]>>16)-128,Ao[W]=(An[K+768>>0]+An[J+1024>>0]+An[I+1280>>0]>>16)-128,Ap[W]=(An[K+1280>>0]+An[J+1536>>0]+An[I+1792>>0]>>16)-128}M=AC(Aj,Aq,M,AG,AE),T=AC(Ao,Ar,T,AH,AF),U=AC(Ap,Ar,U,AH,AF),S+=32}V+=8}if(Ai>=0){var o=[];o[1]=Ai+1,o[0]=(1<<Ai+1)-1,AU(o)}AL(65497);var O="data:image/jpeg;base64,"+btoa(Ak.join(""));return Ak=[],O},AB()}return D.encode=function(F,G){var E=new D(G);return E.encode(F)},D}),A("runtime/html5/androidpatch",["runtime/html5/util","runtime/html5/jpegencoder","base"],function(H,F,G){var D,E=H.canvasToDataUrl;H.canvasToDataUrl=function(N,O,P){var K,L,I,J,M;return G.os.android?("image/jpeg"===O&&"undefined"==typeof D&&(J=E.apply(null,arguments),M=J.split(","),J=~M[0].indexOf("base64")?atob(M[1]):decodeURIComponent(M[1]),J=J.substring(0,2),D=255===J.charCodeAt(0)&&216===J.charCodeAt(1)),"image/jpeg"!==O||D?E.apply(null,arguments):(L=N.width,I=N.height,K=N.getContext("2d"),F.encode(K.getImageData(0,0,L,I),P))):E.apply(null,arguments)}}),A("runtime/html5/transport",["base","runtime/html5/runtime"],function(G,E){var F=G.noop,D=G.$;return E.register("Transport",{init:function(){this._status=0,this._response=null},send:function(){var L,M,H,N=this.owner,O=this.options,J=this._initAjax(),K=N._blob,I=O.server;O.sendAsBinary?(I+=(/\?/.test(I)?"&":"?")+D.param(N._formData),M=K.getSource()):(L=new FormData,D.each(N._formData,function(Q,P){L.append(Q,P)}),L.append(O.fileVal,K.getSource(),O.filename||N._formData.name||"")),O.withCredentials&&"withCredentials" in J?(J.open(O.method,I,!0),J.withCredentials=!0):J.open(O.method,I),this._setRequestHeader(J,O.headers),M?(J.overrideMimeType("application/octet-stream"),G.os.android?(H=new FileReader,H.onload=function(){J.send(this.result),H=H.onload=null},H.readAsArrayBuffer(M)):J.send(M)):J.send(L)},getResponse:function(){return this._response},getResponseAsJson:function(){return this._parseJson(this._response)},getStatus:function(){return this._status},abort:function(){var H=this._xhr;H&&(H.upload.onprogress=F,H.onreadystatechange=F,H.abort(),this._xhr=H=null)},destroy:function(){this.abort()},_initAjax:function(){var J=this,I=new XMLHttpRequest,H=this.options;return !H.withCredentials||"withCredentials" in I||"undefined"==typeof XDomainRequest||(I=new XDomainRequest),I.upload.onprogress=function(K){var L=0;return K.lengthComputable&&(L=K.loaded/K.total),J.trigger("progress",L)},I.onreadystatechange=function(){return 4===I.readyState?(I.upload.onprogress=F,I.onreadystatechange=F,J._xhr=null,J._status=I.status,I.status>=200&&I.status<300?(J._response=I.responseText,J.trigger("load")):I.status>=500&&I.status<600?(J._response=I.responseText,J.trigger("error","server")):J.trigger("error",J._status?"http":"abort")):void 0},J._xhr=I,I},_setRequestHeader:function(I,H){D.each(H,function(J,K){I.setRequestHeader(J,K)})},_parseJson:function(J){var H;try{H=JSON.parse(J)}catch(I){H={}}return H}})}),A("webuploader",["base","widgets/filepicker","widgets/image","widgets/queue","widgets/runtime","widgets/upload","runtime/html5/blob","runtime/html5/filepicker","runtime/html5/imagemeta/exif","runtime/html5/image","runtime/html5/androidpatch","runtime/html5/transport"],function(D){return D}),B("webuploader")});